<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Projects funded by the AFD | Impact analysis of protected areas funded by the AFD : an open-guide for reproductibility</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Projects funded by the AFD | Impact analysis of protected areas funded by the AFD : an open-guide for reproductibility" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="vuillota/EVA-impact-aires-protegees.git" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Projects funded by the AFD | Impact analysis of protected areas funded by the AFD : an open-guide for reproductibility" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Antoine Vuillot" />
<meta name="author" content="Ingrid Dallmann" />
<meta name="author" content="Léa Poulin" />
<meta name="author" content="Pierre-Yves Durand" />


<meta name="date" content="2023-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="building-the-datasets.html"/>
<link rel="next" href="biodiversity-in-the-protected-areas.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Impact analysis of protected areas funded by the AFD</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this website</a></li>
<li class="chapter" data-level="1" data-path="building-the-datasets.html"><a href="building-the-datasets.html"><i class="fa fa-check"></i><b>1</b> Building the datasets</a>
<ul>
<li class="chapter" data-level="1.1" data-path="building-the-datasets.html"><a href="building-the-datasets.html#initial-settings"><i class="fa fa-check"></i><b>1.1</b> Initial settings</a></li>
<li class="chapter" data-level="1.2" data-path="building-the-datasets.html"><a href="building-the-datasets.html#datasets-for-analysis"><i class="fa fa-check"></i><b>1.2</b> Datasets for analysis</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="building-the-datasets.html"><a href="building-the-datasets.html#merge-pas-reporting-by-afd-technical-departments"><i class="fa fa-check"></i><b>1.2.1</b> Merge PAs reporting by AFD technical departments</a></li>
<li class="chapter" data-level="1.2.2" data-path="building-the-datasets.html"><a href="building-the-datasets.html#merge-the-list-of-pas-to-afd-project-information-and-wdpa"><i class="fa fa-check"></i><b>1.2.2</b> Merge the list of PAs to AFD project information and WDPA</a></li>
<li class="chapter" data-level="1.2.3" data-path="building-the-datasets.html"><a href="building-the-datasets.html#correct-errors"><i class="fa fa-check"></i><b>1.2.3</b> Correct errors</a></li>
<li class="chapter" data-level="1.2.4" data-path="building-the-datasets.html"><a href="building-the-datasets.html#tidy-the-datasets"><i class="fa fa-check"></i><b>1.2.4</b> Tidy the datasets</a></li>
<li class="chapter" data-level="1.2.5" data-path="building-the-datasets.html"><a href="building-the-datasets.html#dataset-with-only-afd-project-variables"><i class="fa fa-check"></i><b>1.2.5</b> Dataset with only AFD project variables</a></li>
<li class="chapter" data-level="1.2.6" data-path="building-the-datasets.html"><a href="building-the-datasets.html#dataset-for-non-confidential-analysis"><i class="fa fa-check"></i><b>1.2.6</b> Dataset for non-confidential analysis</a></li>
<li class="chapter" data-level="1.2.7" data-path="building-the-datasets.html"><a href="building-the-datasets.html#datasets-for-confidential-analysis"><i class="fa fa-check"></i><b>1.2.7</b> Datasets for confidential analysis</a></li>
<li class="chapter" data-level="1.2.8" data-path="building-the-datasets.html"><a href="building-the-datasets.html#a-polygon-dataset-for-specific-use"><i class="fa fa-check"></i><b>1.2.8</b> A polygon dataset for specific use</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="building-the-datasets.html"><a href="building-the-datasets.html#computing-total-areas-covered-by-pas-in-the-sample"><i class="fa fa-check"></i><b>1.3</b> Computing total areas covered by PAs in the sample</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="building-the-datasets.html"><a href="building-the-datasets.html#computations-of-polygons-area"><i class="fa fa-check"></i><b>1.3.1</b> Computations of polygons’ area</a></li>
<li class="chapter" data-level="1.3.2" data-path="building-the-datasets.html"><a href="building-the-datasets.html#computing-the-intersection-at-country-region-world-level"><i class="fa fa-check"></i><b>1.3.2</b> Computing the intersection at country, region, world level</a></li>
<li class="chapter" data-level="1.3.3" data-path="building-the-datasets.html"><a href="building-the-datasets.html#computing-total-areas-without-intersection"><i class="fa fa-check"></i><b>1.3.3</b> Computing total areas without intersection</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Descriptive statistics</b></span></li>
<li class="chapter" data-level="2" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html"><i class="fa fa-check"></i><b>2</b> Projects funded by the AFD</a>
<ul>
<li class="chapter" data-level="2.1" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#initial-settings-1"><i class="fa fa-check"></i><b>2.1</b> Initial settings</a></li>
<li class="chapter" data-level="2.2" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#importing-the-datasets"><i class="fa fa-check"></i><b>2.2</b> Importing the datasets</a></li>
<li class="chapter" data-level="2.3" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#performing-descriptive-statistics"><i class="fa fa-check"></i><b>2.3</b> Performing descriptive statistics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#iucn-categories"><i class="fa fa-check"></i><b>2.3.1</b> IUCN categories</a></li>
<li class="chapter" data-level="2.3.2" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#ecosystems-excluding-non-referenced-pas"><i class="fa fa-check"></i><b>2.3.2</b> Ecosystems (excluding non-referenced PAs)</a></li>
<li class="chapter" data-level="2.3.3" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#distribution-and-surface-of-pas-across-countries-and-regions"><i class="fa fa-check"></i><b>2.3.3</b> Distribution (# and surface) of PAs across countries and regions</a></li>
<li class="chapter" data-level="2.3.4" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#surface-of-pas"><i class="fa fa-check"></i><b>2.3.4</b> Surface of PAs</a></li>
<li class="chapter" data-level="2.3.5" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#temporal-evolution"><i class="fa fa-check"></i><b>2.3.5</b> Temporal evolution</a></li>
<li class="chapter" data-level="2.3.6" data-path="projects-funded-by-the-afd.html"><a href="projects-funded-by-the-afd.html#governance"><i class="fa fa-check"></i><b>2.3.6</b> Governance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html"><i class="fa fa-check"></i><b>3</b> Biodiversity in the protected areas</a>
<ul>
<li class="chapter" data-level="3.1" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#importing-packages-and-functions"><i class="fa fa-check"></i><b>3.1</b> Importing packages and functions</a></li>
<li class="chapter" data-level="3.2" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#setting-the-environment"><i class="fa fa-check"></i><b>3.2</b> Setting the environment</a></li>
<li class="chapter" data-level="3.3" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#importing-pas-datasets"><i class="fa fa-check"></i><b>3.3</b> Importing PAs datasets</a></li>
<li class="chapter" data-level="3.4" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#downloading-data-of-interests-and-compute-relevant-indicators"><i class="fa fa-check"></i><b>3.4</b> Downloading data of interests and compute relevant indicators</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#creating-the-portfolio"><i class="fa fa-check"></i><b>3.4.1</b> Creating the portfolio</a></li>
<li class="chapter" data-level="3.4.2" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#test-importing-data-from-sspcloud"><i class="fa fa-check"></i><b>3.4.2</b> TEST : importing data from SSPCloud</a></li>
<li class="chapter" data-level="3.4.3" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#compute-indicators-from-geospatial-data"><i class="fa fa-check"></i><b>3.4.3</b> Compute indicators from geospatial data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#computing-statistics"><i class="fa fa-check"></i><b>3.5</b> Computing statistics</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#forests"><i class="fa fa-check"></i><b>3.5.1</b> Forests</a></li>
<li class="chapter" data-level="3.5.2" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#mangrove"><i class="fa fa-check"></i><b>3.5.2</b> Mangrove</a></li>
<li class="chapter" data-level="3.5.3" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#emissions"><i class="fa fa-check"></i><b>3.5.3</b> Emissions</a></li>
<li class="chapter" data-level="3.5.4" data-path="biodiversity-in-the-protected-areas.html"><a href="biodiversity-in-the-protected-areas.html#biometeow"><i class="fa fa-check"></i><b>3.5.4</b> Biome/TEOW</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="miscellaneous-statistics.html"><a href="miscellaneous-statistics.html"><i class="fa fa-check"></i><b>4</b> Miscellaneous statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="miscellaneous-statistics.html"><a href="miscellaneous-statistics.html#initial-settings-2"><i class="fa fa-check"></i><b>4.1</b> Initial settings</a></li>
<li class="chapter" data-level="4.2" data-path="miscellaneous-statistics.html"><a href="miscellaneous-statistics.html#importing-datasets"><i class="fa fa-check"></i><b>4.2</b> Importing datasets</a></li>
<li class="chapter" data-level="4.3" data-path="miscellaneous-statistics.html"><a href="miscellaneous-statistics.html#performing-descriptive-statistics-1"><i class="fa fa-check"></i><b>4.3</b> Performing descriptive statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="miscellaneous-statistics.html"><a href="miscellaneous-statistics.html#fapbm-portfolio-and-madagascar"><i class="fa fa-check"></i><b>4.3.1</b> FAPBM portfolio and Madagascar</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="miscellaneous-statistics.html"><a href="miscellaneous-statistics.html#evolution-of-tree-cover-and-deforestation"><i class="fa fa-check"></i><b>4.4</b> Evolution of tree cover and deforestation</a></li>
</ul></li>
<li class="part"><span><b>Impact analysis</b></span></li>
<li class="chapter" data-level="5" data-path="matching.html"><a href="matching.html"><i class="fa fa-check"></i><b>5</b> Matching</a>
<ul>
<li class="chapter" data-level="5.1" data-path="matching.html"><a href="matching.html#initial-settings-3"><i class="fa fa-check"></i><b>5.1</b> Initial settings</a></li>
<li class="chapter" data-level="5.2" data-path="matching.html"><a href="matching.html#datasets-and-critical-parameters"><i class="fa fa-check"></i><b>5.2</b> Datasets and critical parameters</a></li>
<li class="chapter" data-level="5.3" data-path="matching.html"><a href="matching.html#matching-process"><i class="fa fa-check"></i><b>5.3</b> Matching process</a></li>
</ul></li>
<li class="part"><span><b>Impact analysis</b></span></li>
<li class="chapter" data-level="6" data-path="difference-in-difference.html"><a href="difference-in-difference.html"><i class="fa fa-check"></i><b>6</b> Difference-in-difference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="difference-in-difference.html"><a href="difference-in-difference.html#initial-settings-4"><i class="fa fa-check"></i><b>6.1</b> Initial settings</a></li>
<li class="chapter" data-level="6.2" data-path="difference-in-difference.html"><a href="difference-in-difference.html#load-datasets-and-define-critical-parameters"><i class="fa fa-check"></i><b>6.2</b> Load datasets and define critical parameters</a></li>
<li class="chapter" data-level="6.3" data-path="difference-in-difference.html"><a href="difference-in-difference.html#computing-treatment-effects-at-protected-area-level"><i class="fa fa-check"></i><b>6.3</b> Computing treatment effects at protected area level</a></li>
<li class="chapter" data-level="6.4" data-path="difference-in-difference.html"><a href="difference-in-difference.html#compute-aggregated-metrics-at-country-and-region-level"><i class="fa fa-check"></i><b>6.4</b> Compute aggregated metrics at country and region level</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="difference-in-difference.html"><a href="difference-in-difference.html#aggregation-of-treatment-effects"><i class="fa fa-check"></i><b>6.4.1</b> Aggregation of treatment effects</a></li>
<li class="chapter" data-level="6.4.2" data-path="difference-in-difference.html"><a href="difference-in-difference.html#aggregation-of-annual-deforestation-rates"><i class="fa fa-check"></i><b>6.4.2</b> Aggregation of annual deforestation rates</a></li>
<li class="chapter" data-level="6.4.3" data-path="difference-in-difference.html"><a href="difference-in-difference.html#average-and-total-forest-loss-on-the-period-at-country-and-region-level"><i class="fa fa-check"></i><b>6.4.3</b> Average and total forest loss on the period, at country and region level</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="difference-in-difference.html"><a href="difference-in-difference.html#display-treatment-effects-in-figures-and-tables"><i class="fa fa-check"></i><b>6.5</b> Display treatment effects in figures and tables</a></li>
<li class="chapter" data-level="6.6" data-path="difference-in-difference.html"><a href="difference-in-difference.html#section"><i class="fa fa-check"></i><b>6.6</b> </a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="functions-for-matching-pre--and-post-processing.html"><a href="functions-for-matching-pre--and-post-processing.html"><i class="fa fa-check"></i><b>A</b> Functions for matching pre- and post-processing</a></li>
<li class="chapter" data-level="B" data-path="functions-for-difference-in-difference-computations.html"><a href="functions-for-difference-in-difference-computations.html"><i class="fa fa-check"></i><b>B</b> Functions for difference-in-difference computations</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Impact analysis of protected areas funded by the AFD : an open-guide for reproductibility</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="projects-funded-by-the-afd" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Section 2</span> Projects funded by the AFD<a href="projects-funded-by-the-afd.html#projects-funded-by-the-afd" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this document are performed and plotted the following descriptive statistics on the protected areas (PAs) funded by Agence Française de Développement (AFD) :</p>
<ul>
<li><p>Distribution of PAs among IUCN categories, at country, region and world level</p></li>
<li><p>Distribution in terms of ecosystems</p></li>
<li><p>Distribution of PAs across countries and regions, in terms of numbers or areas</p></li>
<li><p>Temporal evolution in the number and area of PAs funded by the AFD</p></li>
<li><p>Distribution in terms of governance types</p></li>
</ul>
<p>In general, PAs refer to AFD funded PAs. When all PAs reported through the world are considered (typically for comparative statistics between general PAs and AFD funded PAs), it will be stated.</p>
<p>Some statistics are performed for all PAs across the world, while others are done for some regions and some specific PAs. Typically some statistics are performed for non-marine PAs, i.e terrestrial or coastal ones. These categories are defined by the WDPA and are indicative. A terrestrial PA has less than 10% of its area covered by sea or ocean, a marine one more than 90% and coastal PAs are in between.</p>
<p>The statistics are derived from datasets stored in the SSPCloud, and saved into the SSPCloud. Thus specific functions from the aws.S3 package are used (s3read_using() and s3write_using()). These can be replaced by other R functions to read/write locally (fread() typically). The ggplot2::ggsave() function cannot be used to write directly in the SSPCloud storage. Instead, plots from ggplot2 are stored in the temporary memory, then moved to the SSPCloud storage. Working locally, ggsave() can be directly used once the plots are created.</p>
<div id="initial-settings-1" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Initial settings<a href="projects-funded-by-the-afd.html#initial-settings-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Configuring the Rmarkdown</p>
<p>#<code>{r setup, include=FALSE, eval = FALSE} #knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file()) #</code></p>
<p>Importing the relevant packages</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="projects-funded-by-the-afd.html#cb17-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;stargazer&quot;</span>, <span class="st">&quot;janitor&quot;</span>, <span class="st">&quot;questionr&quot;</span>, <span class="st">&quot;countrycode&quot;</span>, <span class="st">&quot;WDI&quot;</span>))</span>
<span id="cb17-2"><a href="projects-funded-by-the-afd.html#cb17-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-3"><a href="projects-funded-by-the-afd.html#cb17-3" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb17-4"><a href="projects-funded-by-the-afd.html#cb17-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb17-5"><a href="projects-funded-by-the-afd.html#cb17-5" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb17-6"><a href="projects-funded-by-the-afd.html#cb17-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-7"><a href="projects-funded-by-the-afd.html#cb17-7" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb17-8"><a href="projects-funded-by-the-afd.html#cb17-8" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb17-9"><a href="projects-funded-by-the-afd.html#cb17-9" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb17-10"><a href="projects-funded-by-the-afd.html#cb17-10" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb17-11"><a href="projects-funded-by-the-afd.html#cb17-11" tabindex="-1"></a><span class="co">#library(readxl)</span></span>
<span id="cb17-12"><a href="projects-funded-by-the-afd.html#cb17-12" tabindex="-1"></a><span class="co">#library(splitstackshape) </span></span>
<span id="cb17-13"><a href="projects-funded-by-the-afd.html#cb17-13" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb17-14"><a href="projects-funded-by-the-afd.html#cb17-14" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb17-15"><a href="projects-funded-by-the-afd.html#cb17-15" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb17-16"><a href="projects-funded-by-the-afd.html#cb17-16" tabindex="-1"></a><span class="fu">library</span>(aws.s3)</span>
<span id="cb17-17"><a href="projects-funded-by-the-afd.html#cb17-17" tabindex="-1"></a><span class="fu">library</span>(WDI)</span></code></pre></div>
</div>
<div id="importing-the-datasets" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Importing the datasets<a href="projects-funded-by-the-afd.html#importing-the-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A dataset with information for each PA funded by the AFD, a dataset of all PAs reported by the World Database on Protected Areas (WDPA), and datasets on aggregated size at country/region/world level and by year. The latter takes into account potential overlap between PAs reported in the WDPA.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="projects-funded-by-the-afd.html#cb18-1" tabindex="-1"></a><span class="do">##Dataset with one line per PA</span></span>
<span id="cb18-2"><a href="projects-funded-by-the-afd.html#cb18-2" tabindex="-1"></a>data_stat_nodupl <span class="ot">=</span> </span>
<span id="cb18-3"><a href="projects-funded-by-the-afd.html#cb18-3" tabindex="-1"></a>  <span class="co">#fread(&quot;data_tidy/BDD_PA_AFD_nofund_nodupl.csv&quot; , encoding = &quot;UTF-8&quot;)</span></span>
<span id="cb18-4"><a href="projects-funded-by-the-afd.html#cb18-4" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">s3read_using</span>(</span>
<span id="cb18-5"><a href="projects-funded-by-the-afd.html#cb18-5" tabindex="-1"></a>  <span class="at">FUN =</span> data.table<span class="sc">::</span>fread,</span>
<span id="cb18-6"><a href="projects-funded-by-the-afd.html#cb18-6" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>,</span>
<span id="cb18-7"><a href="projects-funded-by-the-afd.html#cb18-7" tabindex="-1"></a>  <span class="co"># Mettre les options de FUN ici</span></span>
<span id="cb18-8"><a href="projects-funded-by-the-afd.html#cb18-8" tabindex="-1"></a>  <span class="at">object =</span> <span class="st">&quot;data_tidy/BDD_PA_AFD_nofund_nodupl.csv&quot;</span>,</span>
<span id="cb18-9"><a href="projects-funded-by-the-afd.html#cb18-9" tabindex="-1"></a>  <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap&quot;</span>,</span>
<span id="cb18-10"><a href="projects-funded-by-the-afd.html#cb18-10" tabindex="-1"></a>  <span class="at">opts =</span> <span class="fu">list</span>(<span class="st">&quot;region&quot;</span> <span class="ot">=</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb18-11"><a href="projects-funded-by-the-afd.html#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="projects-funded-by-the-afd.html#cb18-12" tabindex="-1"></a><span class="co">#Import WDPA data</span></span>
<span id="cb18-13"><a href="projects-funded-by-the-afd.html#cb18-13" tabindex="-1"></a><span class="do">## Downoad and save data directly using the WDPA R package</span></span>
<span id="cb18-14"><a href="projects-funded-by-the-afd.html#cb18-14" tabindex="-1"></a><span class="co"># data_wdpa = wdpa_fetch(x = &quot;global&quot;, wait = TRUE, download_dir = &quot;data_raw&quot;,</span></span>
<span id="cb18-15"><a href="projects-funded-by-the-afd.html#cb18-15" tabindex="-1"></a><span class="co">#                        page_wait = 2, verbose = TRUE)</span></span>
<span id="cb18-16"><a href="projects-funded-by-the-afd.html#cb18-16" tabindex="-1"></a><span class="co"># st_write(wdpa,</span></span>
<span id="cb18-17"><a href="projects-funded-by-the-afd.html#cb18-17" tabindex="-1"></a><span class="co">#          dsn = &quot;data_raw/wdpa/wdpa_shp_global_raw.gpkg&quot;,</span></span>
<span id="cb18-18"><a href="projects-funded-by-the-afd.html#cb18-18" tabindex="-1"></a><span class="co">#          delete_dsn = TRUE)</span></span>
<span id="cb18-19"><a href="projects-funded-by-the-afd.html#cb18-19" tabindex="-1"></a><span class="do">##Loading from the storage</span></span>
<span id="cb18-20"><a href="projects-funded-by-the-afd.html#cb18-20" tabindex="-1"></a>data_wdpa <span class="ot">=</span> </span>
<span id="cb18-21"><a href="projects-funded-by-the-afd.html#cb18-21" tabindex="-1"></a>  <span class="co">#st_read(&quot;data_raw/wdpa/wdpa_shp_global_raw.gpkg&quot;) %&gt;%</span></span>
<span id="cb18-22"><a href="projects-funded-by-the-afd.html#cb18-22" tabindex="-1"></a>  <span class="fu">s3read_using</span>(sf<span class="sc">::</span>st_read,</span>
<span id="cb18-23"><a href="projects-funded-by-the-afd.html#cb18-23" tabindex="-1"></a>              <span class="at">object =</span> <span class="st">&quot;data_raw/wdpa/wdpa_shp_global_raw.gpkg&quot;</span>,</span>
<span id="cb18-24"><a href="projects-funded-by-the-afd.html#cb18-24" tabindex="-1"></a>              <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap&quot;</span>,</span>
<span id="cb18-25"><a href="projects-funded-by-the-afd.html#cb18-25" tabindex="-1"></a>              <span class="at">opts =</span> <span class="fu">list</span>(<span class="st">&quot;region&quot;</span> <span class="ot">=</span> <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-26"><a href="projects-funded-by-the-afd.html#cb18-26" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-27"><a href="projects-funded-by-the-afd.html#cb18-27" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-28"><a href="projects-funded-by-the-afd.html#cb18-28" tabindex="-1"></a>  <span class="co">#Add region, sub-region and country names </span></span>
<span id="cb18-29"><a href="projects-funded-by-the-afd.html#cb18-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> iso3,</span>
<span id="cb18-30"><a href="projects-funded-by-the-afd.html#cb18-30" tabindex="-1"></a>                              <span class="at">origin =</span> <span class="st">&quot;iso3c&quot;</span>,</span>
<span id="cb18-31"><a href="projects-funded-by-the-afd.html#cb18-31" tabindex="-1"></a>                              <span class="at">destination =</span> <span class="st">&quot;un.region.name&quot;</span>),</span>
<span id="cb18-32"><a href="projects-funded-by-the-afd.html#cb18-32" tabindex="-1"></a>         <span class="at">sub_region =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> iso3,</span>
<span id="cb18-33"><a href="projects-funded-by-the-afd.html#cb18-33" tabindex="-1"></a>                              <span class="at">origin =</span> <span class="st">&quot;iso3c&quot;</span>,</span>
<span id="cb18-34"><a href="projects-funded-by-the-afd.html#cb18-34" tabindex="-1"></a>                              <span class="at">destination =</span> <span class="st">&quot;un.regionsub.name&quot;</span>),</span>
<span id="cb18-35"><a href="projects-funded-by-the-afd.html#cb18-35" tabindex="-1"></a>         <span class="at">country_en =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> iso3,</span>
<span id="cb18-36"><a href="projects-funded-by-the-afd.html#cb18-36" tabindex="-1"></a>                              <span class="at">origin =</span> <span class="st">&quot;iso3c&quot;</span>,</span>
<span id="cb18-37"><a href="projects-funded-by-the-afd.html#cb18-37" tabindex="-1"></a>                              <span class="at">destination =</span> <span class="st">&quot;un.name.en&quot;</span>),</span>
<span id="cb18-38"><a href="projects-funded-by-the-afd.html#cb18-38" tabindex="-1"></a>         <span class="at">country_fr =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> iso3,</span>
<span id="cb18-39"><a href="projects-funded-by-the-afd.html#cb18-39" tabindex="-1"></a>                              <span class="at">origin =</span> <span class="st">&quot;iso3c&quot;</span>,</span>
<span id="cb18-40"><a href="projects-funded-by-the-afd.html#cb18-40" tabindex="-1"></a>                              <span class="at">destination =</span> <span class="st">&quot;un.name.fr&quot;</span>),</span>
<span id="cb18-41"><a href="projects-funded-by-the-afd.html#cb18-41" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">&quot;iso3&quot;</span>) </span>
<span id="cb18-42"><a href="projects-funded-by-the-afd.html#cb18-42" tabindex="-1"></a></span>
<span id="cb18-43"><a href="projects-funded-by-the-afd.html#cb18-43" tabindex="-1"></a><span class="do">##Datasets on aggregated size of PAs supported by the AFD per country/region/year and at world level, taking into account the potential spatial overlap.</span></span>
<span id="cb18-44"><a href="projects-funded-by-the-afd.html#cb18-44" tabindex="-1"></a><span class="do">###Country </span></span>
<span id="cb18-45"><a href="projects-funded-by-the-afd.html#cb18-45" tabindex="-1"></a>pa_area_ctry <span class="ot">=</span> </span>
<span id="cb18-46"><a href="projects-funded-by-the-afd.html#cb18-46" tabindex="-1"></a>  <span class="co">#fread(&quot;data_tidy/area/pa_area_ctry.csv&quot;, encoding = &quot;UTF-8&quot;)</span></span>
<span id="cb18-47"><a href="projects-funded-by-the-afd.html#cb18-47" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">s3read_using</span>(</span>
<span id="cb18-48"><a href="projects-funded-by-the-afd.html#cb18-48" tabindex="-1"></a>  <span class="at">FUN =</span> data.table<span class="sc">::</span>fread,</span>
<span id="cb18-49"><a href="projects-funded-by-the-afd.html#cb18-49" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>,</span>
<span id="cb18-50"><a href="projects-funded-by-the-afd.html#cb18-50" tabindex="-1"></a>  <span class="co"># Mettre les options de FUN ici</span></span>
<span id="cb18-51"><a href="projects-funded-by-the-afd.html#cb18-51" tabindex="-1"></a>  <span class="at">object =</span> <span class="st">&quot;data_tidy/area/pa_area_ctry.csv&quot;</span>,</span>
<span id="cb18-52"><a href="projects-funded-by-the-afd.html#cb18-52" tabindex="-1"></a>  <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap&quot;</span>,</span>
<span id="cb18-53"><a href="projects-funded-by-the-afd.html#cb18-53" tabindex="-1"></a>  <span class="at">opts =</span> <span class="fu">list</span>(<span class="st">&quot;region&quot;</span> <span class="ot">=</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb18-54"><a href="projects-funded-by-the-afd.html#cb18-54" tabindex="-1"></a><span class="do">### Region</span></span>
<span id="cb18-55"><a href="projects-funded-by-the-afd.html#cb18-55" tabindex="-1"></a>pa_area_region <span class="ot">=</span></span>
<span id="cb18-56"><a href="projects-funded-by-the-afd.html#cb18-56" tabindex="-1"></a>  <span class="co">#fread(&quot;data_tidy/area/pa_area_region.csv&quot;, encoding = &quot;UTF-8&quot;)</span></span>
<span id="cb18-57"><a href="projects-funded-by-the-afd.html#cb18-57" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">s3read_using</span>(</span>
<span id="cb18-58"><a href="projects-funded-by-the-afd.html#cb18-58" tabindex="-1"></a>  <span class="at">FUN =</span> data.table<span class="sc">::</span>fread,</span>
<span id="cb18-59"><a href="projects-funded-by-the-afd.html#cb18-59" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>,</span>
<span id="cb18-60"><a href="projects-funded-by-the-afd.html#cb18-60" tabindex="-1"></a>  <span class="co"># Mettre les options de FUN ici</span></span>
<span id="cb18-61"><a href="projects-funded-by-the-afd.html#cb18-61" tabindex="-1"></a>  <span class="at">object =</span> <span class="st">&quot;data_tidy/area/pa_area_region.csv&quot;</span>,</span>
<span id="cb18-62"><a href="projects-funded-by-the-afd.html#cb18-62" tabindex="-1"></a>  <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap&quot;</span>,</span>
<span id="cb18-63"><a href="projects-funded-by-the-afd.html#cb18-63" tabindex="-1"></a>  <span class="at">opts =</span> <span class="fu">list</span>(<span class="st">&quot;region&quot;</span> <span class="ot">=</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb18-64"><a href="projects-funded-by-the-afd.html#cb18-64" tabindex="-1"></a><span class="do">### World</span></span>
<span id="cb18-65"><a href="projects-funded-by-the-afd.html#cb18-65" tabindex="-1"></a>pa_area_wld <span class="ot">=</span> </span>
<span id="cb18-66"><a href="projects-funded-by-the-afd.html#cb18-66" tabindex="-1"></a>  <span class="co">#fread(&quot;data_tidy/area/pa_area_wld.csv&quot;, encoding = &quot;UTF-8&quot;)</span></span>
<span id="cb18-67"><a href="projects-funded-by-the-afd.html#cb18-67" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">s3read_using</span>(</span>
<span id="cb18-68"><a href="projects-funded-by-the-afd.html#cb18-68" tabindex="-1"></a>  <span class="at">FUN =</span> data.table<span class="sc">::</span>fread,</span>
<span id="cb18-69"><a href="projects-funded-by-the-afd.html#cb18-69" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>,</span>
<span id="cb18-70"><a href="projects-funded-by-the-afd.html#cb18-70" tabindex="-1"></a>  <span class="co"># Mettre les options de FUN ici</span></span>
<span id="cb18-71"><a href="projects-funded-by-the-afd.html#cb18-71" tabindex="-1"></a>  <span class="at">object =</span> <span class="st">&quot;data_tidy/area/pa_area_wld.csv&quot;</span>,</span>
<span id="cb18-72"><a href="projects-funded-by-the-afd.html#cb18-72" tabindex="-1"></a>  <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap&quot;</span>,</span>
<span id="cb18-73"><a href="projects-funded-by-the-afd.html#cb18-73" tabindex="-1"></a>  <span class="at">opts =</span> <span class="fu">list</span>(<span class="st">&quot;region&quot;</span> <span class="ot">=</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb18-74"><a href="projects-funded-by-the-afd.html#cb18-74" tabindex="-1"></a><span class="do">### By year</span></span>
<span id="cb18-75"><a href="projects-funded-by-the-afd.html#cb18-75" tabindex="-1"></a>pa_int_yr <span class="ot">=</span> </span>
<span id="cb18-76"><a href="projects-funded-by-the-afd.html#cb18-76" tabindex="-1"></a>  <span class="co">#fread(&quot;data_tidy/area/pa_area_dr.csv&quot;, encoding = &quot;UTF-8&quot;)</span></span>
<span id="cb18-77"><a href="projects-funded-by-the-afd.html#cb18-77" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">s3read_using</span>(</span>
<span id="cb18-78"><a href="projects-funded-by-the-afd.html#cb18-78" tabindex="-1"></a>  <span class="at">FUN =</span> data.table<span class="sc">::</span>fread,</span>
<span id="cb18-79"><a href="projects-funded-by-the-afd.html#cb18-79" tabindex="-1"></a>  <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>,</span>
<span id="cb18-80"><a href="projects-funded-by-the-afd.html#cb18-80" tabindex="-1"></a>  <span class="co"># Mettre les options de FUN ici</span></span>
<span id="cb18-81"><a href="projects-funded-by-the-afd.html#cb18-81" tabindex="-1"></a>  <span class="at">object =</span> <span class="st">&quot;data_tidy/area/pa_int_yr.csv&quot;</span>,</span>
<span id="cb18-82"><a href="projects-funded-by-the-afd.html#cb18-82" tabindex="-1"></a>  <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap&quot;</span>,</span>
<span id="cb18-83"><a href="projects-funded-by-the-afd.html#cb18-83" tabindex="-1"></a>  <span class="at">opts =</span> <span class="fu">list</span>(<span class="st">&quot;region&quot;</span> <span class="ot">=</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb18-84"><a href="projects-funded-by-the-afd.html#cb18-84" tabindex="-1"></a></span>
<span id="cb18-85"><a href="projects-funded-by-the-afd.html#cb18-85" tabindex="-1"></a><span class="co">#To perform statistics on the distribution of PAs reported by the WDPA across countries/regions, we focus on not high-income countries.</span></span>
<span id="cb18-86"><a href="projects-funded-by-the-afd.html#cb18-86" tabindex="-1"></a><span class="co">#Precisely, we restrict to countries defined as low-income, lower middle-income, upper-middle income, minus Russia, and including Chile, Uruguay New Caledonia and Panama. Indeed the latter are potential AFD partners while Russia is not, so this country list is more relevant for comparisons between AFD supported PAs and the others.</span></span>
<span id="cb18-87"><a href="projects-funded-by-the-afd.html#cb18-87" tabindex="-1"></a>df_ctry_stat_wdpa <span class="ot">=</span> <span class="fu">WDI</span>(<span class="at">country =</span> <span class="st">&quot;all&quot;</span>, <span class="at">start =</span> <span class="st">&quot;1960&quot;</span>, <span class="at">end =</span> <span class="st">&quot;2022&quot;</span>, <span class="at">extra =</span> <span class="cn">TRUE</span>, <span class="at">language =</span> <span class="st">&quot;en&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-88"><a href="projects-funded-by-the-afd.html#cb18-88" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3c) <span class="sc">%&gt;%</span></span>
<span id="cb18-89"><a href="projects-funded-by-the-afd.html#cb18-89" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-90"><a href="projects-funded-by-the-afd.html#cb18-90" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-91"><a href="projects-funded-by-the-afd.html#cb18-91" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;iso3c&quot;</span>, <span class="st">&quot;income&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-92"><a href="projects-funded-by-the-afd.html#cb18-92" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;iso3&quot;</span> <span class="ot">=</span> <span class="st">&quot;iso3c&quot;</span>,</span>
<span id="cb18-93"><a href="projects-funded-by-the-afd.html#cb18-93" tabindex="-1"></a>         <span class="st">&quot;wb_inc_grp&quot;</span> <span class="ot">=</span> <span class="st">&quot;income&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-94"><a href="projects-funded-by-the-afd.html#cb18-94" tabindex="-1"></a>  <span class="fu">filter</span>((wb_inc_grp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Low income&quot;</span>,  <span class="st">&quot;Lower middle income&quot;</span>, <span class="st">&quot;Upper middle income&quot;</span>) <span class="sc">&amp;</span> iso3 <span class="sc">!=</span> <span class="st">&quot;RUS&quot;</span>) <span class="sc">|</span> iso3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;CHL&quot;</span>, <span class="st">&quot;URY&quot;</span>, <span class="st">&quot;PAN&quot;</span>, <span class="st">&quot;NCL&quot;</span>))</span>
<span id="cb18-95"><a href="projects-funded-by-the-afd.html#cb18-95" tabindex="-1"></a></span>
<span id="cb18-96"><a href="projects-funded-by-the-afd.html#cb18-96" tabindex="-1"></a>lst_ctry_stat_wdpa <span class="ot">=</span> df_ctry_stat_wdpa<span class="sc">$</span>iso3</span></code></pre></div>
</div>
<div id="performing-descriptive-statistics" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Performing descriptive statistics<a href="projects-funded-by-the-afd.html#performing-descriptive-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The figures and tables are drawn and saved as follow. In a first code chunk, a dataset specific to the statistic needed is generated, then plots are built from ggplot package. Finally, a specific code chunk saves the figures and tables (thanks to xtable package) to a temporary folder and put it in the SSPCloud.</p>
<p>Importantly, a specific statistic performed at world and regional level for all and non-marine PAs use same naming for conciseness. See IUCN categories statistics for instance. It is then necessary to generate the relevant plots before running saving chunk, otherwise the lots won’t be saved in the good folder.</p>
<div id="iucn-categories" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> IUCN categories<a href="projects-funded-by-the-afd.html#iucn-categories" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distribution of PAs across the different IUCN categories. This information is reported by the WDPA, thus PAs funded by the AFD but not reported in this database have no information on IUCN categories, and assigned to “not referenced” category. The information on IUCN category is not mandatory in the WDPA, and some PAs have no category reported (“not categorized”).</p>
<div id="share-of-pas-by-iucn-categories-world-all" class="section level4 hasAnchor" number="2.3.1.1">
<h4><span class="header-section-number">2.3.1.1</span> Share of PAs by IUCN categories (world, all)<a href="projects-funded-by-the-afd.html#share-of-pas-by-iucn-categories-world-all" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For all PAs in the world, marine and non-marine.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="projects-funded-by-the-afd.html#cb19-1" tabindex="-1"></a><span class="co">#Building the relevant dataset</span></span>
<span id="cb19-2"><a href="projects-funded-by-the-afd.html#cb19-2" tabindex="-1"></a><span class="do">##For all PAs ..</span></span>
<span id="cb19-3"><a href="projects-funded-by-the-afd.html#cb19-3" tabindex="-1"></a>data_cat_iucn <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="projects-funded-by-the-afd.html#cb19-4" tabindex="-1"></a>  <span class="fu">group_by</span>(iucn_des_en, iucn_des_fr) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="projects-funded-by-the-afd.html#cb19-5" tabindex="-1"></a>  <span class="co">#number of PAs per IUCN category</span></span>
<span id="cb19-6"><a href="projects-funded-by-the-afd.html#cb19-6" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_iucn =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="projects-funded-by-the-afd.html#cb19-7" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="projects-funded-by-the-afd.html#cb19-8" tabindex="-1"></a>  <span class="co">#Frequency of IUCN categories</span></span>
<span id="cb19-9"><a href="projects-funded-by-the-afd.html#cb19-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_pa =</span> <span class="fu">sum</span>(n_iucn),</span>
<span id="cb19-10"><a href="projects-funded-by-the-afd.html#cb19-10" tabindex="-1"></a>         <span class="at">freq_iucn =</span> <span class="fu">round</span>(n_iucn<span class="sc">/</span>n_pa<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="projects-funded-by-the-afd.html#cb19-11" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="projects-funded-by-the-afd.html#cb19-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ypos_iucn =</span> <span class="fu">cumsum</span>(freq_iucn) <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>freq_iucn) </span>
<span id="cb19-13"><a href="projects-funded-by-the-afd.html#cb19-13" tabindex="-1"></a></span>
<span id="cb19-14"><a href="projects-funded-by-the-afd.html#cb19-14" tabindex="-1"></a></span>
<span id="cb19-15"><a href="projects-funded-by-the-afd.html#cb19-15" tabindex="-1"></a><span class="do">##... and for referenced PAs only</span></span>
<span id="cb19-16"><a href="projects-funded-by-the-afd.html#cb19-16" tabindex="-1"></a>data_cat_iucn_ref <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="projects-funded-by-the-afd.html#cb19-17" tabindex="-1"></a>  <span class="co">#Remove not referenced PAs</span></span>
<span id="cb19-18"><a href="projects-funded-by-the-afd.html#cb19-18" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="sc">!</span>(iucn_des_fr <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Non catégorisée&quot;</span>, <span class="st">&quot;Non référencée&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="projects-funded-by-the-afd.html#cb19-19" tabindex="-1"></a>  <span class="fu">group_by</span>(iucn_des_en, iucn_des_fr) <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="projects-funded-by-the-afd.html#cb19-20" tabindex="-1"></a>  <span class="co">#number of PAs per IUCN category</span></span>
<span id="cb19-21"><a href="projects-funded-by-the-afd.html#cb19-21" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_iucn =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb19-22"><a href="projects-funded-by-the-afd.html#cb19-22" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="projects-funded-by-the-afd.html#cb19-23" tabindex="-1"></a>  <span class="co">#Frequency of IUCN categories</span></span>
<span id="cb19-24"><a href="projects-funded-by-the-afd.html#cb19-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_pa =</span> <span class="fu">sum</span>(n_iucn),</span>
<span id="cb19-25"><a href="projects-funded-by-the-afd.html#cb19-25" tabindex="-1"></a>         <span class="at">freq_iucn =</span> <span class="fu">round</span>(n_iucn<span class="sc">/</span>n_pa<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-26"><a href="projects-funded-by-the-afd.html#cb19-26" tabindex="-1"></a>  <span class="fu">arrange</span>(freq_iucn) <span class="sc">%&gt;%</span></span>
<span id="cb19-27"><a href="projects-funded-by-the-afd.html#cb19-27" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ypos_iucn =</span> <span class="fu">cumsum</span>(freq_iucn) <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>freq_iucn) </span>
<span id="cb19-28"><a href="projects-funded-by-the-afd.html#cb19-28" tabindex="-1"></a></span>
<span id="cb19-29"><a href="projects-funded-by-the-afd.html#cb19-29" tabindex="-1"></a><span class="co">#Latex table</span></span>
<span id="cb19-30"><a href="projects-funded-by-the-afd.html#cb19-30" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb19-31"><a href="projects-funded-by-the-afd.html#cb19-31" tabindex="-1"></a>tbl_cat_iucn_fr <span class="ot">=</span> data_cat_iucn <span class="sc">%&gt;%</span></span>
<span id="cb19-32"><a href="projects-funded-by-the-afd.html#cb19-32" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_fr, n_iucn, freq_iucn))</span>
<span id="cb19-33"><a href="projects-funded-by-the-afd.html#cb19-33" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_fr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Catégories IUCN&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>, <span class="st">&quot;Proportion d&#39;AP (%)&quot;</span>)</span>
<span id="cb19-34"><a href="projects-funded-by-the-afd.html#cb19-34" tabindex="-1"></a>tbl_cat_iucn_ref_fr <span class="ot">=</span> data_cat_iucn_ref <span class="sc">%&gt;%</span></span>
<span id="cb19-35"><a href="projects-funded-by-the-afd.html#cb19-35" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_fr, n_iucn, freq_iucn))</span>
<span id="cb19-36"><a href="projects-funded-by-the-afd.html#cb19-36" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_ref_fr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Catégories IUCN&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>, <span class="st">&quot;Proportion d&#39;AP (%)&quot;</span>)</span>
<span id="cb19-37"><a href="projects-funded-by-the-afd.html#cb19-37" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb19-38"><a href="projects-funded-by-the-afd.html#cb19-38" tabindex="-1"></a>tbl_cat_iucn_en <span class="ot">=</span> data_cat_iucn <span class="sc">%&gt;%</span></span>
<span id="cb19-39"><a href="projects-funded-by-the-afd.html#cb19-39" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_en, n_iucn, freq_iucn))</span>
<span id="cb19-40"><a href="projects-funded-by-the-afd.html#cb19-40" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_en) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IUCN categories&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>, <span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb19-41"><a href="projects-funded-by-the-afd.html#cb19-41" tabindex="-1"></a>tbl_cat_iucn_ref_en <span class="ot">=</span> data_cat_iucn_ref <span class="sc">%&gt;%</span></span>
<span id="cb19-42"><a href="projects-funded-by-the-afd.html#cb19-42" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_en, n_iucn, freq_iucn))</span>
<span id="cb19-43"><a href="projects-funded-by-the-afd.html#cb19-43" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_ref_en) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IUCN categories&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>, <span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb19-44"><a href="projects-funded-by-the-afd.html#cb19-44" tabindex="-1"></a></span>
<span id="cb19-45"><a href="projects-funded-by-the-afd.html#cb19-45" tabindex="-1"></a></span>
<span id="cb19-46"><a href="projects-funded-by-the-afd.html#cb19-46" tabindex="-1"></a><span class="co">#Histogram including non-referenced PAs</span></span>
<span id="cb19-47"><a href="projects-funded-by-the-afd.html#cb19-47" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb19-48"><a href="projects-funded-by-the-afd.html#cb19-48" tabindex="-1"></a>hist_cat_iucn_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb19-49"><a href="projects-funded-by-the-afd.html#cb19-49" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_fr, <span class="sc">-</span>freq_iucn), </span>
<span id="cb19-50"><a href="projects-funded-by-the-afd.html#cb19-50" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-51"><a href="projects-funded-by-the-afd.html#cb19-51" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-52"><a href="projects-funded-by-the-afd.html#cb19-52" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb19-53"><a href="projects-funded-by-the-afd.html#cb19-53" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb19-54"><a href="projects-funded-by-the-afd.html#cb19-54" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-55"><a href="projects-funded-by-the-afd.html#cb19-55" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées par catégorie IUCN&quot;</span>,</span>
<span id="cb19-56"><a href="projects-funded-by-the-afd.html#cb19-56" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées. Nombre d&#39;aires indiqué sur les barres.&quot;</span>),</span>
<span id="cb19-57"><a href="projects-funded-by-the-afd.html#cb19-57" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Catégories IUCN&quot;</span>, </span>
<span id="cb19-58"><a href="projects-funded-by-the-afd.html#cb19-58" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Proportion (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-59"><a href="projects-funded-by-the-afd.html#cb19-59" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb19-60"><a href="projects-funded-by-the-afd.html#cb19-60" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb19-61"><a href="projects-funded-by-the-afd.html#cb19-61" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb19-62"><a href="projects-funded-by-the-afd.html#cb19-62" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb19-63"><a href="projects-funded-by-the-afd.html#cb19-63" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb19-64"><a href="projects-funded-by-the-afd.html#cb19-64" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-65"><a href="projects-funded-by-the-afd.html#cb19-65" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-66"><a href="projects-funded-by-the-afd.html#cb19-66" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-67"><a href="projects-funded-by-the-afd.html#cb19-67" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb19-68"><a href="projects-funded-by-the-afd.html#cb19-68" tabindex="-1"></a>hist_cat_iucn_fr</span>
<span id="cb19-69"><a href="projects-funded-by-the-afd.html#cb19-69" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb19-70"><a href="projects-funded-by-the-afd.html#cb19-70" tabindex="-1"></a>hist_cat_iucn_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb19-71"><a href="projects-funded-by-the-afd.html#cb19-71" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_en, <span class="sc">-</span>freq_iucn), </span>
<span id="cb19-72"><a href="projects-funded-by-the-afd.html#cb19-72" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-73"><a href="projects-funded-by-the-afd.html#cb19-73" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-74"><a href="projects-funded-by-the-afd.html#cb19-74" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb19-75"><a href="projects-funded-by-the-afd.html#cb19-75" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb19-76"><a href="projects-funded-by-the-afd.html#cb19-76" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-77"><a href="projects-funded-by-the-afd.html#cb19-77" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of protected areas by IUCN categories&quot;</span>,</span>
<span id="cb19-78"><a href="projects-funded-by-the-afd.html#cb19-78" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;protected areas. Number of areas indicated above the bars.&quot;</span>),</span>
<span id="cb19-79"><a href="projects-funded-by-the-afd.html#cb19-79" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;IUCN categories&quot;</span>, </span>
<span id="cb19-80"><a href="projects-funded-by-the-afd.html#cb19-80" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Share (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-81"><a href="projects-funded-by-the-afd.html#cb19-81" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb19-82"><a href="projects-funded-by-the-afd.html#cb19-82" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb19-83"><a href="projects-funded-by-the-afd.html#cb19-83" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb19-84"><a href="projects-funded-by-the-afd.html#cb19-84" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb19-85"><a href="projects-funded-by-the-afd.html#cb19-85" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb19-86"><a href="projects-funded-by-the-afd.html#cb19-86" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-87"><a href="projects-funded-by-the-afd.html#cb19-87" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-88"><a href="projects-funded-by-the-afd.html#cb19-88" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-89"><a href="projects-funded-by-the-afd.html#cb19-89" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb19-90"><a href="projects-funded-by-the-afd.html#cb19-90" tabindex="-1"></a>hist_cat_iucn_en</span>
<span id="cb19-91"><a href="projects-funded-by-the-afd.html#cb19-91" tabindex="-1"></a></span>
<span id="cb19-92"><a href="projects-funded-by-the-afd.html#cb19-92" tabindex="-1"></a><span class="co">#Histogram excluding non-referenced PAs</span></span>
<span id="cb19-93"><a href="projects-funded-by-the-afd.html#cb19-93" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb19-94"><a href="projects-funded-by-the-afd.html#cb19-94" tabindex="-1"></a>hist_cat_iucn_ref_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb19-95"><a href="projects-funded-by-the-afd.html#cb19-95" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_fr, <span class="sc">-</span>freq_iucn), </span>
<span id="cb19-96"><a href="projects-funded-by-the-afd.html#cb19-96" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-97"><a href="projects-funded-by-the-afd.html#cb19-97" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-98"><a href="projects-funded-by-the-afd.html#cb19-98" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb19-99"><a href="projects-funded-by-the-afd.html#cb19-99" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb19-100"><a href="projects-funded-by-the-afd.html#cb19-100" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-101"><a href="projects-funded-by-the-afd.html#cb19-101" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées par catégorie IUCN (hors AP non-répertoriées)&quot;</span>,</span>
<span id="cb19-102"><a href="projects-funded-by-the-afd.html#cb19-102" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;sur&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées. Nombre d&#39;aires indiqué sur les barres.&quot;</span>),</span>
<span id="cb19-103"><a href="projects-funded-by-the-afd.html#cb19-103" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Catégories IUCN&quot;</span>, </span>
<span id="cb19-104"><a href="projects-funded-by-the-afd.html#cb19-104" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Nombre (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-105"><a href="projects-funded-by-the-afd.html#cb19-105" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb19-106"><a href="projects-funded-by-the-afd.html#cb19-106" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb19-107"><a href="projects-funded-by-the-afd.html#cb19-107" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb19-108"><a href="projects-funded-by-the-afd.html#cb19-108" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb19-109"><a href="projects-funded-by-the-afd.html#cb19-109" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb19-110"><a href="projects-funded-by-the-afd.html#cb19-110" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-111"><a href="projects-funded-by-the-afd.html#cb19-111" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-112"><a href="projects-funded-by-the-afd.html#cb19-112" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-113"><a href="projects-funded-by-the-afd.html#cb19-113" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb19-114"><a href="projects-funded-by-the-afd.html#cb19-114" tabindex="-1"></a>hist_cat_iucn_ref_fr</span>
<span id="cb19-115"><a href="projects-funded-by-the-afd.html#cb19-115" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb19-116"><a href="projects-funded-by-the-afd.html#cb19-116" tabindex="-1"></a>hist_cat_iucn_ref_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb19-117"><a href="projects-funded-by-the-afd.html#cb19-117" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_en, <span class="sc">-</span>freq_iucn), </span>
<span id="cb19-118"><a href="projects-funded-by-the-afd.html#cb19-118" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-119"><a href="projects-funded-by-the-afd.html#cb19-119" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-120"><a href="projects-funded-by-the-afd.html#cb19-120" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb19-121"><a href="projects-funded-by-the-afd.html#cb19-121" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb19-122"><a href="projects-funded-by-the-afd.html#cb19-122" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-123"><a href="projects-funded-by-the-afd.html#cb19-123" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of protected areas by IUCN categories (excluding not reported/categorized)&quot;</span>,</span>
<span id="cb19-124"><a href="projects-funded-by-the-afd.html#cb19-124" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;out of&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;protected areas. Number of areas indicated above the bars.&quot;</span>),</span>
<span id="cb19-125"><a href="projects-funded-by-the-afd.html#cb19-125" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;IUCN categories&quot;</span>, </span>
<span id="cb19-126"><a href="projects-funded-by-the-afd.html#cb19-126" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Share (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-127"><a href="projects-funded-by-the-afd.html#cb19-127" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb19-128"><a href="projects-funded-by-the-afd.html#cb19-128" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb19-129"><a href="projects-funded-by-the-afd.html#cb19-129" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb19-130"><a href="projects-funded-by-the-afd.html#cb19-130" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb19-131"><a href="projects-funded-by-the-afd.html#cb19-131" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb19-132"><a href="projects-funded-by-the-afd.html#cb19-132" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-133"><a href="projects-funded-by-the-afd.html#cb19-133" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-134"><a href="projects-funded-by-the-afd.html#cb19-134" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb19-135"><a href="projects-funded-by-the-afd.html#cb19-135" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb19-136"><a href="projects-funded-by-the-afd.html#cb19-136" tabindex="-1"></a>hist_cat_iucn_ref_en</span>
<span id="cb19-137"><a href="projects-funded-by-the-afd.html#cb19-137" tabindex="-1"></a></span>
<span id="cb19-138"><a href="projects-funded-by-the-afd.html#cb19-138" tabindex="-1"></a></span>
<span id="cb19-139"><a href="projects-funded-by-the-afd.html#cb19-139" tabindex="-1"></a><span class="co">#Pie chart INcluding non-referenced PAs</span></span>
<span id="cb19-140"><a href="projects-funded-by-the-afd.html#cb19-140" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb19-141"><a href="projects-funded-by-the-afd.html#cb19-141" tabindex="-1"></a>pie_cat_iucn_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb19-142"><a href="projects-funded-by-the-afd.html#cb19-142" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb19-143"><a href="projects-funded-by-the-afd.html#cb19-143" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-144"><a href="projects-funded-by-the-afd.html#cb19-144" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-145"><a href="projects-funded-by-the-afd.html#cb19-145" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb19-146"><a href="projects-funded-by-the-afd.html#cb19-146" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb19-147"><a href="projects-funded-by-the-afd.html#cb19-147" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb19-148"><a href="projects-funded-by-the-afd.html#cb19-148" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-149"><a href="projects-funded-by-the-afd.html#cb19-149" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb19-150"><a href="projects-funded-by-the-afd.html#cb19-150" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb19-151"><a href="projects-funded-by-the-afd.html#cb19-151" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb19-152"><a href="projects-funded-by-the-afd.html#cb19-152" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb19-153"><a href="projects-funded-by-the-afd.html#cb19-153" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-154"><a href="projects-funded-by-the-afd.html#cb19-154" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées par catégorie IUCN (%)&quot;</span>,</span>
<span id="cb19-155"><a href="projects-funded-by-the-afd.html#cb19-155" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-156"><a href="projects-funded-by-the-afd.html#cb19-156" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Catégories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-157"><a href="projects-funded-by-the-afd.html#cb19-157" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb19-158"><a href="projects-funded-by-the-afd.html#cb19-158" tabindex="-1"></a>pie_cat_iucn_fr</span>
<span id="cb19-159"><a href="projects-funded-by-the-afd.html#cb19-159" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb19-160"><a href="projects-funded-by-the-afd.html#cb19-160" tabindex="-1"></a>pie_cat_iucn_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb19-161"><a href="projects-funded-by-the-afd.html#cb19-161" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb19-162"><a href="projects-funded-by-the-afd.html#cb19-162" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-163"><a href="projects-funded-by-the-afd.html#cb19-163" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-164"><a href="projects-funded-by-the-afd.html#cb19-164" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb19-165"><a href="projects-funded-by-the-afd.html#cb19-165" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb19-166"><a href="projects-funded-by-the-afd.html#cb19-166" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb19-167"><a href="projects-funded-by-the-afd.html#cb19-167" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-168"><a href="projects-funded-by-the-afd.html#cb19-168" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb19-169"><a href="projects-funded-by-the-afd.html#cb19-169" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb19-170"><a href="projects-funded-by-the-afd.html#cb19-170" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb19-171"><a href="projects-funded-by-the-afd.html#cb19-171" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb19-172"><a href="projects-funded-by-the-afd.html#cb19-172" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-173"><a href="projects-funded-by-the-afd.html#cb19-173" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Distribution of protected areas by IUCN categories (%)&quot;</span>,</span>
<span id="cb19-174"><a href="projects-funded-by-the-afd.html#cb19-174" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-175"><a href="projects-funded-by-the-afd.html#cb19-175" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Categories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-176"><a href="projects-funded-by-the-afd.html#cb19-176" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb19-177"><a href="projects-funded-by-the-afd.html#cb19-177" tabindex="-1"></a>pie_cat_iucn_en</span>
<span id="cb19-178"><a href="projects-funded-by-the-afd.html#cb19-178" tabindex="-1"></a></span>
<span id="cb19-179"><a href="projects-funded-by-the-afd.html#cb19-179" tabindex="-1"></a></span>
<span id="cb19-180"><a href="projects-funded-by-the-afd.html#cb19-180" tabindex="-1"></a></span>
<span id="cb19-181"><a href="projects-funded-by-the-afd.html#cb19-181" tabindex="-1"></a><span class="co">#Pie chart EXcluding non-referenced PAs</span></span>
<span id="cb19-182"><a href="projects-funded-by-the-afd.html#cb19-182" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb19-183"><a href="projects-funded-by-the-afd.html#cb19-183" tabindex="-1"></a>pie_cat_iucn_ref_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb19-184"><a href="projects-funded-by-the-afd.html#cb19-184" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb19-185"><a href="projects-funded-by-the-afd.html#cb19-185" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-186"><a href="projects-funded-by-the-afd.html#cb19-186" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-187"><a href="projects-funded-by-the-afd.html#cb19-187" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb19-188"><a href="projects-funded-by-the-afd.html#cb19-188" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb19-189"><a href="projects-funded-by-the-afd.html#cb19-189" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb19-190"><a href="projects-funded-by-the-afd.html#cb19-190" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-191"><a href="projects-funded-by-the-afd.html#cb19-191" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb19-192"><a href="projects-funded-by-the-afd.html#cb19-192" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb19-193"><a href="projects-funded-by-the-afd.html#cb19-193" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb19-194"><a href="projects-funded-by-the-afd.html#cb19-194" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb19-195"><a href="projects-funded-by-the-afd.html#cb19-195" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-196"><a href="projects-funded-by-the-afd.html#cb19-196" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées par catégorie IUCN </span><span class="sc">\n</span><span class="st">hors aires non répertoriées (%)&quot;</span>,</span>
<span id="cb19-197"><a href="projects-funded-by-the-afd.html#cb19-197" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;sur&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-198"><a href="projects-funded-by-the-afd.html#cb19-198" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Catégories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-199"><a href="projects-funded-by-the-afd.html#cb19-199" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb19-200"><a href="projects-funded-by-the-afd.html#cb19-200" tabindex="-1"></a>pie_cat_iucn_ref_fr</span>
<span id="cb19-201"><a href="projects-funded-by-the-afd.html#cb19-201" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb19-202"><a href="projects-funded-by-the-afd.html#cb19-202" tabindex="-1"></a>pie_cat_iucn_ref_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb19-203"><a href="projects-funded-by-the-afd.html#cb19-203" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb19-204"><a href="projects-funded-by-the-afd.html#cb19-204" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-205"><a href="projects-funded-by-the-afd.html#cb19-205" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-206"><a href="projects-funded-by-the-afd.html#cb19-206" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb19-207"><a href="projects-funded-by-the-afd.html#cb19-207" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb19-208"><a href="projects-funded-by-the-afd.html#cb19-208" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb19-209"><a href="projects-funded-by-the-afd.html#cb19-209" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-210"><a href="projects-funded-by-the-afd.html#cb19-210" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb19-211"><a href="projects-funded-by-the-afd.html#cb19-211" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb19-212"><a href="projects-funded-by-the-afd.html#cb19-212" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb19-213"><a href="projects-funded-by-the-afd.html#cb19-213" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb19-214"><a href="projects-funded-by-the-afd.html#cb19-214" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-215"><a href="projects-funded-by-the-afd.html#cb19-215" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Distribution of protected areas by IUCN categories </span><span class="sc">\n</span><span class="st">excluding not reported/categorized (%)&quot;</span>,</span>
<span id="cb19-216"><a href="projects-funded-by-the-afd.html#cb19-216" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;out of&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn),  <span class="st">&quot;protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-217"><a href="projects-funded-by-the-afd.html#cb19-217" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Categories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-218"><a href="projects-funded-by-the-afd.html#cb19-218" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb19-219"><a href="projects-funded-by-the-afd.html#cb19-219" tabindex="-1"></a>pie_cat_iucn_ref_en</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="projects-funded-by-the-afd.html#cb20-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb20-2"><a href="projects-funded-by-the-afd.html#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="projects-funded-by-the-afd.html#cb20-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb20-4"><a href="projects-funded-by-the-afd.html#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="projects-funded-by-the-afd.html#cb20-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb20-6"><a href="projects-funded-by-the-afd.html#cb20-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_fr,</span>
<span id="cb20-7"><a href="projects-funded-by-the-afd.html#cb20-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb20-8"><a href="projects-funded-by-the-afd.html#cb20-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb20-9"><a href="projects-funded-by-the-afd.html#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="projects-funded-by-the-afd.html#cb20-10" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb20-11"><a href="projects-funded-by-the-afd.html#cb20-11" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_en,</span>
<span id="cb20-12"><a href="projects-funded-by-the-afd.html#cb20-12" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb20-13"><a href="projects-funded-by-the-afd.html#cb20-13" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb20-14"><a href="projects-funded-by-the-afd.html#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="projects-funded-by-the-afd.html#cb20-15" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_ref_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb20-16"><a href="projects-funded-by-the-afd.html#cb20-16" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_ref_fr,</span>
<span id="cb20-17"><a href="projects-funded-by-the-afd.html#cb20-17" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb20-18"><a href="projects-funded-by-the-afd.html#cb20-18" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb20-19"><a href="projects-funded-by-the-afd.html#cb20-19" tabindex="-1"></a></span>
<span id="cb20-20"><a href="projects-funded-by-the-afd.html#cb20-20" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_ref_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb20-21"><a href="projects-funded-by-the-afd.html#cb20-21" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_ref_en,</span>
<span id="cb20-22"><a href="projects-funded-by-the-afd.html#cb20-22" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb20-23"><a href="projects-funded-by-the-afd.html#cb20-23" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb20-24"><a href="projects-funded-by-the-afd.html#cb20-24" tabindex="-1"></a></span>
<span id="cb20-25"><a href="projects-funded-by-the-afd.html#cb20-25" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb20-26"><a href="projects-funded-by-the-afd.html#cb20-26" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_fr,</span>
<span id="cb20-27"><a href="projects-funded-by-the-afd.html#cb20-27" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb20-28"><a href="projects-funded-by-the-afd.html#cb20-28" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb20-29"><a href="projects-funded-by-the-afd.html#cb20-29" tabindex="-1"></a></span>
<span id="cb20-30"><a href="projects-funded-by-the-afd.html#cb20-30" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb20-31"><a href="projects-funded-by-the-afd.html#cb20-31" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_en,</span>
<span id="cb20-32"><a href="projects-funded-by-the-afd.html#cb20-32" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb20-33"><a href="projects-funded-by-the-afd.html#cb20-33" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb20-34"><a href="projects-funded-by-the-afd.html#cb20-34" tabindex="-1"></a></span>
<span id="cb20-35"><a href="projects-funded-by-the-afd.html#cb20-35" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_ref_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb20-36"><a href="projects-funded-by-the-afd.html#cb20-36" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_ref_fr,</span>
<span id="cb20-37"><a href="projects-funded-by-the-afd.html#cb20-37" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb20-38"><a href="projects-funded-by-the-afd.html#cb20-38" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb20-39"><a href="projects-funded-by-the-afd.html#cb20-39" tabindex="-1"></a></span>
<span id="cb20-40"><a href="projects-funded-by-the-afd.html#cb20-40" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_ref_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb20-41"><a href="projects-funded-by-the-afd.html#cb20-41" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_ref_en,</span>
<span id="cb20-42"><a href="projects-funded-by-the-afd.html#cb20-42" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb20-43"><a href="projects-funded-by-the-afd.html#cb20-43" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb20-44"><a href="projects-funded-by-the-afd.html#cb20-44" tabindex="-1"></a></span>
<span id="cb20-45"><a href="projects-funded-by-the-afd.html#cb20-45" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb20-46"><a href="projects-funded-by-the-afd.html#cb20-46" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb20-47"><a href="projects-funded-by-the-afd.html#cb20-47" tabindex="-1"></a></span>
<span id="cb20-48"><a href="projects-funded-by-the-afd.html#cb20-48" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb20-49"><a href="projects-funded-by-the-afd.html#cb20-49" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb20-50"><a href="projects-funded-by-the-afd.html#cb20-50" tabindex="-1"></a></span>
<span id="cb20-51"><a href="projects-funded-by-the-afd.html#cb20-51" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_ref_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb20-52"><a href="projects-funded-by-the-afd.html#cb20-52" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_ref_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb20-53"><a href="projects-funded-by-the-afd.html#cb20-53" tabindex="-1"></a></span>
<span id="cb20-54"><a href="projects-funded-by-the-afd.html#cb20-54" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_ref_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb20-55"><a href="projects-funded-by-the-afd.html#cb20-55" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_ref_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb20-56"><a href="projects-funded-by-the-afd.html#cb20-56" tabindex="-1"></a></span>
<span id="cb20-57"><a href="projects-funded-by-the-afd.html#cb20-57" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb20-58"><a href="projects-funded-by-the-afd.html#cb20-58" tabindex="-1"></a></span>
<span id="cb20-59"><a href="projects-funded-by-the-afd.html#cb20-59" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb20-60"><a href="projects-funded-by-the-afd.html#cb20-60" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-61"><a href="projects-funded-by-the-afd.html#cb20-61" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb20-62"><a href="projects-funded-by-the-afd.html#cb20-62" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb20-63"><a href="projects-funded-by-the-afd.html#cb20-63" tabindex="-1"></a>  {</span>
<span id="cb20-64"><a href="projects-funded-by-the-afd.html#cb20-64" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;&#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb20-65"><a href="projects-funded-by-the-afd.html#cb20-65" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb20-66"><a href="projects-funded-by-the-afd.html#cb20-66" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/IUCN/world/all&quot;</span>, </span>
<span id="cb20-67"><a href="projects-funded-by-the-afd.html#cb20-67" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-68"><a href="projects-funded-by-the-afd.html#cb20-68" tabindex="-1"></a>  }</span>
<span id="cb20-69"><a href="projects-funded-by-the-afd.html#cb20-69" tabindex="-1"></a></span>
<span id="cb20-70"><a href="projects-funded-by-the-afd.html#cb20-70" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb20-71"><a href="projects-funded-by-the-afd.html#cb20-71" tabindex="-1"></a></span>
<span id="cb20-72"><a href="projects-funded-by-the-afd.html#cb20-72" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="share-of-pas-by-iucn-categories-world-no-marine" class="section level4 hasAnchor" number="2.3.1.2">
<h4><span class="header-section-number">2.3.1.2</span> Share of PAs by IUCN categories (world, no marine)<a href="projects-funded-by-the-afd.html#share-of-pas-by-iucn-categories-world-no-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For PAs across the world, non-marine only.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="projects-funded-by-the-afd.html#cb21-1" tabindex="-1"></a><span class="co">#Building the relevant dataset</span></span>
<span id="cb21-2"><a href="projects-funded-by-the-afd.html#cb21-2" tabindex="-1"></a><span class="do">##For all PAs ..</span></span>
<span id="cb21-3"><a href="projects-funded-by-the-afd.html#cb21-3" tabindex="-1"></a>data_cat_iucn <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="projects-funded-by-the-afd.html#cb21-4" tabindex="-1"></a>  <span class="co">#Keep only terrestrial or coastal PA (when unknown, discarded)</span></span>
<span id="cb21-5"><a href="projects-funded-by-the-afd.html#cb21-5" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="projects-funded-by-the-afd.html#cb21-6" tabindex="-1"></a>  <span class="fu">group_by</span>(iucn_des_en, iucn_des_fr) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="projects-funded-by-the-afd.html#cb21-7" tabindex="-1"></a>  <span class="co">#number of PAs per IUCN category</span></span>
<span id="cb21-8"><a href="projects-funded-by-the-afd.html#cb21-8" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_iucn =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="projects-funded-by-the-afd.html#cb21-9" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="projects-funded-by-the-afd.html#cb21-10" tabindex="-1"></a>  <span class="co">#Frequency of IUCN categories</span></span>
<span id="cb21-11"><a href="projects-funded-by-the-afd.html#cb21-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_pa =</span> <span class="fu">sum</span>(n_iucn),</span>
<span id="cb21-12"><a href="projects-funded-by-the-afd.html#cb21-12" tabindex="-1"></a>         <span class="at">freq_iucn =</span> <span class="fu">round</span>(n_iucn<span class="sc">/</span>n_pa<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="projects-funded-by-the-afd.html#cb21-13" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="projects-funded-by-the-afd.html#cb21-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ypos_iucn =</span> <span class="fu">cumsum</span>(freq_iucn) <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>freq_iucn) </span>
<span id="cb21-15"><a href="projects-funded-by-the-afd.html#cb21-15" tabindex="-1"></a></span>
<span id="cb21-16"><a href="projects-funded-by-the-afd.html#cb21-16" tabindex="-1"></a></span>
<span id="cb21-17"><a href="projects-funded-by-the-afd.html#cb21-17" tabindex="-1"></a><span class="do">##... and for referenced PAs only</span></span>
<span id="cb21-18"><a href="projects-funded-by-the-afd.html#cb21-18" tabindex="-1"></a>data_cat_iucn_ref <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="projects-funded-by-the-afd.html#cb21-19" tabindex="-1"></a>  <span class="co">#Keep only terrestrial or coastal PA (when unknown, discarded)</span></span>
<span id="cb21-20"><a href="projects-funded-by-the-afd.html#cb21-20" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="projects-funded-by-the-afd.html#cb21-21" tabindex="-1"></a>  <span class="co">#Remove not referenced PAs</span></span>
<span id="cb21-22"><a href="projects-funded-by-the-afd.html#cb21-22" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="sc">!</span>(iucn_des_fr <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Non catégorisée&quot;</span>, <span class="st">&quot;Non référencée&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="projects-funded-by-the-afd.html#cb21-23" tabindex="-1"></a>  <span class="fu">group_by</span>(iucn_des_en, iucn_des_fr) <span class="sc">%&gt;%</span></span>
<span id="cb21-24"><a href="projects-funded-by-the-afd.html#cb21-24" tabindex="-1"></a>  <span class="co">#number of PAs per IUCN category</span></span>
<span id="cb21-25"><a href="projects-funded-by-the-afd.html#cb21-25" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_iucn =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb21-26"><a href="projects-funded-by-the-afd.html#cb21-26" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-27"><a href="projects-funded-by-the-afd.html#cb21-27" tabindex="-1"></a>  <span class="co">#Frequency of IUCN categories</span></span>
<span id="cb21-28"><a href="projects-funded-by-the-afd.html#cb21-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_pa =</span> <span class="fu">sum</span>(n_iucn),</span>
<span id="cb21-29"><a href="projects-funded-by-the-afd.html#cb21-29" tabindex="-1"></a>         <span class="at">freq_iucn =</span> <span class="fu">round</span>(n_iucn<span class="sc">/</span>n_pa<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-30"><a href="projects-funded-by-the-afd.html#cb21-30" tabindex="-1"></a>  <span class="fu">arrange</span>(freq_iucn) <span class="sc">%&gt;%</span></span>
<span id="cb21-31"><a href="projects-funded-by-the-afd.html#cb21-31" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ypos_iucn =</span> <span class="fu">cumsum</span>(freq_iucn) <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>freq_iucn) </span>
<span id="cb21-32"><a href="projects-funded-by-the-afd.html#cb21-32" tabindex="-1"></a></span>
<span id="cb21-33"><a href="projects-funded-by-the-afd.html#cb21-33" tabindex="-1"></a><span class="co">#Latex table</span></span>
<span id="cb21-34"><a href="projects-funded-by-the-afd.html#cb21-34" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb21-35"><a href="projects-funded-by-the-afd.html#cb21-35" tabindex="-1"></a>tbl_cat_iucn_fr <span class="ot">=</span> data_cat_iucn <span class="sc">%&gt;%</span></span>
<span id="cb21-36"><a href="projects-funded-by-the-afd.html#cb21-36" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_fr, n_iucn, freq_iucn))</span>
<span id="cb21-37"><a href="projects-funded-by-the-afd.html#cb21-37" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_fr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Catégories IUCN&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>, <span class="st">&quot;Proportion d&#39;AP (%)&quot;</span>)</span>
<span id="cb21-38"><a href="projects-funded-by-the-afd.html#cb21-38" tabindex="-1"></a>tbl_cat_iucn_ref_fr <span class="ot">=</span> data_cat_iucn_ref <span class="sc">%&gt;%</span></span>
<span id="cb21-39"><a href="projects-funded-by-the-afd.html#cb21-39" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_fr, n_iucn, freq_iucn))</span>
<span id="cb21-40"><a href="projects-funded-by-the-afd.html#cb21-40" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_ref_fr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Catégories IUCN&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>, <span class="st">&quot;Proportion d&#39;AP (%)&quot;</span>)</span>
<span id="cb21-41"><a href="projects-funded-by-the-afd.html#cb21-41" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb21-42"><a href="projects-funded-by-the-afd.html#cb21-42" tabindex="-1"></a>tbl_cat_iucn_en <span class="ot">=</span> data_cat_iucn <span class="sc">%&gt;%</span></span>
<span id="cb21-43"><a href="projects-funded-by-the-afd.html#cb21-43" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_en, n_iucn, freq_iucn))</span>
<span id="cb21-44"><a href="projects-funded-by-the-afd.html#cb21-44" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_en) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IUCN categories&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>, <span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb21-45"><a href="projects-funded-by-the-afd.html#cb21-45" tabindex="-1"></a>tbl_cat_iucn_ref_en <span class="ot">=</span> data_cat_iucn_ref <span class="sc">%&gt;%</span></span>
<span id="cb21-46"><a href="projects-funded-by-the-afd.html#cb21-46" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_en, n_iucn, freq_iucn))</span>
<span id="cb21-47"><a href="projects-funded-by-the-afd.html#cb21-47" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_ref_en) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IUCN categories&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>, <span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb21-48"><a href="projects-funded-by-the-afd.html#cb21-48" tabindex="-1"></a></span>
<span id="cb21-49"><a href="projects-funded-by-the-afd.html#cb21-49" tabindex="-1"></a></span>
<span id="cb21-50"><a href="projects-funded-by-the-afd.html#cb21-50" tabindex="-1"></a><span class="co">#Histogram including non-referenced PAs</span></span>
<span id="cb21-51"><a href="projects-funded-by-the-afd.html#cb21-51" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb21-52"><a href="projects-funded-by-the-afd.html#cb21-52" tabindex="-1"></a>hist_cat_iucn_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb21-53"><a href="projects-funded-by-the-afd.html#cb21-53" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_fr, <span class="sc">-</span>freq_iucn), </span>
<span id="cb21-54"><a href="projects-funded-by-the-afd.html#cb21-54" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-55"><a href="projects-funded-by-the-afd.html#cb21-55" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-56"><a href="projects-funded-by-the-afd.html#cb21-56" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb21-57"><a href="projects-funded-by-the-afd.html#cb21-57" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb21-58"><a href="projects-funded-by-the-afd.html#cb21-58" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-59"><a href="projects-funded-by-the-afd.html#cb21-59" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées non-marines par catégorie IUCN&quot;</span>,</span>
<span id="cb21-60"><a href="projects-funded-by-the-afd.html#cb21-60" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées non-marines. Nombre d&#39;aires indiqué sur les barres.&quot;</span>),</span>
<span id="cb21-61"><a href="projects-funded-by-the-afd.html#cb21-61" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Catégories IUCN&quot;</span>, </span>
<span id="cb21-62"><a href="projects-funded-by-the-afd.html#cb21-62" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Proportion (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-63"><a href="projects-funded-by-the-afd.html#cb21-63" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb21-64"><a href="projects-funded-by-the-afd.html#cb21-64" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb21-65"><a href="projects-funded-by-the-afd.html#cb21-65" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb21-66"><a href="projects-funded-by-the-afd.html#cb21-66" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb21-67"><a href="projects-funded-by-the-afd.html#cb21-67" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb21-68"><a href="projects-funded-by-the-afd.html#cb21-68" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-69"><a href="projects-funded-by-the-afd.html#cb21-69" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-70"><a href="projects-funded-by-the-afd.html#cb21-70" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-71"><a href="projects-funded-by-the-afd.html#cb21-71" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb21-72"><a href="projects-funded-by-the-afd.html#cb21-72" tabindex="-1"></a>hist_cat_iucn_fr</span>
<span id="cb21-73"><a href="projects-funded-by-the-afd.html#cb21-73" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb21-74"><a href="projects-funded-by-the-afd.html#cb21-74" tabindex="-1"></a>hist_cat_iucn_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb21-75"><a href="projects-funded-by-the-afd.html#cb21-75" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_en, <span class="sc">-</span>freq_iucn), </span>
<span id="cb21-76"><a href="projects-funded-by-the-afd.html#cb21-76" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-77"><a href="projects-funded-by-the-afd.html#cb21-77" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-78"><a href="projects-funded-by-the-afd.html#cb21-78" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb21-79"><a href="projects-funded-by-the-afd.html#cb21-79" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb21-80"><a href="projects-funded-by-the-afd.html#cb21-80" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-81"><a href="projects-funded-by-the-afd.html#cb21-81" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of non-marine protected areas by IUCN categories&quot;</span>,</span>
<span id="cb21-82"><a href="projects-funded-by-the-afd.html#cb21-82" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;non-marine protected areas. Number of areas indicated above the bars.&quot;</span>),</span>
<span id="cb21-83"><a href="projects-funded-by-the-afd.html#cb21-83" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;IUCN categories&quot;</span>, </span>
<span id="cb21-84"><a href="projects-funded-by-the-afd.html#cb21-84" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Share (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-85"><a href="projects-funded-by-the-afd.html#cb21-85" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb21-86"><a href="projects-funded-by-the-afd.html#cb21-86" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb21-87"><a href="projects-funded-by-the-afd.html#cb21-87" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb21-88"><a href="projects-funded-by-the-afd.html#cb21-88" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb21-89"><a href="projects-funded-by-the-afd.html#cb21-89" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb21-90"><a href="projects-funded-by-the-afd.html#cb21-90" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-91"><a href="projects-funded-by-the-afd.html#cb21-91" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-92"><a href="projects-funded-by-the-afd.html#cb21-92" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-93"><a href="projects-funded-by-the-afd.html#cb21-93" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb21-94"><a href="projects-funded-by-the-afd.html#cb21-94" tabindex="-1"></a>hist_cat_iucn_en</span>
<span id="cb21-95"><a href="projects-funded-by-the-afd.html#cb21-95" tabindex="-1"></a></span>
<span id="cb21-96"><a href="projects-funded-by-the-afd.html#cb21-96" tabindex="-1"></a><span class="co">#Histogram excluding non-referenced PAs</span></span>
<span id="cb21-97"><a href="projects-funded-by-the-afd.html#cb21-97" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb21-98"><a href="projects-funded-by-the-afd.html#cb21-98" tabindex="-1"></a>hist_cat_iucn_ref_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb21-99"><a href="projects-funded-by-the-afd.html#cb21-99" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_fr, <span class="sc">-</span>freq_iucn), </span>
<span id="cb21-100"><a href="projects-funded-by-the-afd.html#cb21-100" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-101"><a href="projects-funded-by-the-afd.html#cb21-101" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-102"><a href="projects-funded-by-the-afd.html#cb21-102" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb21-103"><a href="projects-funded-by-the-afd.html#cb21-103" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb21-104"><a href="projects-funded-by-the-afd.html#cb21-104" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-105"><a href="projects-funded-by-the-afd.html#cb21-105" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées non-marines par catégorie IUCN </span><span class="sc">\n</span><span class="st">(hors AP non-répertoriées)&quot;</span>,</span>
<span id="cb21-106"><a href="projects-funded-by-the-afd.html#cb21-106" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;sur&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées non-marines. Nombre d&#39;aires indiqué sur les barres.&quot;</span>),</span>
<span id="cb21-107"><a href="projects-funded-by-the-afd.html#cb21-107" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Catégories IUCN&quot;</span>, </span>
<span id="cb21-108"><a href="projects-funded-by-the-afd.html#cb21-108" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Nombre (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-109"><a href="projects-funded-by-the-afd.html#cb21-109" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb21-110"><a href="projects-funded-by-the-afd.html#cb21-110" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb21-111"><a href="projects-funded-by-the-afd.html#cb21-111" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb21-112"><a href="projects-funded-by-the-afd.html#cb21-112" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb21-113"><a href="projects-funded-by-the-afd.html#cb21-113" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb21-114"><a href="projects-funded-by-the-afd.html#cb21-114" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-115"><a href="projects-funded-by-the-afd.html#cb21-115" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-116"><a href="projects-funded-by-the-afd.html#cb21-116" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-117"><a href="projects-funded-by-the-afd.html#cb21-117" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb21-118"><a href="projects-funded-by-the-afd.html#cb21-118" tabindex="-1"></a>hist_cat_iucn_ref_fr</span>
<span id="cb21-119"><a href="projects-funded-by-the-afd.html#cb21-119" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb21-120"><a href="projects-funded-by-the-afd.html#cb21-120" tabindex="-1"></a>hist_cat_iucn_ref_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb21-121"><a href="projects-funded-by-the-afd.html#cb21-121" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_en, <span class="sc">-</span>freq_iucn), </span>
<span id="cb21-122"><a href="projects-funded-by-the-afd.html#cb21-122" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-123"><a href="projects-funded-by-the-afd.html#cb21-123" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-124"><a href="projects-funded-by-the-afd.html#cb21-124" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb21-125"><a href="projects-funded-by-the-afd.html#cb21-125" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb21-126"><a href="projects-funded-by-the-afd.html#cb21-126" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-127"><a href="projects-funded-by-the-afd.html#cb21-127" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of non-marine protected areas by IUCN categories </span><span class="sc">\n</span><span class="st">(excluding not reported/categorized)&quot;</span>,</span>
<span id="cb21-128"><a href="projects-funded-by-the-afd.html#cb21-128" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;out of&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;non-marine protected areas. Number of areas indicated above the bars.&quot;</span>),</span>
<span id="cb21-129"><a href="projects-funded-by-the-afd.html#cb21-129" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;IUCN categories&quot;</span>, </span>
<span id="cb21-130"><a href="projects-funded-by-the-afd.html#cb21-130" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Share (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-131"><a href="projects-funded-by-the-afd.html#cb21-131" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb21-132"><a href="projects-funded-by-the-afd.html#cb21-132" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb21-133"><a href="projects-funded-by-the-afd.html#cb21-133" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb21-134"><a href="projects-funded-by-the-afd.html#cb21-134" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb21-135"><a href="projects-funded-by-the-afd.html#cb21-135" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb21-136"><a href="projects-funded-by-the-afd.html#cb21-136" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-137"><a href="projects-funded-by-the-afd.html#cb21-137" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-138"><a href="projects-funded-by-the-afd.html#cb21-138" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb21-139"><a href="projects-funded-by-the-afd.html#cb21-139" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb21-140"><a href="projects-funded-by-the-afd.html#cb21-140" tabindex="-1"></a>hist_cat_iucn_ref_en</span>
<span id="cb21-141"><a href="projects-funded-by-the-afd.html#cb21-141" tabindex="-1"></a></span>
<span id="cb21-142"><a href="projects-funded-by-the-afd.html#cb21-142" tabindex="-1"></a></span>
<span id="cb21-143"><a href="projects-funded-by-the-afd.html#cb21-143" tabindex="-1"></a><span class="co">#Pie chart INcluding non-referenced PAs</span></span>
<span id="cb21-144"><a href="projects-funded-by-the-afd.html#cb21-144" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb21-145"><a href="projects-funded-by-the-afd.html#cb21-145" tabindex="-1"></a>pie_cat_iucn_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb21-146"><a href="projects-funded-by-the-afd.html#cb21-146" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb21-147"><a href="projects-funded-by-the-afd.html#cb21-147" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-148"><a href="projects-funded-by-the-afd.html#cb21-148" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-149"><a href="projects-funded-by-the-afd.html#cb21-149" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb21-150"><a href="projects-funded-by-the-afd.html#cb21-150" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb21-151"><a href="projects-funded-by-the-afd.html#cb21-151" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb21-152"><a href="projects-funded-by-the-afd.html#cb21-152" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-153"><a href="projects-funded-by-the-afd.html#cb21-153" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb21-154"><a href="projects-funded-by-the-afd.html#cb21-154" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb21-155"><a href="projects-funded-by-the-afd.html#cb21-155" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb21-156"><a href="projects-funded-by-the-afd.html#cb21-156" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb21-157"><a href="projects-funded-by-the-afd.html#cb21-157" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb21-158"><a href="projects-funded-by-the-afd.html#cb21-158" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées non-marines par catégorie IUCN (%)&quot;</span>,</span>
<span id="cb21-159"><a href="projects-funded-by-the-afd.html#cb21-159" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées non-marines&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-160"><a href="projects-funded-by-the-afd.html#cb21-160" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Catégories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-161"><a href="projects-funded-by-the-afd.html#cb21-161" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb21-162"><a href="projects-funded-by-the-afd.html#cb21-162" tabindex="-1"></a>pie_cat_iucn_fr</span>
<span id="cb21-163"><a href="projects-funded-by-the-afd.html#cb21-163" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb21-164"><a href="projects-funded-by-the-afd.html#cb21-164" tabindex="-1"></a>pie_cat_iucn_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb21-165"><a href="projects-funded-by-the-afd.html#cb21-165" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb21-166"><a href="projects-funded-by-the-afd.html#cb21-166" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-167"><a href="projects-funded-by-the-afd.html#cb21-167" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-168"><a href="projects-funded-by-the-afd.html#cb21-168" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb21-169"><a href="projects-funded-by-the-afd.html#cb21-169" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb21-170"><a href="projects-funded-by-the-afd.html#cb21-170" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb21-171"><a href="projects-funded-by-the-afd.html#cb21-171" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-172"><a href="projects-funded-by-the-afd.html#cb21-172" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb21-173"><a href="projects-funded-by-the-afd.html#cb21-173" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb21-174"><a href="projects-funded-by-the-afd.html#cb21-174" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb21-175"><a href="projects-funded-by-the-afd.html#cb21-175" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb21-176"><a href="projects-funded-by-the-afd.html#cb21-176" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb21-177"><a href="projects-funded-by-the-afd.html#cb21-177" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Distribution of non-marine protected areas by IUCN categories (%)&quot;</span>,</span>
<span id="cb21-178"><a href="projects-funded-by-the-afd.html#cb21-178" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;non-marine protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-179"><a href="projects-funded-by-the-afd.html#cb21-179" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Categories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-180"><a href="projects-funded-by-the-afd.html#cb21-180" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb21-181"><a href="projects-funded-by-the-afd.html#cb21-181" tabindex="-1"></a>pie_cat_iucn_en</span>
<span id="cb21-182"><a href="projects-funded-by-the-afd.html#cb21-182" tabindex="-1"></a></span>
<span id="cb21-183"><a href="projects-funded-by-the-afd.html#cb21-183" tabindex="-1"></a></span>
<span id="cb21-184"><a href="projects-funded-by-the-afd.html#cb21-184" tabindex="-1"></a></span>
<span id="cb21-185"><a href="projects-funded-by-the-afd.html#cb21-185" tabindex="-1"></a><span class="co">#Pie chart EXcluding non-referenced PAs</span></span>
<span id="cb21-186"><a href="projects-funded-by-the-afd.html#cb21-186" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb21-187"><a href="projects-funded-by-the-afd.html#cb21-187" tabindex="-1"></a>pie_cat_iucn_ref_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb21-188"><a href="projects-funded-by-the-afd.html#cb21-188" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb21-189"><a href="projects-funded-by-the-afd.html#cb21-189" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-190"><a href="projects-funded-by-the-afd.html#cb21-190" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-191"><a href="projects-funded-by-the-afd.html#cb21-191" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb21-192"><a href="projects-funded-by-the-afd.html#cb21-192" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb21-193"><a href="projects-funded-by-the-afd.html#cb21-193" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb21-194"><a href="projects-funded-by-the-afd.html#cb21-194" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-195"><a href="projects-funded-by-the-afd.html#cb21-195" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb21-196"><a href="projects-funded-by-the-afd.html#cb21-196" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb21-197"><a href="projects-funded-by-the-afd.html#cb21-197" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb21-198"><a href="projects-funded-by-the-afd.html#cb21-198" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb21-199"><a href="projects-funded-by-the-afd.html#cb21-199" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb21-200"><a href="projects-funded-by-the-afd.html#cb21-200" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées non-marines par catégorie IUCN </span><span class="sc">\n</span><span class="st">hors aires non répertoriées (%)&quot;</span>,</span>
<span id="cb21-201"><a href="projects-funded-by-the-afd.html#cb21-201" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;sur&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées non-marines&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-202"><a href="projects-funded-by-the-afd.html#cb21-202" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Catégories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-203"><a href="projects-funded-by-the-afd.html#cb21-203" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb21-204"><a href="projects-funded-by-the-afd.html#cb21-204" tabindex="-1"></a>pie_cat_iucn_ref_fr</span>
<span id="cb21-205"><a href="projects-funded-by-the-afd.html#cb21-205" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb21-206"><a href="projects-funded-by-the-afd.html#cb21-206" tabindex="-1"></a>pie_cat_iucn_ref_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb21-207"><a href="projects-funded-by-the-afd.html#cb21-207" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb21-208"><a href="projects-funded-by-the-afd.html#cb21-208" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-209"><a href="projects-funded-by-the-afd.html#cb21-209" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-210"><a href="projects-funded-by-the-afd.html#cb21-210" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb21-211"><a href="projects-funded-by-the-afd.html#cb21-211" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb21-212"><a href="projects-funded-by-the-afd.html#cb21-212" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb21-213"><a href="projects-funded-by-the-afd.html#cb21-213" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-214"><a href="projects-funded-by-the-afd.html#cb21-214" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb21-215"><a href="projects-funded-by-the-afd.html#cb21-215" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb21-216"><a href="projects-funded-by-the-afd.html#cb21-216" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb21-217"><a href="projects-funded-by-the-afd.html#cb21-217" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb21-218"><a href="projects-funded-by-the-afd.html#cb21-218" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb21-219"><a href="projects-funded-by-the-afd.html#cb21-219" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Distribution of non-marine protected areas by IUCN categories </span><span class="sc">\n</span><span class="st">excluding not reported/categorized (%)&quot;</span>,</span>
<span id="cb21-220"><a href="projects-funded-by-the-afd.html#cb21-220" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;out of&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn),  <span class="st">&quot;non-marine protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-221"><a href="projects-funded-by-the-afd.html#cb21-221" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Categories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-222"><a href="projects-funded-by-the-afd.html#cb21-222" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb21-223"><a href="projects-funded-by-the-afd.html#cb21-223" tabindex="-1"></a>pie_cat_iucn_ref_en</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="projects-funded-by-the-afd.html#cb22-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb22-2"><a href="projects-funded-by-the-afd.html#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="projects-funded-by-the-afd.html#cb22-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb22-4"><a href="projects-funded-by-the-afd.html#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="projects-funded-by-the-afd.html#cb22-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb22-6"><a href="projects-funded-by-the-afd.html#cb22-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_fr,</span>
<span id="cb22-7"><a href="projects-funded-by-the-afd.html#cb22-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb22-8"><a href="projects-funded-by-the-afd.html#cb22-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb22-9"><a href="projects-funded-by-the-afd.html#cb22-9" tabindex="-1"></a></span>
<span id="cb22-10"><a href="projects-funded-by-the-afd.html#cb22-10" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb22-11"><a href="projects-funded-by-the-afd.html#cb22-11" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_en,</span>
<span id="cb22-12"><a href="projects-funded-by-the-afd.html#cb22-12" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb22-13"><a href="projects-funded-by-the-afd.html#cb22-13" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb22-14"><a href="projects-funded-by-the-afd.html#cb22-14" tabindex="-1"></a></span>
<span id="cb22-15"><a href="projects-funded-by-the-afd.html#cb22-15" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_ref_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb22-16"><a href="projects-funded-by-the-afd.html#cb22-16" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_ref_fr,</span>
<span id="cb22-17"><a href="projects-funded-by-the-afd.html#cb22-17" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb22-18"><a href="projects-funded-by-the-afd.html#cb22-18" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb22-19"><a href="projects-funded-by-the-afd.html#cb22-19" tabindex="-1"></a></span>
<span id="cb22-20"><a href="projects-funded-by-the-afd.html#cb22-20" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_ref_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb22-21"><a href="projects-funded-by-the-afd.html#cb22-21" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_ref_en,</span>
<span id="cb22-22"><a href="projects-funded-by-the-afd.html#cb22-22" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb22-23"><a href="projects-funded-by-the-afd.html#cb22-23" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb22-24"><a href="projects-funded-by-the-afd.html#cb22-24" tabindex="-1"></a></span>
<span id="cb22-25"><a href="projects-funded-by-the-afd.html#cb22-25" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb22-26"><a href="projects-funded-by-the-afd.html#cb22-26" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_fr,</span>
<span id="cb22-27"><a href="projects-funded-by-the-afd.html#cb22-27" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb22-28"><a href="projects-funded-by-the-afd.html#cb22-28" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb22-29"><a href="projects-funded-by-the-afd.html#cb22-29" tabindex="-1"></a></span>
<span id="cb22-30"><a href="projects-funded-by-the-afd.html#cb22-30" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb22-31"><a href="projects-funded-by-the-afd.html#cb22-31" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_en,</span>
<span id="cb22-32"><a href="projects-funded-by-the-afd.html#cb22-32" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb22-33"><a href="projects-funded-by-the-afd.html#cb22-33" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb22-34"><a href="projects-funded-by-the-afd.html#cb22-34" tabindex="-1"></a></span>
<span id="cb22-35"><a href="projects-funded-by-the-afd.html#cb22-35" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_ref_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb22-36"><a href="projects-funded-by-the-afd.html#cb22-36" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_ref_fr,</span>
<span id="cb22-37"><a href="projects-funded-by-the-afd.html#cb22-37" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb22-38"><a href="projects-funded-by-the-afd.html#cb22-38" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb22-39"><a href="projects-funded-by-the-afd.html#cb22-39" tabindex="-1"></a></span>
<span id="cb22-40"><a href="projects-funded-by-the-afd.html#cb22-40" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_ref_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb22-41"><a href="projects-funded-by-the-afd.html#cb22-41" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_ref_en,</span>
<span id="cb22-42"><a href="projects-funded-by-the-afd.html#cb22-42" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb22-43"><a href="projects-funded-by-the-afd.html#cb22-43" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb22-44"><a href="projects-funded-by-the-afd.html#cb22-44" tabindex="-1"></a></span>
<span id="cb22-45"><a href="projects-funded-by-the-afd.html#cb22-45" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb22-46"><a href="projects-funded-by-the-afd.html#cb22-46" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb22-47"><a href="projects-funded-by-the-afd.html#cb22-47" tabindex="-1"></a></span>
<span id="cb22-48"><a href="projects-funded-by-the-afd.html#cb22-48" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb22-49"><a href="projects-funded-by-the-afd.html#cb22-49" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb22-50"><a href="projects-funded-by-the-afd.html#cb22-50" tabindex="-1"></a></span>
<span id="cb22-51"><a href="projects-funded-by-the-afd.html#cb22-51" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_ref_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb22-52"><a href="projects-funded-by-the-afd.html#cb22-52" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_ref_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb22-53"><a href="projects-funded-by-the-afd.html#cb22-53" tabindex="-1"></a></span>
<span id="cb22-54"><a href="projects-funded-by-the-afd.html#cb22-54" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_ref_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb22-55"><a href="projects-funded-by-the-afd.html#cb22-55" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_ref_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb22-56"><a href="projects-funded-by-the-afd.html#cb22-56" tabindex="-1"></a></span>
<span id="cb22-57"><a href="projects-funded-by-the-afd.html#cb22-57" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb22-58"><a href="projects-funded-by-the-afd.html#cb22-58" tabindex="-1"></a></span>
<span id="cb22-59"><a href="projects-funded-by-the-afd.html#cb22-59" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb22-60"><a href="projects-funded-by-the-afd.html#cb22-60" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-61"><a href="projects-funded-by-the-afd.html#cb22-61" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb22-62"><a href="projects-funded-by-the-afd.html#cb22-62" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb22-63"><a href="projects-funded-by-the-afd.html#cb22-63" tabindex="-1"></a>  {</span>
<span id="cb22-64"><a href="projects-funded-by-the-afd.html#cb22-64" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;&#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-65"><a href="projects-funded-by-the-afd.html#cb22-65" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb22-66"><a href="projects-funded-by-the-afd.html#cb22-66" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/IUCN/world/no_marine&quot;</span>, </span>
<span id="cb22-67"><a href="projects-funded-by-the-afd.html#cb22-67" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-68"><a href="projects-funded-by-the-afd.html#cb22-68" tabindex="-1"></a>  }</span>
<span id="cb22-69"><a href="projects-funded-by-the-afd.html#cb22-69" tabindex="-1"></a></span>
<span id="cb22-70"><a href="projects-funded-by-the-afd.html#cb22-70" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb22-71"><a href="projects-funded-by-the-afd.html#cb22-71" tabindex="-1"></a></span>
<span id="cb22-72"><a href="projects-funded-by-the-afd.html#cb22-72" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="share-of-pas-by-iucn-categories-region-no-marine" class="section level4 hasAnchor" number="2.3.1.3">
<h4><span class="header-section-number">2.3.1.3</span> Share of PAs by IUCN categories (region, no marine)<a href="projects-funded-by-the-afd.html#share-of-pas-by-iucn-categories-region-no-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pas in a specific region, non-marine only.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="projects-funded-by-the-afd.html#cb23-1" tabindex="-1"></a><span class="co">#Define the region of interest (see region variable in the main dataset).</span></span>
<span id="cb23-2"><a href="projects-funded-by-the-afd.html#cb23-2" tabindex="-1"></a>roi <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span></span>
<span id="cb23-3"><a href="projects-funded-by-the-afd.html#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="projects-funded-by-the-afd.html#cb23-4" tabindex="-1"></a><span class="co">#Building the relevant dataset</span></span>
<span id="cb23-5"><a href="projects-funded-by-the-afd.html#cb23-5" tabindex="-1"></a><span class="do">##For all PAs ..</span></span>
<span id="cb23-6"><a href="projects-funded-by-the-afd.html#cb23-6" tabindex="-1"></a>data_cat_iucn <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="projects-funded-by-the-afd.html#cb23-7" tabindex="-1"></a>  <span class="co">#Keep only terrestrial or coastal PA (when unknown, discarded)</span></span>
<span id="cb23-8"><a href="projects-funded-by-the-afd.html#cb23-8" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">&amp;</span> region <span class="sc">==</span> roi) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="projects-funded-by-the-afd.html#cb23-9" tabindex="-1"></a>  <span class="fu">group_by</span>(iucn_des_en, iucn_des_fr) <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="projects-funded-by-the-afd.html#cb23-10" tabindex="-1"></a>  <span class="co">#number of PAs per IUCN category</span></span>
<span id="cb23-11"><a href="projects-funded-by-the-afd.html#cb23-11" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_iucn =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="projects-funded-by-the-afd.html#cb23-12" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="projects-funded-by-the-afd.html#cb23-13" tabindex="-1"></a>  <span class="co">#Frequency of IUCN categories</span></span>
<span id="cb23-14"><a href="projects-funded-by-the-afd.html#cb23-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_pa =</span> <span class="fu">sum</span>(n_iucn),</span>
<span id="cb23-15"><a href="projects-funded-by-the-afd.html#cb23-15" tabindex="-1"></a>         <span class="at">freq_iucn =</span> <span class="fu">round</span>(n_iucn<span class="sc">/</span>n_pa<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="projects-funded-by-the-afd.html#cb23-16" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb23-17"><a href="projects-funded-by-the-afd.html#cb23-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ypos_iucn =</span> <span class="fu">cumsum</span>(freq_iucn) <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>freq_iucn) </span>
<span id="cb23-18"><a href="projects-funded-by-the-afd.html#cb23-18" tabindex="-1"></a></span>
<span id="cb23-19"><a href="projects-funded-by-the-afd.html#cb23-19" tabindex="-1"></a></span>
<span id="cb23-20"><a href="projects-funded-by-the-afd.html#cb23-20" tabindex="-1"></a><span class="do">##... and for referenced PAs only</span></span>
<span id="cb23-21"><a href="projects-funded-by-the-afd.html#cb23-21" tabindex="-1"></a>data_cat_iucn_ref <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb23-22"><a href="projects-funded-by-the-afd.html#cb23-22" tabindex="-1"></a>  <span class="co">#Keep only terrestrial or coastal PA (when unknown, discarded)</span></span>
<span id="cb23-23"><a href="projects-funded-by-the-afd.html#cb23-23" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">&amp;</span> region <span class="sc">==</span> roi) <span class="sc">%&gt;%</span></span>
<span id="cb23-24"><a href="projects-funded-by-the-afd.html#cb23-24" tabindex="-1"></a>  <span class="co">#Remove not referenced PAs</span></span>
<span id="cb23-25"><a href="projects-funded-by-the-afd.html#cb23-25" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="sc">!</span>(iucn_des_fr <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Non catégorisée&quot;</span>, <span class="st">&quot;Non référencée&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb23-26"><a href="projects-funded-by-the-afd.html#cb23-26" tabindex="-1"></a>  <span class="fu">group_by</span>(iucn_des_en, iucn_des_fr) <span class="sc">%&gt;%</span></span>
<span id="cb23-27"><a href="projects-funded-by-the-afd.html#cb23-27" tabindex="-1"></a>  <span class="co">#number of PAs per IUCN category</span></span>
<span id="cb23-28"><a href="projects-funded-by-the-afd.html#cb23-28" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_iucn =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb23-29"><a href="projects-funded-by-the-afd.html#cb23-29" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-30"><a href="projects-funded-by-the-afd.html#cb23-30" tabindex="-1"></a>  <span class="co">#Frequency of IUCN categories</span></span>
<span id="cb23-31"><a href="projects-funded-by-the-afd.html#cb23-31" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_pa =</span> <span class="fu">sum</span>(n_iucn),</span>
<span id="cb23-32"><a href="projects-funded-by-the-afd.html#cb23-32" tabindex="-1"></a>         <span class="at">freq_iucn =</span> <span class="fu">round</span>(n_iucn<span class="sc">/</span>n_pa<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-33"><a href="projects-funded-by-the-afd.html#cb23-33" tabindex="-1"></a>  <span class="fu">arrange</span>(freq_iucn) <span class="sc">%&gt;%</span></span>
<span id="cb23-34"><a href="projects-funded-by-the-afd.html#cb23-34" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ypos_iucn =</span> <span class="fu">cumsum</span>(freq_iucn) <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>freq_iucn) </span>
<span id="cb23-35"><a href="projects-funded-by-the-afd.html#cb23-35" tabindex="-1"></a></span>
<span id="cb23-36"><a href="projects-funded-by-the-afd.html#cb23-36" tabindex="-1"></a><span class="co">#Latex table</span></span>
<span id="cb23-37"><a href="projects-funded-by-the-afd.html#cb23-37" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb23-38"><a href="projects-funded-by-the-afd.html#cb23-38" tabindex="-1"></a>tbl_cat_iucn_fr <span class="ot">=</span> data_cat_iucn <span class="sc">%&gt;%</span></span>
<span id="cb23-39"><a href="projects-funded-by-the-afd.html#cb23-39" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_fr, n_iucn, freq_iucn))</span>
<span id="cb23-40"><a href="projects-funded-by-the-afd.html#cb23-40" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_fr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Catégories IUCN&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>, <span class="st">&quot;Proportion d&#39;AP (%)&quot;</span>)</span>
<span id="cb23-41"><a href="projects-funded-by-the-afd.html#cb23-41" tabindex="-1"></a>tbl_cat_iucn_ref_fr <span class="ot">=</span> data_cat_iucn_ref <span class="sc">%&gt;%</span></span>
<span id="cb23-42"><a href="projects-funded-by-the-afd.html#cb23-42" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_fr, n_iucn, freq_iucn))</span>
<span id="cb23-43"><a href="projects-funded-by-the-afd.html#cb23-43" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_ref_fr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Catégories IUCN&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>, <span class="st">&quot;Proportion d&#39;AP (%)&quot;</span>)</span>
<span id="cb23-44"><a href="projects-funded-by-the-afd.html#cb23-44" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb23-45"><a href="projects-funded-by-the-afd.html#cb23-45" tabindex="-1"></a>tbl_cat_iucn_en <span class="ot">=</span> data_cat_iucn <span class="sc">%&gt;%</span></span>
<span id="cb23-46"><a href="projects-funded-by-the-afd.html#cb23-46" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_en, n_iucn, freq_iucn))</span>
<span id="cb23-47"><a href="projects-funded-by-the-afd.html#cb23-47" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_en) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IUCN categories&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>, <span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb23-48"><a href="projects-funded-by-the-afd.html#cb23-48" tabindex="-1"></a>tbl_cat_iucn_ref_en <span class="ot">=</span> data_cat_iucn_ref <span class="sc">%&gt;%</span></span>
<span id="cb23-49"><a href="projects-funded-by-the-afd.html#cb23-49" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(iucn_des_en, n_iucn, freq_iucn))</span>
<span id="cb23-50"><a href="projects-funded-by-the-afd.html#cb23-50" tabindex="-1"></a><span class="fu">names</span>(tbl_cat_iucn_ref_en) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IUCN categories&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>, <span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb23-51"><a href="projects-funded-by-the-afd.html#cb23-51" tabindex="-1"></a></span>
<span id="cb23-52"><a href="projects-funded-by-the-afd.html#cb23-52" tabindex="-1"></a></span>
<span id="cb23-53"><a href="projects-funded-by-the-afd.html#cb23-53" tabindex="-1"></a><span class="co">#Histogram including non-referenced PAs</span></span>
<span id="cb23-54"><a href="projects-funded-by-the-afd.html#cb23-54" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb23-55"><a href="projects-funded-by-the-afd.html#cb23-55" tabindex="-1"></a>hist_cat_iucn_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb23-56"><a href="projects-funded-by-the-afd.html#cb23-56" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_fr, <span class="sc">-</span>freq_iucn), </span>
<span id="cb23-57"><a href="projects-funded-by-the-afd.html#cb23-57" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-58"><a href="projects-funded-by-the-afd.html#cb23-58" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-59"><a href="projects-funded-by-the-afd.html#cb23-59" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb23-60"><a href="projects-funded-by-the-afd.html#cb23-60" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb23-61"><a href="projects-funded-by-the-afd.html#cb23-61" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-62"><a href="projects-funded-by-the-afd.html#cb23-62" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion d&#39;aires protégées non-marines par catégorie IUCN,&quot;</span>, roi),</span>
<span id="cb23-63"><a href="projects-funded-by-the-afd.html#cb23-63" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées non-marines. Nombre d&#39;aires indiqué sur les barres.&quot;</span>),</span>
<span id="cb23-64"><a href="projects-funded-by-the-afd.html#cb23-64" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Catégories IUCN&quot;</span>, </span>
<span id="cb23-65"><a href="projects-funded-by-the-afd.html#cb23-65" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Proportion (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-66"><a href="projects-funded-by-the-afd.html#cb23-66" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb23-67"><a href="projects-funded-by-the-afd.html#cb23-67" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb23-68"><a href="projects-funded-by-the-afd.html#cb23-68" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb23-69"><a href="projects-funded-by-the-afd.html#cb23-69" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb23-70"><a href="projects-funded-by-the-afd.html#cb23-70" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb23-71"><a href="projects-funded-by-the-afd.html#cb23-71" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-72"><a href="projects-funded-by-the-afd.html#cb23-72" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-73"><a href="projects-funded-by-the-afd.html#cb23-73" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-74"><a href="projects-funded-by-the-afd.html#cb23-74" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb23-75"><a href="projects-funded-by-the-afd.html#cb23-75" tabindex="-1"></a>hist_cat_iucn_fr</span>
<span id="cb23-76"><a href="projects-funded-by-the-afd.html#cb23-76" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb23-77"><a href="projects-funded-by-the-afd.html#cb23-77" tabindex="-1"></a>hist_cat_iucn_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb23-78"><a href="projects-funded-by-the-afd.html#cb23-78" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_en, <span class="sc">-</span>freq_iucn), </span>
<span id="cb23-79"><a href="projects-funded-by-the-afd.html#cb23-79" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-80"><a href="projects-funded-by-the-afd.html#cb23-80" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-81"><a href="projects-funded-by-the-afd.html#cb23-81" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb23-82"><a href="projects-funded-by-the-afd.html#cb23-82" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb23-83"><a href="projects-funded-by-the-afd.html#cb23-83" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-84"><a href="projects-funded-by-the-afd.html#cb23-84" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Distribution of non-marine protected areas by IUCN categories,&quot;</span>, roi),</span>
<span id="cb23-85"><a href="projects-funded-by-the-afd.html#cb23-85" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;non-marine protected areas. Number of areas indicated above the bars.&quot;</span>),</span>
<span id="cb23-86"><a href="projects-funded-by-the-afd.html#cb23-86" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;IUCN categories&quot;</span>, </span>
<span id="cb23-87"><a href="projects-funded-by-the-afd.html#cb23-87" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Share (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-88"><a href="projects-funded-by-the-afd.html#cb23-88" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb23-89"><a href="projects-funded-by-the-afd.html#cb23-89" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb23-90"><a href="projects-funded-by-the-afd.html#cb23-90" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb23-91"><a href="projects-funded-by-the-afd.html#cb23-91" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb23-92"><a href="projects-funded-by-the-afd.html#cb23-92" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb23-93"><a href="projects-funded-by-the-afd.html#cb23-93" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-94"><a href="projects-funded-by-the-afd.html#cb23-94" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-95"><a href="projects-funded-by-the-afd.html#cb23-95" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-96"><a href="projects-funded-by-the-afd.html#cb23-96" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb23-97"><a href="projects-funded-by-the-afd.html#cb23-97" tabindex="-1"></a>hist_cat_iucn_en</span>
<span id="cb23-98"><a href="projects-funded-by-the-afd.html#cb23-98" tabindex="-1"></a></span>
<span id="cb23-99"><a href="projects-funded-by-the-afd.html#cb23-99" tabindex="-1"></a><span class="co">#Histogram excluding non-referenced PAs</span></span>
<span id="cb23-100"><a href="projects-funded-by-the-afd.html#cb23-100" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb23-101"><a href="projects-funded-by-the-afd.html#cb23-101" tabindex="-1"></a>hist_cat_iucn_ref_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb23-102"><a href="projects-funded-by-the-afd.html#cb23-102" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_fr, <span class="sc">-</span>freq_iucn), </span>
<span id="cb23-103"><a href="projects-funded-by-the-afd.html#cb23-103" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-104"><a href="projects-funded-by-the-afd.html#cb23-104" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-105"><a href="projects-funded-by-the-afd.html#cb23-105" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb23-106"><a href="projects-funded-by-the-afd.html#cb23-106" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb23-107"><a href="projects-funded-by-the-afd.html#cb23-107" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-108"><a href="projects-funded-by-the-afd.html#cb23-108" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion d&#39;aires protégées non-marines par catégorie IUCN,&quot;</span>, roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(hors AP non-répertoriées)&quot;</span>),</span>
<span id="cb23-109"><a href="projects-funded-by-the-afd.html#cb23-109" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;sur&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées non-marines. Nombre d&#39;aires indiqué sur les barres.&quot;</span>),</span>
<span id="cb23-110"><a href="projects-funded-by-the-afd.html#cb23-110" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Catégories IUCN&quot;</span>, </span>
<span id="cb23-111"><a href="projects-funded-by-the-afd.html#cb23-111" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Nombre (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-112"><a href="projects-funded-by-the-afd.html#cb23-112" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb23-113"><a href="projects-funded-by-the-afd.html#cb23-113" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb23-114"><a href="projects-funded-by-the-afd.html#cb23-114" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb23-115"><a href="projects-funded-by-the-afd.html#cb23-115" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb23-116"><a href="projects-funded-by-the-afd.html#cb23-116" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb23-117"><a href="projects-funded-by-the-afd.html#cb23-117" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-118"><a href="projects-funded-by-the-afd.html#cb23-118" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-119"><a href="projects-funded-by-the-afd.html#cb23-119" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-120"><a href="projects-funded-by-the-afd.html#cb23-120" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb23-121"><a href="projects-funded-by-the-afd.html#cb23-121" tabindex="-1"></a>hist_cat_iucn_ref_fr</span>
<span id="cb23-122"><a href="projects-funded-by-the-afd.html#cb23-122" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb23-123"><a href="projects-funded-by-the-afd.html#cb23-123" tabindex="-1"></a>hist_cat_iucn_ref_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb23-124"><a href="projects-funded-by-the-afd.html#cb23-124" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iucn_des_en, <span class="sc">-</span>freq_iucn), </span>
<span id="cb23-125"><a href="projects-funded-by-the-afd.html#cb23-125" tabindex="-1"></a>                           <span class="at">y =</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-126"><a href="projects-funded-by-the-afd.html#cb23-126" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span><span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-127"><a href="projects-funded-by-the-afd.html#cb23-127" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n_iucn, <span class="dv">1</span>), <span class="at">y =</span> freq_iucn), </span>
<span id="cb23-128"><a href="projects-funded-by-the-afd.html#cb23-128" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb23-129"><a href="projects-funded-by-the-afd.html#cb23-129" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-130"><a href="projects-funded-by-the-afd.html#cb23-130" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Distribution of non-marine protected areas by IUCN categories,&quot;</span>, roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(excluding not reported/categorized)&quot;</span>),</span>
<span id="cb23-131"><a href="projects-funded-by-the-afd.html#cb23-131" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;out of&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;non-marine protected areas. Number of areas indicated above the bars.&quot;</span>),</span>
<span id="cb23-132"><a href="projects-funded-by-the-afd.html#cb23-132" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;IUCN categories&quot;</span>, </span>
<span id="cb23-133"><a href="projects-funded-by-the-afd.html#cb23-133" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Share (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-134"><a href="projects-funded-by-the-afd.html#cb23-134" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb23-135"><a href="projects-funded-by-the-afd.html#cb23-135" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb23-136"><a href="projects-funded-by-the-afd.html#cb23-136" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb23-137"><a href="projects-funded-by-the-afd.html#cb23-137" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb23-138"><a href="projects-funded-by-the-afd.html#cb23-138" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb23-139"><a href="projects-funded-by-the-afd.html#cb23-139" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-140"><a href="projects-funded-by-the-afd.html#cb23-140" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-141"><a href="projects-funded-by-the-afd.html#cb23-141" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb23-142"><a href="projects-funded-by-the-afd.html#cb23-142" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb23-143"><a href="projects-funded-by-the-afd.html#cb23-143" tabindex="-1"></a>hist_cat_iucn_ref_en</span>
<span id="cb23-144"><a href="projects-funded-by-the-afd.html#cb23-144" tabindex="-1"></a></span>
<span id="cb23-145"><a href="projects-funded-by-the-afd.html#cb23-145" tabindex="-1"></a></span>
<span id="cb23-146"><a href="projects-funded-by-the-afd.html#cb23-146" tabindex="-1"></a><span class="co">#Pie chart INcluding non-referenced PAs</span></span>
<span id="cb23-147"><a href="projects-funded-by-the-afd.html#cb23-147" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb23-148"><a href="projects-funded-by-the-afd.html#cb23-148" tabindex="-1"></a>pie_cat_iucn_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb23-149"><a href="projects-funded-by-the-afd.html#cb23-149" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb23-150"><a href="projects-funded-by-the-afd.html#cb23-150" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-151"><a href="projects-funded-by-the-afd.html#cb23-151" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-152"><a href="projects-funded-by-the-afd.html#cb23-152" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb23-153"><a href="projects-funded-by-the-afd.html#cb23-153" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb23-154"><a href="projects-funded-by-the-afd.html#cb23-154" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb23-155"><a href="projects-funded-by-the-afd.html#cb23-155" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-156"><a href="projects-funded-by-the-afd.html#cb23-156" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb23-157"><a href="projects-funded-by-the-afd.html#cb23-157" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb23-158"><a href="projects-funded-by-the-afd.html#cb23-158" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb23-159"><a href="projects-funded-by-the-afd.html#cb23-159" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb23-160"><a href="projects-funded-by-the-afd.html#cb23-160" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb23-161"><a href="projects-funded-by-the-afd.html#cb23-161" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion d&#39;aires protégées non-marines par catégorie IUCN (%),&quot;</span>, roi),</span>
<span id="cb23-162"><a href="projects-funded-by-the-afd.html#cb23-162" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées non-marines&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-163"><a href="projects-funded-by-the-afd.html#cb23-163" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Catégories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-164"><a href="projects-funded-by-the-afd.html#cb23-164" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb23-165"><a href="projects-funded-by-the-afd.html#cb23-165" tabindex="-1"></a>pie_cat_iucn_fr</span>
<span id="cb23-166"><a href="projects-funded-by-the-afd.html#cb23-166" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb23-167"><a href="projects-funded-by-the-afd.html#cb23-167" tabindex="-1"></a>pie_cat_iucn_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn, </span>
<span id="cb23-168"><a href="projects-funded-by-the-afd.html#cb23-168" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb23-169"><a href="projects-funded-by-the-afd.html#cb23-169" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-170"><a href="projects-funded-by-the-afd.html#cb23-170" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-171"><a href="projects-funded-by-the-afd.html#cb23-171" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb23-172"><a href="projects-funded-by-the-afd.html#cb23-172" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb23-173"><a href="projects-funded-by-the-afd.html#cb23-173" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb23-174"><a href="projects-funded-by-the-afd.html#cb23-174" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-175"><a href="projects-funded-by-the-afd.html#cb23-175" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb23-176"><a href="projects-funded-by-the-afd.html#cb23-176" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb23-177"><a href="projects-funded-by-the-afd.html#cb23-177" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb23-178"><a href="projects-funded-by-the-afd.html#cb23-178" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb23-179"><a href="projects-funded-by-the-afd.html#cb23-179" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb23-180"><a href="projects-funded-by-the-afd.html#cb23-180" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Distribution of non-marine protected areas by IUCN categories (%),&quot;</span>, roi),</span>
<span id="cb23-181"><a href="projects-funded-by-the-afd.html#cb23-181" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;non-marine protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-182"><a href="projects-funded-by-the-afd.html#cb23-182" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Categories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-183"><a href="projects-funded-by-the-afd.html#cb23-183" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb23-184"><a href="projects-funded-by-the-afd.html#cb23-184" tabindex="-1"></a>pie_cat_iucn_en</span>
<span id="cb23-185"><a href="projects-funded-by-the-afd.html#cb23-185" tabindex="-1"></a></span>
<span id="cb23-186"><a href="projects-funded-by-the-afd.html#cb23-186" tabindex="-1"></a></span>
<span id="cb23-187"><a href="projects-funded-by-the-afd.html#cb23-187" tabindex="-1"></a></span>
<span id="cb23-188"><a href="projects-funded-by-the-afd.html#cb23-188" tabindex="-1"></a><span class="co">#Pie chart EXcluding non-referenced PAs</span></span>
<span id="cb23-189"><a href="projects-funded-by-the-afd.html#cb23-189" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb23-190"><a href="projects-funded-by-the-afd.html#cb23-190" tabindex="-1"></a>pie_cat_iucn_ref_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb23-191"><a href="projects-funded-by-the-afd.html#cb23-191" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb23-192"><a href="projects-funded-by-the-afd.html#cb23-192" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-193"><a href="projects-funded-by-the-afd.html#cb23-193" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-194"><a href="projects-funded-by-the-afd.html#cb23-194" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb23-195"><a href="projects-funded-by-the-afd.html#cb23-195" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb23-196"><a href="projects-funded-by-the-afd.html#cb23-196" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb23-197"><a href="projects-funded-by-the-afd.html#cb23-197" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-198"><a href="projects-funded-by-the-afd.html#cb23-198" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb23-199"><a href="projects-funded-by-the-afd.html#cb23-199" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb23-200"><a href="projects-funded-by-the-afd.html#cb23-200" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb23-201"><a href="projects-funded-by-the-afd.html#cb23-201" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb23-202"><a href="projects-funded-by-the-afd.html#cb23-202" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb23-203"><a href="projects-funded-by-the-afd.html#cb23-203" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion d&#39;aires protégées non-marines par catégorie IUCN,&quot;</span>,  roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">hors aires non répertoriées (%)&quot;</span>),</span>
<span id="cb23-204"><a href="projects-funded-by-the-afd.html#cb23-204" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;sur&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn), <span class="st">&quot;aires protégées non-marines&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-205"><a href="projects-funded-by-the-afd.html#cb23-205" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Catégories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-206"><a href="projects-funded-by-the-afd.html#cb23-206" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb23-207"><a href="projects-funded-by-the-afd.html#cb23-207" tabindex="-1"></a>pie_cat_iucn_ref_fr</span>
<span id="cb23-208"><a href="projects-funded-by-the-afd.html#cb23-208" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb23-209"><a href="projects-funded-by-the-afd.html#cb23-209" tabindex="-1"></a>pie_cat_iucn_ref_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_cat_iucn_ref, </span>
<span id="cb23-210"><a href="projects-funded-by-the-afd.html#cb23-210" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq_iucn, <span class="at">fill =</span> iucn_des_en)) <span class="sc">%&gt;%</span></span>
<span id="cb23-211"><a href="projects-funded-by-the-afd.html#cb23-211" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-212"><a href="projects-funded-by-the-afd.html#cb23-212" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-213"><a href="projects-funded-by-the-afd.html#cb23-213" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.2</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(freq_iucn, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb23-214"><a href="projects-funded-by-the-afd.html#cb23-214" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb23-215"><a href="projects-funded-by-the-afd.html#cb23-215" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb23-216"><a href="projects-funded-by-the-afd.html#cb23-216" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-217"><a href="projects-funded-by-the-afd.html#cb23-217" tabindex="-1"></a>  <span class="co"># + geom_label(aes(x=1.4, label = paste0(freq_iucn, &quot;%&quot;)), </span></span>
<span id="cb23-218"><a href="projects-funded-by-the-afd.html#cb23-218" tabindex="-1"></a>  <span class="co">#              color = &quot;white&quot;, </span></span>
<span id="cb23-219"><a href="projects-funded-by-the-afd.html#cb23-219" tabindex="-1"></a>  <span class="co">#              position = position_stack(vjust = 0.7), size=2.5, </span></span>
<span id="cb23-220"><a href="projects-funded-by-the-afd.html#cb23-220" tabindex="-1"></a>  <span class="co">#              show.legend = FALSE) %&gt;%</span></span>
<span id="cb23-221"><a href="projects-funded-by-the-afd.html#cb23-221" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb23-222"><a href="projects-funded-by-the-afd.html#cb23-222" tabindex="-1"></a>         <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Distribution of non-marine protected areas by IUCN categories,&quot;</span>, roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">excluding not reported/categorized (%)&quot;</span>),</span>
<span id="cb23-223"><a href="projects-funded-by-the-afd.html#cb23-223" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_cat_iucn_ref<span class="sc">$</span>n_iucn), <span class="st">&quot;out of&quot;</span>, <span class="fu">sum</span>(data_cat_iucn<span class="sc">$</span>n_iucn),  <span class="st">&quot;non-marine protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-224"><a href="projects-funded-by-the-afd.html#cb23-224" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Categories&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-225"><a href="projects-funded-by-the-afd.html#cb23-225" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb23-226"><a href="projects-funded-by-the-afd.html#cb23-226" tabindex="-1"></a>pie_cat_iucn_ref_en</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="projects-funded-by-the-afd.html#cb24-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb24-2"><a href="projects-funded-by-the-afd.html#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="projects-funded-by-the-afd.html#cb24-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb24-4"><a href="projects-funded-by-the-afd.html#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="projects-funded-by-the-afd.html#cb24-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb24-6"><a href="projects-funded-by-the-afd.html#cb24-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_fr,</span>
<span id="cb24-7"><a href="projects-funded-by-the-afd.html#cb24-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb24-8"><a href="projects-funded-by-the-afd.html#cb24-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb24-9"><a href="projects-funded-by-the-afd.html#cb24-9" tabindex="-1"></a></span>
<span id="cb24-10"><a href="projects-funded-by-the-afd.html#cb24-10" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb24-11"><a href="projects-funded-by-the-afd.html#cb24-11" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_en,</span>
<span id="cb24-12"><a href="projects-funded-by-the-afd.html#cb24-12" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb24-13"><a href="projects-funded-by-the-afd.html#cb24-13" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb24-14"><a href="projects-funded-by-the-afd.html#cb24-14" tabindex="-1"></a></span>
<span id="cb24-15"><a href="projects-funded-by-the-afd.html#cb24-15" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_ref_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb24-16"><a href="projects-funded-by-the-afd.html#cb24-16" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_ref_fr,</span>
<span id="cb24-17"><a href="projects-funded-by-the-afd.html#cb24-17" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb24-18"><a href="projects-funded-by-the-afd.html#cb24-18" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb24-19"><a href="projects-funded-by-the-afd.html#cb24-19" tabindex="-1"></a></span>
<span id="cb24-20"><a href="projects-funded-by-the-afd.html#cb24-20" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_cat_iucn_ref_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb24-21"><a href="projects-funded-by-the-afd.html#cb24-21" tabindex="-1"></a>       <span class="at">plot =</span> hist_cat_iucn_ref_en,</span>
<span id="cb24-22"><a href="projects-funded-by-the-afd.html#cb24-22" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb24-23"><a href="projects-funded-by-the-afd.html#cb24-23" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb24-24"><a href="projects-funded-by-the-afd.html#cb24-24" tabindex="-1"></a></span>
<span id="cb24-25"><a href="projects-funded-by-the-afd.html#cb24-25" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb24-26"><a href="projects-funded-by-the-afd.html#cb24-26" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_fr,</span>
<span id="cb24-27"><a href="projects-funded-by-the-afd.html#cb24-27" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb24-28"><a href="projects-funded-by-the-afd.html#cb24-28" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb24-29"><a href="projects-funded-by-the-afd.html#cb24-29" tabindex="-1"></a></span>
<span id="cb24-30"><a href="projects-funded-by-the-afd.html#cb24-30" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb24-31"><a href="projects-funded-by-the-afd.html#cb24-31" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_en,</span>
<span id="cb24-32"><a href="projects-funded-by-the-afd.html#cb24-32" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb24-33"><a href="projects-funded-by-the-afd.html#cb24-33" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb24-34"><a href="projects-funded-by-the-afd.html#cb24-34" tabindex="-1"></a></span>
<span id="cb24-35"><a href="projects-funded-by-the-afd.html#cb24-35" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_ref_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb24-36"><a href="projects-funded-by-the-afd.html#cb24-36" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_ref_fr,</span>
<span id="cb24-37"><a href="projects-funded-by-the-afd.html#cb24-37" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb24-38"><a href="projects-funded-by-the-afd.html#cb24-38" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb24-39"><a href="projects-funded-by-the-afd.html#cb24-39" tabindex="-1"></a></span>
<span id="cb24-40"><a href="projects-funded-by-the-afd.html#cb24-40" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_cat_iucn_ref_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb24-41"><a href="projects-funded-by-the-afd.html#cb24-41" tabindex="-1"></a>       <span class="at">plot =</span> pie_cat_iucn_ref_en,</span>
<span id="cb24-42"><a href="projects-funded-by-the-afd.html#cb24-42" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb24-43"><a href="projects-funded-by-the-afd.html#cb24-43" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb24-44"><a href="projects-funded-by-the-afd.html#cb24-44" tabindex="-1"></a></span>
<span id="cb24-45"><a href="projects-funded-by-the-afd.html#cb24-45" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb24-46"><a href="projects-funded-by-the-afd.html#cb24-46" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb24-47"><a href="projects-funded-by-the-afd.html#cb24-47" tabindex="-1"></a></span>
<span id="cb24-48"><a href="projects-funded-by-the-afd.html#cb24-48" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb24-49"><a href="projects-funded-by-the-afd.html#cb24-49" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb24-50"><a href="projects-funded-by-the-afd.html#cb24-50" tabindex="-1"></a></span>
<span id="cb24-51"><a href="projects-funded-by-the-afd.html#cb24-51" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_ref_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb24-52"><a href="projects-funded-by-the-afd.html#cb24-52" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_ref_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb24-53"><a href="projects-funded-by-the-afd.html#cb24-53" tabindex="-1"></a></span>
<span id="cb24-54"><a href="projects-funded-by-the-afd.html#cb24-54" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_cat_iucn_ref_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb24-55"><a href="projects-funded-by-the-afd.html#cb24-55" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_cat_iucn_ref_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb24-56"><a href="projects-funded-by-the-afd.html#cb24-56" tabindex="-1"></a></span>
<span id="cb24-57"><a href="projects-funded-by-the-afd.html#cb24-57" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb24-58"><a href="projects-funded-by-the-afd.html#cb24-58" tabindex="-1"></a></span>
<span id="cb24-59"><a href="projects-funded-by-the-afd.html#cb24-59" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb24-60"><a href="projects-funded-by-the-afd.html#cb24-60" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-61"><a href="projects-funded-by-the-afd.html#cb24-61" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb24-62"><a href="projects-funded-by-the-afd.html#cb24-62" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb24-63"><a href="projects-funded-by-the-afd.html#cb24-63" tabindex="-1"></a>  {</span>
<span id="cb24-64"><a href="projects-funded-by-the-afd.html#cb24-64" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;&#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb24-65"><a href="projects-funded-by-the-afd.html#cb24-65" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb24-66"><a href="projects-funded-by-the-afd.html#cb24-66" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="fu">paste</span>(<span class="st">&quot;projet-afd-eva-ap/descriptive_stats/IUCN&quot;</span>, roi, <span class="st">&quot;no_marine&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), </span>
<span id="cb24-67"><a href="projects-funded-by-the-afd.html#cb24-67" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-68"><a href="projects-funded-by-the-afd.html#cb24-68" tabindex="-1"></a>  }</span>
<span id="cb24-69"><a href="projects-funded-by-the-afd.html#cb24-69" tabindex="-1"></a></span>
<span id="cb24-70"><a href="projects-funded-by-the-afd.html#cb24-70" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb24-71"><a href="projects-funded-by-the-afd.html#cb24-71" tabindex="-1"></a></span>
<span id="cb24-72"><a href="projects-funded-by-the-afd.html#cb24-72" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="iucn-categories-by-countries-and-regions-world-all" class="section level4 hasAnchor" number="2.3.1.4">
<h4><span class="header-section-number">2.3.1.4</span> IUCN categories by countries and regions (world, all)<a href="projects-funded-by-the-afd.html#iucn-categories-by-countries-and-regions-world-all" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For each country/region, the percentage of PAs in the different IUCN categories.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="projects-funded-by-the-afd.html#cb25-1" tabindex="-1"></a><span class="co">#Build the distribution of IUCN categories at country level ...</span></span>
<span id="cb25-2"><a href="projects-funded-by-the-afd.html#cb25-2" tabindex="-1"></a>data_iucn_ctry_en <span class="ot">=</span> <span class="fu">table</span>(data_stat_nodupl<span class="sc">$</span>iucn_des_en,</span>
<span id="cb25-3"><a href="projects-funded-by-the-afd.html#cb25-3" tabindex="-1"></a>                       data_stat_nodupl<span class="sc">$</span>iso3) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="projects-funded-by-the-afd.html#cb25-4" tabindex="-1"></a>  <span class="co">#Create a table with all iucn categories for each country, and compute the frequencies in percent</span></span>
<span id="cb25-5"><a href="projects-funded-by-the-afd.html#cb25-5" tabindex="-1"></a>  <span class="fu">prop.table</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="projects-funded-by-the-afd.html#cb25-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="projects-funded-by-the-afd.html#cb25-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Freq =</span> <span class="fu">round</span>(Freq, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="projects-funded-by-the-afd.html#cb25-8" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Var2, <span class="at">values_from =</span> Freq) <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="projects-funded-by-the-afd.html#cb25-9" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;iucn_des_en&quot;</span> <span class="ot">=</span> <span class="st">&quot;Var1&quot;</span>)</span>
<span id="cb25-10"><a href="projects-funded-by-the-afd.html#cb25-10" tabindex="-1"></a></span>
<span id="cb25-11"><a href="projects-funded-by-the-afd.html#cb25-11" tabindex="-1"></a><span class="co">#... and regional level</span></span>
<span id="cb25-12"><a href="projects-funded-by-the-afd.html#cb25-12" tabindex="-1"></a>data_iucn_reg_en <span class="ot">=</span> <span class="fu">table</span>(data_stat_nodupl<span class="sc">$</span>iucn_des_en,</span>
<span id="cb25-13"><a href="projects-funded-by-the-afd.html#cb25-13" tabindex="-1"></a>                       data_stat_nodupl<span class="sc">$</span>region_afd) <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="projects-funded-by-the-afd.html#cb25-14" tabindex="-1"></a>    <span class="co">#Create a table with all iucn categories for each country, and compute the frequencies in percent</span></span>
<span id="cb25-15"><a href="projects-funded-by-the-afd.html#cb25-15" tabindex="-1"></a>  <span class="fu">prop.table</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-16"><a href="projects-funded-by-the-afd.html#cb25-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-17"><a href="projects-funded-by-the-afd.html#cb25-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Freq =</span> <span class="fu">round</span>(Freq, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="projects-funded-by-the-afd.html#cb25-18" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Var2, <span class="at">values_from =</span> Freq) <span class="sc">%&gt;%</span></span>
<span id="cb25-19"><a href="projects-funded-by-the-afd.html#cb25-19" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;iucn_des_en&quot;</span> <span class="ot">=</span> <span class="st">&quot;Var1&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="projects-funded-by-the-afd.html#cb26-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb26-2"><a href="projects-funded-by-the-afd.html#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="projects-funded-by-the-afd.html#cb26-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb26-4"><a href="projects-funded-by-the-afd.html#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="projects-funded-by-the-afd.html#cb26-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(data_iucn_ctry_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb26-6"><a href="projects-funded-by-the-afd.html#cb26-6" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_iucn_ctry_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb26-7"><a href="projects-funded-by-the-afd.html#cb26-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(data_iucn_reg_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb26-8"><a href="projects-funded-by-the-afd.html#cb26-8" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_iucn_reg_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb26-9"><a href="projects-funded-by-the-afd.html#cb26-9" tabindex="-1"></a></span>
<span id="cb26-10"><a href="projects-funded-by-the-afd.html#cb26-10" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb26-11"><a href="projects-funded-by-the-afd.html#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="projects-funded-by-the-afd.html#cb26-12" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb26-13"><a href="projects-funded-by-the-afd.html#cb26-13" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-14"><a href="projects-funded-by-the-afd.html#cb26-14" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb26-15"><a href="projects-funded-by-the-afd.html#cb26-15" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb26-16"><a href="projects-funded-by-the-afd.html#cb26-16" tabindex="-1"></a>  {</span>
<span id="cb26-17"><a href="projects-funded-by-the-afd.html#cb26-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;&#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb26-18"><a href="projects-funded-by-the-afd.html#cb26-18" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb26-19"><a href="projects-funded-by-the-afd.html#cb26-19" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/IUCN/world/all&quot;</span>, </span>
<span id="cb26-20"><a href="projects-funded-by-the-afd.html#cb26-20" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-21"><a href="projects-funded-by-the-afd.html#cb26-21" tabindex="-1"></a>  }</span>
<span id="cb26-22"><a href="projects-funded-by-the-afd.html#cb26-22" tabindex="-1"></a></span>
<span id="cb26-23"><a href="projects-funded-by-the-afd.html#cb26-23" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb26-24"><a href="projects-funded-by-the-afd.html#cb26-24" tabindex="-1"></a></span>
<span id="cb26-25"><a href="projects-funded-by-the-afd.html#cb26-25" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
</div>
<div id="ecosystems-excluding-non-referenced-pas" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Ecosystems (excluding non-referenced PAs)<a href="projects-funded-by-the-afd.html#ecosystems-excluding-non-referenced-pas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The percentage of PAs in the ecosystem categories of WDPA : terrestrial, coastal and marine. A terrestrial PA has less than 10% of its area covered by sea or ocean, a marine one more than 90% and coastal PAs are in between. This definition is taken from the WDPA.</p>
<div id="proportion-of-pas-by-marine-or-terrestrial-areas-world" class="section level4 hasAnchor" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Proportion of PAs by marine or terrestrial areas (world)<a href="projects-funded-by-the-afd.html#proportion-of-pas-by-marine-or-terrestrial-areas-world" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>All PAs in the world.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="projects-funded-by-the-afd.html#cb27-1" tabindex="-1"></a><span class="co">#Build datasets</span></span>
<span id="cb27-2"><a href="projects-funded-by-the-afd.html#cb27-2" tabindex="-1"></a>data_eco <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="projects-funded-by-the-afd.html#cb27-3" tabindex="-1"></a>  <span class="co">#subset non-referencded PAs (have NA ecosysteme)</span></span>
<span id="cb27-4"><a href="projects-funded-by-the-afd.html#cb27-4" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="fu">is.na</span>(marine) <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="projects-funded-by-the-afd.html#cb27-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">marine =</span> <span class="fu">as.factor</span>(marine))</span>
<span id="cb27-6"><a href="projects-funded-by-the-afd.html#cb27-6" tabindex="-1"></a>data_eco<span class="sc">$</span>ecosyst_en <span class="ot">=</span> <span class="fu">fct_recode</span>(data_eco<span class="sc">$</span>marine, </span>
<span id="cb27-7"><a href="projects-funded-by-the-afd.html#cb27-7" tabindex="-1"></a>                              <span class="st">&quot;Terrestrial&quot;</span><span class="ot">=</span><span class="st">&quot;0&quot;</span>, </span>
<span id="cb27-8"><a href="projects-funded-by-the-afd.html#cb27-8" tabindex="-1"></a>                              <span class="st">&quot;Coastal&quot;</span><span class="ot">=</span><span class="st">&quot;1&quot;</span>, </span>
<span id="cb27-9"><a href="projects-funded-by-the-afd.html#cb27-9" tabindex="-1"></a>                              <span class="st">&quot;Marine&quot;</span><span class="ot">=</span><span class="st">&quot;2&quot;</span>)</span>
<span id="cb27-10"><a href="projects-funded-by-the-afd.html#cb27-10" tabindex="-1"></a>data_eco<span class="sc">$</span>ecosyst_fr <span class="ot">=</span> <span class="fu">fct_recode</span>(data_eco<span class="sc">$</span>marine, </span>
<span id="cb27-11"><a href="projects-funded-by-the-afd.html#cb27-11" tabindex="-1"></a>                              <span class="st">&quot;Terrestre&quot;</span><span class="ot">=</span><span class="st">&quot;0&quot;</span>, </span>
<span id="cb27-12"><a href="projects-funded-by-the-afd.html#cb27-12" tabindex="-1"></a>                              <span class="st">&quot;Côtier&quot;</span><span class="ot">=</span><span class="st">&quot;1&quot;</span>, </span>
<span id="cb27-13"><a href="projects-funded-by-the-afd.html#cb27-13" tabindex="-1"></a>                              <span class="st">&quot;Marin&quot;</span><span class="ot">=</span><span class="st">&quot;2&quot;</span>)</span>
<span id="cb27-14"><a href="projects-funded-by-the-afd.html#cb27-14" tabindex="-1"></a></span>
<span id="cb27-15"><a href="projects-funded-by-the-afd.html#cb27-15" tabindex="-1"></a>data_eco_hist <span class="ot">=</span> data_eco <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="projects-funded-by-the-afd.html#cb27-16" tabindex="-1"></a>  <span class="fu">group_by</span>(ecosyst_en, ecosyst_fr) <span class="sc">%&gt;%</span></span>
<span id="cb27-17"><a href="projects-funded-by-the-afd.html#cb27-17" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb27-18"><a href="projects-funded-by-the-afd.html#cb27-18" tabindex="-1"></a>            <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span><span class="fu">nrow</span>(data_eco), <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-19"><a href="projects-funded-by-the-afd.html#cb27-19" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb27-20"><a href="projects-funded-by-the-afd.html#cb27-20" tabindex="-1"></a></span>
<span id="cb27-21"><a href="projects-funded-by-the-afd.html#cb27-21" tabindex="-1"></a><span class="co">#Define tables</span></span>
<span id="cb27-22"><a href="projects-funded-by-the-afd.html#cb27-22" tabindex="-1"></a>tbl_eco_fr <span class="ot">=</span> data_eco_hist <span class="sc">%&gt;%</span></span>
<span id="cb27-23"><a href="projects-funded-by-the-afd.html#cb27-23" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(ecosyst_fr, n, freq)) <span class="sc">%&gt;%</span></span>
<span id="cb27-24"><a href="projects-funded-by-the-afd.html#cb27-24" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Ecosystème&quot;</span> <span class="ot">=</span> <span class="st">&quot;ecosyst_fr&quot;</span>,</span>
<span id="cb27-25"><a href="projects-funded-by-the-afd.html#cb27-25" tabindex="-1"></a>         <span class="st">&quot;Nombre d&#39;AP&quot;</span> <span class="ot">=</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb27-26"><a href="projects-funded-by-the-afd.html#cb27-26" tabindex="-1"></a>         <span class="st">&quot;Proportion d&#39;AP(%)&quot;</span> <span class="ot">=</span> <span class="st">&quot;freq&quot;</span>)</span>
<span id="cb27-27"><a href="projects-funded-by-the-afd.html#cb27-27" tabindex="-1"></a></span>
<span id="cb27-28"><a href="projects-funded-by-the-afd.html#cb27-28" tabindex="-1"></a>tbl_eco_en <span class="ot">=</span> data_eco_hist <span class="sc">%&gt;%</span></span>
<span id="cb27-29"><a href="projects-funded-by-the-afd.html#cb27-29" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(ecosyst_en, n, freq)) <span class="sc">%&gt;%</span></span>
<span id="cb27-30"><a href="projects-funded-by-the-afd.html#cb27-30" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Ecosystem&quot;</span> <span class="ot">=</span> <span class="st">&quot;ecosyst_en&quot;</span>,</span>
<span id="cb27-31"><a href="projects-funded-by-the-afd.html#cb27-31" tabindex="-1"></a>         <span class="st">&quot;Number of PAs&quot;</span> <span class="ot">=</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb27-32"><a href="projects-funded-by-the-afd.html#cb27-32" tabindex="-1"></a>         <span class="st">&quot;Share of PAs(%)&quot;</span> <span class="ot">=</span> <span class="st">&quot;freq&quot;</span>)</span>
<span id="cb27-33"><a href="projects-funded-by-the-afd.html#cb27-33" tabindex="-1"></a></span>
<span id="cb27-34"><a href="projects-funded-by-the-afd.html#cb27-34" tabindex="-1"></a></span>
<span id="cb27-35"><a href="projects-funded-by-the-afd.html#cb27-35" tabindex="-1"></a><span class="co">#Histogram in share (in French)</span></span>
<span id="cb27-36"><a href="projects-funded-by-the-afd.html#cb27-36" tabindex="-1"></a>hist_eco_shr_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb27-37"><a href="projects-funded-by-the-afd.html#cb27-37" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> ecosyst_fr, <span class="at">y =</span> freq, <span class="at">fill =</span> ecosyst_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb27-38"><a href="projects-funded-by-the-afd.html#cb27-38" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-39"><a href="projects-funded-by-the-afd.html#cb27-39" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n, <span class="dv">1</span>), <span class="at">y =</span> freq), </span>
<span id="cb27-40"><a href="projects-funded-by-the-afd.html#cb27-40" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb27-41"><a href="projects-funded-by-the-afd.html#cb27-41" tabindex="-1"></a>        <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-42"><a href="projects-funded-by-the-afd.html#cb27-42" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées par type d&#39;écosystème </span><span class="sc">\n</span><span class="st">(hors AP non-référencées)&quot;</span>,</span>
<span id="cb27-43"><a href="projects-funded-by-the-afd.html#cb27-43" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;sur&quot;</span>, <span class="fu">nrow</span>(data_stat_nodupl), <span class="st">&quot;aires protégées. Nombre d&#39;aires indiqué sur les barres.&quot;</span>),</span>
<span id="cb27-44"><a href="projects-funded-by-the-afd.html#cb27-44" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Type d&#39;écosystème&quot;</span>,</span>
<span id="cb27-45"><a href="projects-funded-by-the-afd.html#cb27-45" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion d&#39;aires protégées(%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-46"><a href="projects-funded-by-the-afd.html#cb27-46" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb27-47"><a href="projects-funded-by-the-afd.html#cb27-47" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb27-48"><a href="projects-funded-by-the-afd.html#cb27-48" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb27-49"><a href="projects-funded-by-the-afd.html#cb27-49" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb27-50"><a href="projects-funded-by-the-afd.html#cb27-50" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb27-51"><a href="projects-funded-by-the-afd.html#cb27-51" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb27-52"><a href="projects-funded-by-the-afd.html#cb27-52" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-53"><a href="projects-funded-by-the-afd.html#cb27-53" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-54"><a href="projects-funded-by-the-afd.html#cb27-54" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-55"><a href="projects-funded-by-the-afd.html#cb27-55" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb27-56"><a href="projects-funded-by-the-afd.html#cb27-56" tabindex="-1"></a>hist_eco_shr_fr</span>
<span id="cb27-57"><a href="projects-funded-by-the-afd.html#cb27-57" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb27-58"><a href="projects-funded-by-the-afd.html#cb27-58" tabindex="-1"></a></span>
<span id="cb27-59"><a href="projects-funded-by-the-afd.html#cb27-59" tabindex="-1"></a></span>
<span id="cb27-60"><a href="projects-funded-by-the-afd.html#cb27-60" tabindex="-1"></a></span>
<span id="cb27-61"><a href="projects-funded-by-the-afd.html#cb27-61" tabindex="-1"></a><span class="co">#Histogram in share (in English)</span></span>
<span id="cb27-62"><a href="projects-funded-by-the-afd.html#cb27-62" tabindex="-1"></a>hist_eco_shr_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb27-63"><a href="projects-funded-by-the-afd.html#cb27-63" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> ecosyst_en, <span class="at">y =</span> freq, <span class="at">fill =</span> ecosyst_en)) <span class="sc">%&gt;%</span></span>
<span id="cb27-64"><a href="projects-funded-by-the-afd.html#cb27-64" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-65"><a href="projects-funded-by-the-afd.html#cb27-65" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n, <span class="dv">1</span>), <span class="at">y =</span> freq), </span>
<span id="cb27-66"><a href="projects-funded-by-the-afd.html#cb27-66" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb27-67"><a href="projects-funded-by-the-afd.html#cb27-67" tabindex="-1"></a>        <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-68"><a href="projects-funded-by-the-afd.html#cb27-68" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion of protected areas by ecosystem type </span><span class="sc">\n</span><span class="st">(excluding not referenced PAs)&quot;</span>,</span>
<span id="cb27-69"><a href="projects-funded-by-the-afd.html#cb27-69" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;out of&quot;</span>, <span class="fu">nrow</span>(data_stat_nodupl), <span class="st">&quot;protected areas. Number of areas indicated above.&quot;</span>),</span>
<span id="cb27-70"><a href="projects-funded-by-the-afd.html#cb27-70" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Ecosystem type&quot;</span>,</span>
<span id="cb27-71"><a href="projects-funded-by-the-afd.html#cb27-71" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion of protected areas(%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-72"><a href="projects-funded-by-the-afd.html#cb27-72" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb27-73"><a href="projects-funded-by-the-afd.html#cb27-73" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb27-74"><a href="projects-funded-by-the-afd.html#cb27-74" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb27-75"><a href="projects-funded-by-the-afd.html#cb27-75" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb27-76"><a href="projects-funded-by-the-afd.html#cb27-76" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb27-77"><a href="projects-funded-by-the-afd.html#cb27-77" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb27-78"><a href="projects-funded-by-the-afd.html#cb27-78" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-79"><a href="projects-funded-by-the-afd.html#cb27-79" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-80"><a href="projects-funded-by-the-afd.html#cb27-80" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-81"><a href="projects-funded-by-the-afd.html#cb27-81" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb27-82"><a href="projects-funded-by-the-afd.html#cb27-82" tabindex="-1"></a><span class="co">#hist_eco_shr_en</span></span>
<span id="cb27-83"><a href="projects-funded-by-the-afd.html#cb27-83" tabindex="-1"></a></span>
<span id="cb27-84"><a href="projects-funded-by-the-afd.html#cb27-84" tabindex="-1"></a></span>
<span id="cb27-85"><a href="projects-funded-by-the-afd.html#cb27-85" tabindex="-1"></a>  </span>
<span id="cb27-86"><a href="projects-funded-by-the-afd.html#cb27-86" tabindex="-1"></a><span class="co">#Histogram in number (in French)</span></span>
<span id="cb27-87"><a href="projects-funded-by-the-afd.html#cb27-87" tabindex="-1"></a>hist_eco_n_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb27-88"><a href="projects-funded-by-the-afd.html#cb27-88" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> ecosyst_fr, <span class="at">y =</span> n, <span class="at">fill =</span> ecosyst_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb27-89"><a href="projects-funded-by-the-afd.html#cb27-89" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-90"><a href="projects-funded-by-the-afd.html#cb27-90" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées par type d&#39;écosystème </span><span class="sc">\n</span><span class="st">(hors AP non-référencées)&quot;</span>,</span>
<span id="cb27-91"><a href="projects-funded-by-the-afd.html#cb27-91" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;sur&quot;</span>, <span class="fu">nrow</span>(data_stat_nodupl), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb27-92"><a href="projects-funded-by-the-afd.html#cb27-92" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Type d&#39;écosystème&quot;</span>,</span>
<span id="cb27-93"><a href="projects-funded-by-the-afd.html#cb27-93" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;# d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-94"><a href="projects-funded-by-the-afd.html#cb27-94" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb27-95"><a href="projects-funded-by-the-afd.html#cb27-95" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb27-96"><a href="projects-funded-by-the-afd.html#cb27-96" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb27-97"><a href="projects-funded-by-the-afd.html#cb27-97" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb27-98"><a href="projects-funded-by-the-afd.html#cb27-98" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb27-99"><a href="projects-funded-by-the-afd.html#cb27-99" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb27-100"><a href="projects-funded-by-the-afd.html#cb27-100" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-101"><a href="projects-funded-by-the-afd.html#cb27-101" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-102"><a href="projects-funded-by-the-afd.html#cb27-102" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-103"><a href="projects-funded-by-the-afd.html#cb27-103" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb27-104"><a href="projects-funded-by-the-afd.html#cb27-104" tabindex="-1"></a>hist_eco_n_fr</span>
<span id="cb27-105"><a href="projects-funded-by-the-afd.html#cb27-105" tabindex="-1"></a></span>
<span id="cb27-106"><a href="projects-funded-by-the-afd.html#cb27-106" tabindex="-1"></a></span>
<span id="cb27-107"><a href="projects-funded-by-the-afd.html#cb27-107" tabindex="-1"></a><span class="co">#Histogram in number (in English)</span></span>
<span id="cb27-108"><a href="projects-funded-by-the-afd.html#cb27-108" tabindex="-1"></a>hist_eco_n_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb27-109"><a href="projects-funded-by-the-afd.html#cb27-109" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> ecosyst_en, <span class="at">y =</span> n, <span class="at">fill =</span> ecosyst_en)) <span class="sc">%&gt;%</span></span>
<span id="cb27-110"><a href="projects-funded-by-the-afd.html#cb27-110" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-111"><a href="projects-funded-by-the-afd.html#cb27-111" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion of protected areas by ecosystem type </span><span class="sc">\n</span><span class="st">(excluding not referenced PAs)&quot;</span>,</span>
<span id="cb27-112"><a href="projects-funded-by-the-afd.html#cb27-112" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;out of&quot;</span>, <span class="fu">nrow</span>(data_stat_nodupl), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb27-113"><a href="projects-funded-by-the-afd.html#cb27-113" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Ecosystem type&quot;</span>,</span>
<span id="cb27-114"><a href="projects-funded-by-the-afd.html#cb27-114" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;# of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-115"><a href="projects-funded-by-the-afd.html#cb27-115" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb27-116"><a href="projects-funded-by-the-afd.html#cb27-116" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb27-117"><a href="projects-funded-by-the-afd.html#cb27-117" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb27-118"><a href="projects-funded-by-the-afd.html#cb27-118" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb27-119"><a href="projects-funded-by-the-afd.html#cb27-119" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb27-120"><a href="projects-funded-by-the-afd.html#cb27-120" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb27-121"><a href="projects-funded-by-the-afd.html#cb27-121" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-122"><a href="projects-funded-by-the-afd.html#cb27-122" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-123"><a href="projects-funded-by-the-afd.html#cb27-123" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb27-124"><a href="projects-funded-by-the-afd.html#cb27-124" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb27-125"><a href="projects-funded-by-the-afd.html#cb27-125" tabindex="-1"></a><span class="co">#hist_eco_n_en</span></span>
<span id="cb27-126"><a href="projects-funded-by-the-afd.html#cb27-126" tabindex="-1"></a></span>
<span id="cb27-127"><a href="projects-funded-by-the-afd.html#cb27-127" tabindex="-1"></a><span class="co">#Pie chart (in French)</span></span>
<span id="cb27-128"><a href="projects-funded-by-the-afd.html#cb27-128" tabindex="-1"></a>pie_eco_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb27-129"><a href="projects-funded-by-the-afd.html#cb27-129" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> freq, <span class="at">fill =</span> ecosyst_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb27-130"><a href="projects-funded-by-the-afd.html#cb27-130" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-131"><a href="projects-funded-by-the-afd.html#cb27-131" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, <span class="at">label =</span> <span class="fu">paste0</span>(freq, <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb27-132"><a href="projects-funded-by-the-afd.html#cb27-132" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb27-133"><a href="projects-funded-by-the-afd.html#cb27-133" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-134"><a href="projects-funded-by-the-afd.html#cb27-134" tabindex="-1"></a><span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-135"><a href="projects-funded-by-the-afd.html#cb27-135" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion d&#39;aires protégées par type d&#39;écosystème </span><span class="sc">\n</span><span class="st">(hors AP non-référencées)&quot;</span>,</span>
<span id="cb27-136"><a href="projects-funded-by-the-afd.html#cb27-136" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;sur&quot;</span>, <span class="fu">nrow</span>(data_stat_nodupl), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb27-137"><a href="projects-funded-by-the-afd.html#cb27-137" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Type d&#39;écosystème&quot;</span>,</span>
<span id="cb27-138"><a href="projects-funded-by-the-afd.html#cb27-138" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-139"><a href="projects-funded-by-the-afd.html#cb27-139" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Ecosystème&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-140"><a href="projects-funded-by-the-afd.html#cb27-140" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb27-141"><a href="projects-funded-by-the-afd.html#cb27-141" tabindex="-1"></a>pie_eco_fr</span>
<span id="cb27-142"><a href="projects-funded-by-the-afd.html#cb27-142" tabindex="-1"></a></span>
<span id="cb27-143"><a href="projects-funded-by-the-afd.html#cb27-143" tabindex="-1"></a></span>
<span id="cb27-144"><a href="projects-funded-by-the-afd.html#cb27-144" tabindex="-1"></a><span class="co">#Histogram in number (in English)</span></span>
<span id="cb27-145"><a href="projects-funded-by-the-afd.html#cb27-145" tabindex="-1"></a>pie_eco_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb27-146"><a href="projects-funded-by-the-afd.html#cb27-146" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> n, <span class="at">fill =</span> ecosyst_en)) <span class="sc">%&gt;%</span></span>
<span id="cb27-147"><a href="projects-funded-by-the-afd.html#cb27-147" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-148"><a href="projects-funded-by-the-afd.html#cb27-148" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, <span class="at">label =</span> <span class="fu">paste0</span>(freq, <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb27-149"><a href="projects-funded-by-the-afd.html#cb27-149" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb27-150"><a href="projects-funded-by-the-afd.html#cb27-150" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-151"><a href="projects-funded-by-the-afd.html#cb27-151" tabindex="-1"></a><span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-152"><a href="projects-funded-by-the-afd.html#cb27-152" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Proportion of protected areas by ecosystem type </span><span class="sc">\n</span><span class="st">(excluding not referenced PAs)&quot;</span>,</span>
<span id="cb27-153"><a href="projects-funded-by-the-afd.html#cb27-153" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;out of&quot;</span>, <span class="fu">nrow</span>(data_stat_nodupl), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb27-154"><a href="projects-funded-by-the-afd.html#cb27-154" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Ecosystem type&quot;</span>,</span>
<span id="cb27-155"><a href="projects-funded-by-the-afd.html#cb27-155" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-156"><a href="projects-funded-by-the-afd.html#cb27-156" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Ecosystem&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-157"><a href="projects-funded-by-the-afd.html#cb27-157" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb27-158"><a href="projects-funded-by-the-afd.html#cb27-158" tabindex="-1"></a>pie_eco_en</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="projects-funded-by-the-afd.html#cb28-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb28-2"><a href="projects-funded-by-the-afd.html#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="projects-funded-by-the-afd.html#cb28-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb28-4"><a href="projects-funded-by-the-afd.html#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="projects-funded-by-the-afd.html#cb28-5" tabindex="-1"></a></span>
<span id="cb28-6"><a href="projects-funded-by-the-afd.html#cb28-6" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_eco_shr_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb28-7"><a href="projects-funded-by-the-afd.html#cb28-7" tabindex="-1"></a>       <span class="at">plot =</span> hist_eco_shr_fr,</span>
<span id="cb28-8"><a href="projects-funded-by-the-afd.html#cb28-8" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb28-9"><a href="projects-funded-by-the-afd.html#cb28-9" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb28-10"><a href="projects-funded-by-the-afd.html#cb28-10" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_eco_shr_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb28-11"><a href="projects-funded-by-the-afd.html#cb28-11" tabindex="-1"></a>       <span class="at">plot =</span> hist_eco_shr_en,</span>
<span id="cb28-12"><a href="projects-funded-by-the-afd.html#cb28-12" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb28-13"><a href="projects-funded-by-the-afd.html#cb28-13" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb28-14"><a href="projects-funded-by-the-afd.html#cb28-14" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_eco_n_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb28-15"><a href="projects-funded-by-the-afd.html#cb28-15" tabindex="-1"></a>       <span class="at">plot =</span> hist_eco_n_fr,</span>
<span id="cb28-16"><a href="projects-funded-by-the-afd.html#cb28-16" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb28-17"><a href="projects-funded-by-the-afd.html#cb28-17" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb28-18"><a href="projects-funded-by-the-afd.html#cb28-18" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_eco_n_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb28-19"><a href="projects-funded-by-the-afd.html#cb28-19" tabindex="-1"></a>       <span class="at">plot =</span> hist_eco_n_en,</span>
<span id="cb28-20"><a href="projects-funded-by-the-afd.html#cb28-20" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb28-21"><a href="projects-funded-by-the-afd.html#cb28-21" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb28-22"><a href="projects-funded-by-the-afd.html#cb28-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_eco_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb28-23"><a href="projects-funded-by-the-afd.html#cb28-23" tabindex="-1"></a>       <span class="at">plot =</span> pie_eco_fr,</span>
<span id="cb28-24"><a href="projects-funded-by-the-afd.html#cb28-24" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb28-25"><a href="projects-funded-by-the-afd.html#cb28-25" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb28-26"><a href="projects-funded-by-the-afd.html#cb28-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_eco_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb28-27"><a href="projects-funded-by-the-afd.html#cb28-27" tabindex="-1"></a>       <span class="at">plot =</span> pie_eco_en,</span>
<span id="cb28-28"><a href="projects-funded-by-the-afd.html#cb28-28" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb28-29"><a href="projects-funded-by-the-afd.html#cb28-29" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb28-30"><a href="projects-funded-by-the-afd.html#cb28-30" tabindex="-1"></a></span>
<span id="cb28-31"><a href="projects-funded-by-the-afd.html#cb28-31" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_eco_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb28-32"><a href="projects-funded-by-the-afd.html#cb28-32" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_ecosyst_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb28-33"><a href="projects-funded-by-the-afd.html#cb28-33" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_eco_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb28-34"><a href="projects-funded-by-the-afd.html#cb28-34" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_ecosyst_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb28-35"><a href="projects-funded-by-the-afd.html#cb28-35" tabindex="-1"></a></span>
<span id="cb28-36"><a href="projects-funded-by-the-afd.html#cb28-36" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb28-37"><a href="projects-funded-by-the-afd.html#cb28-37" tabindex="-1"></a></span>
<span id="cb28-38"><a href="projects-funded-by-the-afd.html#cb28-38" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb28-39"><a href="projects-funded-by-the-afd.html#cb28-39" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-40"><a href="projects-funded-by-the-afd.html#cb28-40" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb28-41"><a href="projects-funded-by-the-afd.html#cb28-41" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb28-42"><a href="projects-funded-by-the-afd.html#cb28-42" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb28-43"><a href="projects-funded-by-the-afd.html#cb28-43" tabindex="-1"></a>{</span>
<span id="cb28-44"><a href="projects-funded-by-the-afd.html#cb28-44" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-45"><a href="projects-funded-by-the-afd.html#cb28-45" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-46"><a href="projects-funded-by-the-afd.html#cb28-46" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb28-47"><a href="projects-funded-by-the-afd.html#cb28-47" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/ecosysteme/world&quot;</span>, </span>
<span id="cb28-48"><a href="projects-funded-by-the-afd.html#cb28-48" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-49"><a href="projects-funded-by-the-afd.html#cb28-49" tabindex="-1"></a>  }</span>
<span id="cb28-50"><a href="projects-funded-by-the-afd.html#cb28-50" tabindex="-1"></a></span>
<span id="cb28-51"><a href="projects-funded-by-the-afd.html#cb28-51" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb28-52"><a href="projects-funded-by-the-afd.html#cb28-52" tabindex="-1"></a></span>
<span id="cb28-53"><a href="projects-funded-by-the-afd.html#cb28-53" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="proportion-of-pas-by-marine-or-terrestrial-areas-region" class="section level4 hasAnchor" number="2.3.2.2">
<h4><span class="header-section-number">2.3.2.2</span> Proportion of PAs by marine or terrestrial areas (region)<a href="projects-funded-by-the-afd.html#proportion-of-pas-by-marine-or-terrestrial-areas-region" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>PAs in a given region to specify.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="projects-funded-by-the-afd.html#cb29-1" tabindex="-1"></a><span class="co">#Define the region of interest where the stats are performed</span></span>
<span id="cb29-2"><a href="projects-funded-by-the-afd.html#cb29-2" tabindex="-1"></a>roi <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span></span>
<span id="cb29-3"><a href="projects-funded-by-the-afd.html#cb29-3" tabindex="-1"></a></span>
<span id="cb29-4"><a href="projects-funded-by-the-afd.html#cb29-4" tabindex="-1"></a><span class="co">#Build datasets</span></span>
<span id="cb29-5"><a href="projects-funded-by-the-afd.html#cb29-5" tabindex="-1"></a>data_eco <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="projects-funded-by-the-afd.html#cb29-6" tabindex="-1"></a>  <span class="co">#subset non-referencded PAs (have NA ecosysteme)</span></span>
<span id="cb29-7"><a href="projects-funded-by-the-afd.html#cb29-7" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="fu">is.na</span>(marine) <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> region <span class="sc">==</span> roi) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="projects-funded-by-the-afd.html#cb29-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">marine =</span> <span class="fu">as.factor</span>(marine))</span>
<span id="cb29-9"><a href="projects-funded-by-the-afd.html#cb29-9" tabindex="-1"></a>data_eco<span class="sc">$</span>ecosyst_en <span class="ot">=</span> <span class="fu">fct_recode</span>(data_eco<span class="sc">$</span>marine, </span>
<span id="cb29-10"><a href="projects-funded-by-the-afd.html#cb29-10" tabindex="-1"></a>                              <span class="st">&quot;Terrestrial&quot;</span><span class="ot">=</span><span class="st">&quot;0&quot;</span>, </span>
<span id="cb29-11"><a href="projects-funded-by-the-afd.html#cb29-11" tabindex="-1"></a>                              <span class="st">&quot;Coastal&quot;</span><span class="ot">=</span><span class="st">&quot;1&quot;</span>, </span>
<span id="cb29-12"><a href="projects-funded-by-the-afd.html#cb29-12" tabindex="-1"></a>                              <span class="st">&quot;Marine&quot;</span><span class="ot">=</span><span class="st">&quot;2&quot;</span>)</span>
<span id="cb29-13"><a href="projects-funded-by-the-afd.html#cb29-13" tabindex="-1"></a>data_eco<span class="sc">$</span>ecosyst_fr <span class="ot">=</span> <span class="fu">fct_recode</span>(data_eco<span class="sc">$</span>marine, </span>
<span id="cb29-14"><a href="projects-funded-by-the-afd.html#cb29-14" tabindex="-1"></a>                              <span class="st">&quot;Terrestre&quot;</span><span class="ot">=</span><span class="st">&quot;0&quot;</span>, </span>
<span id="cb29-15"><a href="projects-funded-by-the-afd.html#cb29-15" tabindex="-1"></a>                              <span class="st">&quot;Côtier&quot;</span><span class="ot">=</span><span class="st">&quot;1&quot;</span>, </span>
<span id="cb29-16"><a href="projects-funded-by-the-afd.html#cb29-16" tabindex="-1"></a>                              <span class="st">&quot;Marin&quot;</span><span class="ot">=</span><span class="st">&quot;2&quot;</span>)</span>
<span id="cb29-17"><a href="projects-funded-by-the-afd.html#cb29-17" tabindex="-1"></a></span>
<span id="cb29-18"><a href="projects-funded-by-the-afd.html#cb29-18" tabindex="-1"></a>data_eco_hist <span class="ot">=</span> data_eco <span class="sc">%&gt;%</span></span>
<span id="cb29-19"><a href="projects-funded-by-the-afd.html#cb29-19" tabindex="-1"></a>  <span class="fu">group_by</span>(ecosyst_en, ecosyst_fr) <span class="sc">%&gt;%</span></span>
<span id="cb29-20"><a href="projects-funded-by-the-afd.html#cb29-20" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb29-21"><a href="projects-funded-by-the-afd.html#cb29-21" tabindex="-1"></a>            <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span><span class="fu">nrow</span>(data_eco), <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-22"><a href="projects-funded-by-the-afd.html#cb29-22" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb29-23"><a href="projects-funded-by-the-afd.html#cb29-23" tabindex="-1"></a></span>
<span id="cb29-24"><a href="projects-funded-by-the-afd.html#cb29-24" tabindex="-1"></a>tbl_eco_fr <span class="ot">=</span> data_eco_hist <span class="sc">%&gt;%</span></span>
<span id="cb29-25"><a href="projects-funded-by-the-afd.html#cb29-25" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(ecosyst_fr, n, freq)) <span class="sc">%&gt;%</span></span>
<span id="cb29-26"><a href="projects-funded-by-the-afd.html#cb29-26" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Ecosystème&quot;</span> <span class="ot">=</span> <span class="st">&quot;ecosyst_fr&quot;</span>,</span>
<span id="cb29-27"><a href="projects-funded-by-the-afd.html#cb29-27" tabindex="-1"></a>         <span class="st">&quot;Nombre d&#39;AP&quot;</span> <span class="ot">=</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb29-28"><a href="projects-funded-by-the-afd.html#cb29-28" tabindex="-1"></a>         <span class="st">&quot;Proportion d&#39;AP(%)&quot;</span> <span class="ot">=</span> <span class="st">&quot;freq&quot;</span>)</span>
<span id="cb29-29"><a href="projects-funded-by-the-afd.html#cb29-29" tabindex="-1"></a></span>
<span id="cb29-30"><a href="projects-funded-by-the-afd.html#cb29-30" tabindex="-1"></a>tbl_eco_en <span class="ot">=</span> data_eco_hist <span class="sc">%&gt;%</span></span>
<span id="cb29-31"><a href="projects-funded-by-the-afd.html#cb29-31" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(ecosyst_en, n, freq)) <span class="sc">%&gt;%</span></span>
<span id="cb29-32"><a href="projects-funded-by-the-afd.html#cb29-32" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Ecosystem&quot;</span> <span class="ot">=</span> <span class="st">&quot;ecosyst_en&quot;</span>,</span>
<span id="cb29-33"><a href="projects-funded-by-the-afd.html#cb29-33" tabindex="-1"></a>         <span class="st">&quot;Number of PAs&quot;</span> <span class="ot">=</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb29-34"><a href="projects-funded-by-the-afd.html#cb29-34" tabindex="-1"></a>         <span class="st">&quot;Share of PAs(%)&quot;</span> <span class="ot">=</span> <span class="st">&quot;freq&quot;</span>)</span>
<span id="cb29-35"><a href="projects-funded-by-the-afd.html#cb29-35" tabindex="-1"></a></span>
<span id="cb29-36"><a href="projects-funded-by-the-afd.html#cb29-36" tabindex="-1"></a></span>
<span id="cb29-37"><a href="projects-funded-by-the-afd.html#cb29-37" tabindex="-1"></a><span class="co">#Histogram in share (in French)</span></span>
<span id="cb29-38"><a href="projects-funded-by-the-afd.html#cb29-38" tabindex="-1"></a>hist_eco_shr_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb29-39"><a href="projects-funded-by-the-afd.html#cb29-39" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> ecosyst_fr, <span class="at">y =</span> freq, <span class="at">fill =</span> ecosyst_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb29-40"><a href="projects-funded-by-the-afd.html#cb29-40" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-41"><a href="projects-funded-by-the-afd.html#cb29-41" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n, <span class="dv">1</span>), <span class="at">y =</span> freq), </span>
<span id="cb29-42"><a href="projects-funded-by-the-afd.html#cb29-42" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb29-43"><a href="projects-funded-by-the-afd.html#cb29-43" tabindex="-1"></a>        <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-44"><a href="projects-funded-by-the-afd.html#cb29-44" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion d&#39;aires protégées par type d&#39;écosystème,&quot;</span>, roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(hors AP non-référencées)&quot;</span>),</span>
<span id="cb29-45"><a href="projects-funded-by-the-afd.html#cb29-45" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;sur&quot;</span>, <span class="fu">nrow</span>(<span class="fu">subset</span>(data_stat_nodupl, region <span class="sc">==</span> roi)), <span class="st">&quot;aires protégées. Nombre d&#39;aires indiqué sur les barres.&quot;</span>),</span>
<span id="cb29-46"><a href="projects-funded-by-the-afd.html#cb29-46" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Type d&#39;écosystème&quot;</span>,</span>
<span id="cb29-47"><a href="projects-funded-by-the-afd.html#cb29-47" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion d&#39;aires protégées(%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-48"><a href="projects-funded-by-the-afd.html#cb29-48" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb29-49"><a href="projects-funded-by-the-afd.html#cb29-49" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb29-50"><a href="projects-funded-by-the-afd.html#cb29-50" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb29-51"><a href="projects-funded-by-the-afd.html#cb29-51" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb29-52"><a href="projects-funded-by-the-afd.html#cb29-52" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb29-53"><a href="projects-funded-by-the-afd.html#cb29-53" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb29-54"><a href="projects-funded-by-the-afd.html#cb29-54" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-55"><a href="projects-funded-by-the-afd.html#cb29-55" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-56"><a href="projects-funded-by-the-afd.html#cb29-56" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-57"><a href="projects-funded-by-the-afd.html#cb29-57" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb29-58"><a href="projects-funded-by-the-afd.html#cb29-58" tabindex="-1"></a>hist_eco_shr_fr</span>
<span id="cb29-59"><a href="projects-funded-by-the-afd.html#cb29-59" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb29-60"><a href="projects-funded-by-the-afd.html#cb29-60" tabindex="-1"></a></span>
<span id="cb29-61"><a href="projects-funded-by-the-afd.html#cb29-61" tabindex="-1"></a></span>
<span id="cb29-62"><a href="projects-funded-by-the-afd.html#cb29-62" tabindex="-1"></a></span>
<span id="cb29-63"><a href="projects-funded-by-the-afd.html#cb29-63" tabindex="-1"></a><span class="co">#Histogram in share (in English)</span></span>
<span id="cb29-64"><a href="projects-funded-by-the-afd.html#cb29-64" tabindex="-1"></a>hist_eco_shr_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb29-65"><a href="projects-funded-by-the-afd.html#cb29-65" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> ecosyst_en, <span class="at">y =</span> freq, <span class="at">fill =</span> ecosyst_en)) <span class="sc">%&gt;%</span></span>
<span id="cb29-66"><a href="projects-funded-by-the-afd.html#cb29-66" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-67"><a href="projects-funded-by-the-afd.html#cb29-67" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(n, <span class="dv">1</span>), <span class="at">y =</span> freq), </span>
<span id="cb29-68"><a href="projects-funded-by-the-afd.html#cb29-68" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb29-69"><a href="projects-funded-by-the-afd.html#cb29-69" tabindex="-1"></a>        <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-70"><a href="projects-funded-by-the-afd.html#cb29-70" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion of protected areas by ecosystem type,&quot;</span>, roi,  <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(excluding not referenced PAs)&quot;</span>),</span>
<span id="cb29-71"><a href="projects-funded-by-the-afd.html#cb29-71" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;out of&quot;</span>, <span class="fu">nrow</span>(<span class="fu">subset</span>(data_stat_nodupl, region <span class="sc">==</span> roi)), <span class="st">&quot;protected areas. Number of areas indicated above.&quot;</span>),</span>
<span id="cb29-72"><a href="projects-funded-by-the-afd.html#cb29-72" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Ecosystem type&quot;</span>,</span>
<span id="cb29-73"><a href="projects-funded-by-the-afd.html#cb29-73" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion of protected areas(%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-74"><a href="projects-funded-by-the-afd.html#cb29-74" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb29-75"><a href="projects-funded-by-the-afd.html#cb29-75" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb29-76"><a href="projects-funded-by-the-afd.html#cb29-76" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb29-77"><a href="projects-funded-by-the-afd.html#cb29-77" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb29-78"><a href="projects-funded-by-the-afd.html#cb29-78" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb29-79"><a href="projects-funded-by-the-afd.html#cb29-79" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb29-80"><a href="projects-funded-by-the-afd.html#cb29-80" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-81"><a href="projects-funded-by-the-afd.html#cb29-81" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-82"><a href="projects-funded-by-the-afd.html#cb29-82" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-83"><a href="projects-funded-by-the-afd.html#cb29-83" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb29-84"><a href="projects-funded-by-the-afd.html#cb29-84" tabindex="-1"></a>hist_eco_shr_en</span>
<span id="cb29-85"><a href="projects-funded-by-the-afd.html#cb29-85" tabindex="-1"></a></span>
<span id="cb29-86"><a href="projects-funded-by-the-afd.html#cb29-86" tabindex="-1"></a></span>
<span id="cb29-87"><a href="projects-funded-by-the-afd.html#cb29-87" tabindex="-1"></a>  </span>
<span id="cb29-88"><a href="projects-funded-by-the-afd.html#cb29-88" tabindex="-1"></a><span class="co">#Histogram in number (in French)</span></span>
<span id="cb29-89"><a href="projects-funded-by-the-afd.html#cb29-89" tabindex="-1"></a>hist_eco_n_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb29-90"><a href="projects-funded-by-the-afd.html#cb29-90" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> ecosyst_fr, <span class="at">y =</span> n, <span class="at">fill =</span> ecosyst_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb29-91"><a href="projects-funded-by-the-afd.html#cb29-91" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-92"><a href="projects-funded-by-the-afd.html#cb29-92" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion d&#39;aires protégées par type d&#39;écosystème,&quot;</span>, roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(hors AP non-référencées)&quot;</span>),</span>
<span id="cb29-93"><a href="projects-funded-by-the-afd.html#cb29-93" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;sur&quot;</span>, <span class="fu">nrow</span>(<span class="fu">subset</span>(data_stat_nodupl, region <span class="sc">==</span> roi)), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb29-94"><a href="projects-funded-by-the-afd.html#cb29-94" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Type d&#39;écosystème&quot;</span>,</span>
<span id="cb29-95"><a href="projects-funded-by-the-afd.html#cb29-95" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;# d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-96"><a href="projects-funded-by-the-afd.html#cb29-96" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb29-97"><a href="projects-funded-by-the-afd.html#cb29-97" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb29-98"><a href="projects-funded-by-the-afd.html#cb29-98" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb29-99"><a href="projects-funded-by-the-afd.html#cb29-99" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb29-100"><a href="projects-funded-by-the-afd.html#cb29-100" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb29-101"><a href="projects-funded-by-the-afd.html#cb29-101" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb29-102"><a href="projects-funded-by-the-afd.html#cb29-102" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-103"><a href="projects-funded-by-the-afd.html#cb29-103" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-104"><a href="projects-funded-by-the-afd.html#cb29-104" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-105"><a href="projects-funded-by-the-afd.html#cb29-105" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb29-106"><a href="projects-funded-by-the-afd.html#cb29-106" tabindex="-1"></a>hist_eco_n_fr</span>
<span id="cb29-107"><a href="projects-funded-by-the-afd.html#cb29-107" tabindex="-1"></a></span>
<span id="cb29-108"><a href="projects-funded-by-the-afd.html#cb29-108" tabindex="-1"></a></span>
<span id="cb29-109"><a href="projects-funded-by-the-afd.html#cb29-109" tabindex="-1"></a><span class="co">#Histogram in number (in English)</span></span>
<span id="cb29-110"><a href="projects-funded-by-the-afd.html#cb29-110" tabindex="-1"></a>hist_eco_n_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb29-111"><a href="projects-funded-by-the-afd.html#cb29-111" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> ecosyst_en, <span class="at">y =</span> n, <span class="at">fill =</span> ecosyst_en)) <span class="sc">%&gt;%</span></span>
<span id="cb29-112"><a href="projects-funded-by-the-afd.html#cb29-112" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-113"><a href="projects-funded-by-the-afd.html#cb29-113" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion of protected areas by ecosystem type,&quot;</span>, roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(excluding not referenced PAs)&quot;</span>),</span>
<span id="cb29-114"><a href="projects-funded-by-the-afd.html#cb29-114" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;out of&quot;</span>, <span class="fu">nrow</span>(<span class="fu">subset</span>(data_stat_nodupl, region <span class="sc">==</span> roi)), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb29-115"><a href="projects-funded-by-the-afd.html#cb29-115" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Ecosystem type&quot;</span>,</span>
<span id="cb29-116"><a href="projects-funded-by-the-afd.html#cb29-116" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;# of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-117"><a href="projects-funded-by-the-afd.html#cb29-117" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb29-118"><a href="projects-funded-by-the-afd.html#cb29-118" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb29-119"><a href="projects-funded-by-the-afd.html#cb29-119" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb29-120"><a href="projects-funded-by-the-afd.html#cb29-120" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb29-121"><a href="projects-funded-by-the-afd.html#cb29-121" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb29-122"><a href="projects-funded-by-the-afd.html#cb29-122" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb29-123"><a href="projects-funded-by-the-afd.html#cb29-123" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-124"><a href="projects-funded-by-the-afd.html#cb29-124" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-125"><a href="projects-funded-by-the-afd.html#cb29-125" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb29-126"><a href="projects-funded-by-the-afd.html#cb29-126" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb29-127"><a href="projects-funded-by-the-afd.html#cb29-127" tabindex="-1"></a>hist_eco_n_en</span>
<span id="cb29-128"><a href="projects-funded-by-the-afd.html#cb29-128" tabindex="-1"></a></span>
<span id="cb29-129"><a href="projects-funded-by-the-afd.html#cb29-129" tabindex="-1"></a><span class="co">#Pie chart (in French)</span></span>
<span id="cb29-130"><a href="projects-funded-by-the-afd.html#cb29-130" tabindex="-1"></a>pie_eco_fr <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb29-131"><a href="projects-funded-by-the-afd.html#cb29-131" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> freq, <span class="at">fill =</span> ecosyst_fr)) <span class="sc">%&gt;%</span></span>
<span id="cb29-132"><a href="projects-funded-by-the-afd.html#cb29-132" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-133"><a href="projects-funded-by-the-afd.html#cb29-133" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, <span class="at">label =</span> <span class="fu">paste0</span>(freq, <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb29-134"><a href="projects-funded-by-the-afd.html#cb29-134" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb29-135"><a href="projects-funded-by-the-afd.html#cb29-135" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-136"><a href="projects-funded-by-the-afd.html#cb29-136" tabindex="-1"></a><span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-137"><a href="projects-funded-by-the-afd.html#cb29-137" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion d&#39;aires protégées par type d&#39;écosystème,&quot;</span>, roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(hors AP non-référencées)&quot;</span>),</span>
<span id="cb29-138"><a href="projects-funded-by-the-afd.html#cb29-138" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;sur&quot;</span>, <span class="fu">nrow</span>(<span class="fu">subset</span>(data_stat_nodupl, region <span class="sc">==</span> roi)), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb29-139"><a href="projects-funded-by-the-afd.html#cb29-139" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Type d&#39;écosystème&quot;</span>,</span>
<span id="cb29-140"><a href="projects-funded-by-the-afd.html#cb29-140" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-141"><a href="projects-funded-by-the-afd.html#cb29-141" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Ecosystème&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-142"><a href="projects-funded-by-the-afd.html#cb29-142" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb29-143"><a href="projects-funded-by-the-afd.html#cb29-143" tabindex="-1"></a>pie_eco_fr</span>
<span id="cb29-144"><a href="projects-funded-by-the-afd.html#cb29-144" tabindex="-1"></a></span>
<span id="cb29-145"><a href="projects-funded-by-the-afd.html#cb29-145" tabindex="-1"></a></span>
<span id="cb29-146"><a href="projects-funded-by-the-afd.html#cb29-146" tabindex="-1"></a><span class="co">#Histogram in number (in English)</span></span>
<span id="cb29-147"><a href="projects-funded-by-the-afd.html#cb29-147" tabindex="-1"></a>pie_eco_en <span class="ot">=</span> <span class="fu">ggplot</span>(data_eco_hist, </span>
<span id="cb29-148"><a href="projects-funded-by-the-afd.html#cb29-148" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> n, <span class="at">fill =</span> ecosyst_en)) <span class="sc">%&gt;%</span></span>
<span id="cb29-149"><a href="projects-funded-by-the-afd.html#cb29-149" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-150"><a href="projects-funded-by-the-afd.html#cb29-150" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, <span class="at">label =</span> <span class="fu">paste0</span>(freq, <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb29-151"><a href="projects-funded-by-the-afd.html#cb29-151" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb29-152"><a href="projects-funded-by-the-afd.html#cb29-152" tabindex="-1"></a>             <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-153"><a href="projects-funded-by-the-afd.html#cb29-153" tabindex="-1"></a><span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-154"><a href="projects-funded-by-the-afd.html#cb29-154" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Proportion of protected areas by ecosystem type,&quot;</span>, roi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">(excluding not referenced PAs)&quot;</span>),</span>
<span id="cb29-155"><a href="projects-funded-by-the-afd.html#cb29-155" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_eco_hist<span class="sc">$</span>n), <span class="st">&quot;out of&quot;</span>, <span class="fu">nrow</span>(<span class="fu">subset</span>(data_stat_nodupl, region <span class="sc">==</span> roi)), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb29-156"><a href="projects-funded-by-the-afd.html#cb29-156" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Ecosystem type&quot;</span>,</span>
<span id="cb29-157"><a href="projects-funded-by-the-afd.html#cb29-157" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Proportion of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-158"><a href="projects-funded-by-the-afd.html#cb29-158" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Ecosystem&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-159"><a href="projects-funded-by-the-afd.html#cb29-159" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb29-160"><a href="projects-funded-by-the-afd.html#cb29-160" tabindex="-1"></a>pie_eco_en</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="projects-funded-by-the-afd.html#cb30-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb30-2"><a href="projects-funded-by-the-afd.html#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="projects-funded-by-the-afd.html#cb30-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb30-4"><a href="projects-funded-by-the-afd.html#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="projects-funded-by-the-afd.html#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="projects-funded-by-the-afd.html#cb30-6" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;hist_eco_shr_&quot;</span>, roi, <span class="st">&quot;_fr.png&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb30-7"><a href="projects-funded-by-the-afd.html#cb30-7" tabindex="-1"></a>       <span class="at">plot =</span> hist_eco_shr_fr,</span>
<span id="cb30-8"><a href="projects-funded-by-the-afd.html#cb30-8" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb30-9"><a href="projects-funded-by-the-afd.html#cb30-9" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb30-10"><a href="projects-funded-by-the-afd.html#cb30-10" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;hist_eco_shr_&quot;</span>, roi, <span class="st">&quot;_en.png&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb30-11"><a href="projects-funded-by-the-afd.html#cb30-11" tabindex="-1"></a>       <span class="at">plot =</span> hist_eco_shr_en,</span>
<span id="cb30-12"><a href="projects-funded-by-the-afd.html#cb30-12" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb30-13"><a href="projects-funded-by-the-afd.html#cb30-13" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb30-14"><a href="projects-funded-by-the-afd.html#cb30-14" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;hist_eco_n_&quot;</span>, roi, <span class="st">&quot;_fr.png&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb30-15"><a href="projects-funded-by-the-afd.html#cb30-15" tabindex="-1"></a>       <span class="at">plot =</span> hist_eco_n_fr,</span>
<span id="cb30-16"><a href="projects-funded-by-the-afd.html#cb30-16" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb30-17"><a href="projects-funded-by-the-afd.html#cb30-17" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb30-18"><a href="projects-funded-by-the-afd.html#cb30-18" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;hist_eco_n_&quot;</span>, roi, <span class="st">&quot;_en.png&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb30-19"><a href="projects-funded-by-the-afd.html#cb30-19" tabindex="-1"></a>       <span class="at">plot =</span> hist_eco_n_en,</span>
<span id="cb30-20"><a href="projects-funded-by-the-afd.html#cb30-20" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb30-21"><a href="projects-funded-by-the-afd.html#cb30-21" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb30-22"><a href="projects-funded-by-the-afd.html#cb30-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;pie_eco_&quot;</span>, roi, <span class="st">&quot;_fr.png&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb30-23"><a href="projects-funded-by-the-afd.html#cb30-23" tabindex="-1"></a>       <span class="at">plot =</span> pie_eco_fr,</span>
<span id="cb30-24"><a href="projects-funded-by-the-afd.html#cb30-24" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb30-25"><a href="projects-funded-by-the-afd.html#cb30-25" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb30-26"><a href="projects-funded-by-the-afd.html#cb30-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;pie_eco_&quot;</span>, roi, <span class="st">&quot;_en.png&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb30-27"><a href="projects-funded-by-the-afd.html#cb30-27" tabindex="-1"></a>       <span class="at">plot =</span> pie_eco_en,</span>
<span id="cb30-28"><a href="projects-funded-by-the-afd.html#cb30-28" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb30-29"><a href="projects-funded-by-the-afd.html#cb30-29" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb30-30"><a href="projects-funded-by-the-afd.html#cb30-30" tabindex="-1"></a></span>
<span id="cb30-31"><a href="projects-funded-by-the-afd.html#cb30-31" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_eco_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb30-32"><a href="projects-funded-by-the-afd.html#cb30-32" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;tbl_ecosyst_&quot;</span>, roi, <span class="st">&quot;_fr.tex&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb30-33"><a href="projects-funded-by-the-afd.html#cb30-33" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_eco_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb30-34"><a href="projects-funded-by-the-afd.html#cb30-34" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;tbl_ecosyst_&quot;</span>, roi, <span class="st">&quot;_en.tex&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb30-35"><a href="projects-funded-by-the-afd.html#cb30-35" tabindex="-1"></a></span>
<span id="cb30-36"><a href="projects-funded-by-the-afd.html#cb30-36" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb30-37"><a href="projects-funded-by-the-afd.html#cb30-37" tabindex="-1"></a></span>
<span id="cb30-38"><a href="projects-funded-by-the-afd.html#cb30-38" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb30-39"><a href="projects-funded-by-the-afd.html#cb30-39" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-40"><a href="projects-funded-by-the-afd.html#cb30-40" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb30-41"><a href="projects-funded-by-the-afd.html#cb30-41" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb30-42"><a href="projects-funded-by-the-afd.html#cb30-42" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb30-43"><a href="projects-funded-by-the-afd.html#cb30-43" tabindex="-1"></a>{</span>
<span id="cb30-44"><a href="projects-funded-by-the-afd.html#cb30-44" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb30-45"><a href="projects-funded-by-the-afd.html#cb30-45" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb30-46"><a href="projects-funded-by-the-afd.html#cb30-46" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb30-47"><a href="projects-funded-by-the-afd.html#cb30-47" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="fu">paste</span>(<span class="st">&quot;projet-afd-eva-ap/descriptive_stats/ecosysteme&quot;</span>, roi, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), </span>
<span id="cb30-48"><a href="projects-funded-by-the-afd.html#cb30-48" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-49"><a href="projects-funded-by-the-afd.html#cb30-49" tabindex="-1"></a>  }</span>
<span id="cb30-50"><a href="projects-funded-by-the-afd.html#cb30-50" tabindex="-1"></a></span>
<span id="cb30-51"><a href="projects-funded-by-the-afd.html#cb30-51" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb30-52"><a href="projects-funded-by-the-afd.html#cb30-52" tabindex="-1"></a></span>
<span id="cb30-53"><a href="projects-funded-by-the-afd.html#cb30-53" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
</div>
<div id="distribution-and-surface-of-pas-across-countries-and-regions" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Distribution (# and surface) of PAs across countries and regions<a href="projects-funded-by-the-afd.html#distribution-and-surface-of-pas-across-countries-and-regions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Number/share of PAs in the different countries/regions.</p>
<div id="statistics-at-country-level-all" class="section level4 hasAnchor" number="2.3.3.1">
<h4><span class="header-section-number">2.3.3.1</span> Statistics at country level (all)<a href="projects-funded-by-the-afd.html#statistics-at-country-level-all" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For all PAs in the world.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="projects-funded-by-the-afd.html#cb31-1" tabindex="-1"></a><span class="co">#Surface and number of PAs by country</span></span>
<span id="cb31-2"><a href="projects-funded-by-the-afd.html#cb31-2" tabindex="-1"></a>data_distrib_ctry <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="projects-funded-by-the-afd.html#cb31-3" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3, country_en, country_fr) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="projects-funded-by-the-afd.html#cb31-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb31-5"><a href="projects-funded-by-the-afd.html#cb31-5" tabindex="-1"></a>            <span class="at">area_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="projects-funded-by-the-afd.html#cb31-6" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="projects-funded-by-the-afd.html#cb31-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-8"><a href="projects-funded-by-the-afd.html#cb31-8" tabindex="-1"></a>         <span class="at">area_tot_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-9"><a href="projects-funded-by-the-afd.html#cb31-9" tabindex="-1"></a>         <span class="at">freq_n =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb31-10"><a href="projects-funded-by-the-afd.html#cb31-10" tabindex="-1"></a>         <span class="at">freq_area =</span> <span class="fu">round</span>(area_km2<span class="sc">/</span>area_tot_km2<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="projects-funded-by-the-afd.html#cb31-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;freq_n&quot;</span>, <span class="st">&quot;area_km2&quot;</span>, <span class="st">&quot;freq_area&quot;</span>),</span>
<span id="cb31-12"><a href="projects-funded-by-the-afd.html#cb31-12" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>)</span>
<span id="cb31-13"><a href="projects-funded-by-the-afd.html#cb31-13" tabindex="-1"></a></span>
<span id="cb31-14"><a href="projects-funded-by-the-afd.html#cb31-14" tabindex="-1"></a><span class="co">#Top targeted countries in terms of number/surface of PAs</span></span>
<span id="cb31-15"><a href="projects-funded-by-the-afd.html#cb31-15" tabindex="-1"></a>data_distrib_ctry_top_n <span class="ot">=</span> data_distrib_ctry <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="projects-funded-by-the-afd.html#cb31-16" tabindex="-1"></a>  <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">&quot;freq_n&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="projects-funded-by-the-afd.html#cb31-17" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>value) <span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="projects-funded-by-the-afd.html#cb31-18" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb31-19"><a href="projects-funded-by-the-afd.html#cb31-19" tabindex="-1"></a>data_distrib_ctry_top_area <span class="ot">=</span> data_distrib_ctry <span class="sc">%&gt;%</span></span>
<span id="cb31-20"><a href="projects-funded-by-the-afd.html#cb31-20" tabindex="-1"></a>  <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">&quot;freq_area&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-21"><a href="projects-funded-by-the-afd.html#cb31-21" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>value) <span class="sc">%&gt;%</span></span>
<span id="cb31-22"><a href="projects-funded-by-the-afd.html#cb31-22" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb31-23"><a href="projects-funded-by-the-afd.html#cb31-23" tabindex="-1"></a></span>
<span id="cb31-24"><a href="projects-funded-by-the-afd.html#cb31-24" tabindex="-1"></a><span class="co">#Histogram in share (in French) for top countries</span></span>
<span id="cb31-25"><a href="projects-funded-by-the-afd.html#cb31-25" tabindex="-1"></a><span class="do">##Number of PAs</span></span>
<span id="cb31-26"><a href="projects-funded-by-the-afd.html#cb31-26" tabindex="-1"></a>hist_distrib_ctry_top_n_shr <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_top_n, </span>
<span id="cb31-27"><a href="projects-funded-by-the-afd.html#cb31-27" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country_en, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb31-28"><a href="projects-funded-by-the-afd.html#cb31-28" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-29"><a href="projects-funded-by-the-afd.html#cb31-29" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb31-30"><a href="projects-funded-by-the-afd.html#cb31-30" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb31-31"><a href="projects-funded-by-the-afd.html#cb31-31" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb31-32"><a href="projects-funded-by-the-afd.html#cb31-32" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Countries most targeted by AFD funded protected areas (#)&quot;</span>,</span>
<span id="cb31-33"><a href="projects-funded-by-the-afd.html#cb31-33" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb31-34"><a href="projects-funded-by-the-afd.html#cb31-34" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb31-35"><a href="projects-funded-by-the-afd.html#cb31-35" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-36"><a href="projects-funded-by-the-afd.html#cb31-36" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb31-37"><a href="projects-funded-by-the-afd.html#cb31-37" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb31-38"><a href="projects-funded-by-the-afd.html#cb31-38" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb31-39"><a href="projects-funded-by-the-afd.html#cb31-39" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb31-40"><a href="projects-funded-by-the-afd.html#cb31-40" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb31-41"><a href="projects-funded-by-the-afd.html#cb31-41" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb31-42"><a href="projects-funded-by-the-afd.html#cb31-42" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-43"><a href="projects-funded-by-the-afd.html#cb31-43" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-44"><a href="projects-funded-by-the-afd.html#cb31-44" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-45"><a href="projects-funded-by-the-afd.html#cb31-45" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb31-46"><a href="projects-funded-by-the-afd.html#cb31-46" tabindex="-1"></a>hist_distrib_ctry_top_n_shr</span>
<span id="cb31-47"><a href="projects-funded-by-the-afd.html#cb31-47" tabindex="-1"></a></span>
<span id="cb31-48"><a href="projects-funded-by-the-afd.html#cb31-48" tabindex="-1"></a><span class="do">##Area of PAs</span></span>
<span id="cb31-49"><a href="projects-funded-by-the-afd.html#cb31-49" tabindex="-1"></a>hist_distrib_ctry_top_area_shr <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_top_area, </span>
<span id="cb31-50"><a href="projects-funded-by-the-afd.html#cb31-50" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country_en, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb31-51"><a href="projects-funded-by-the-afd.html#cb31-51" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-52"><a href="projects-funded-by-the-afd.html#cb31-52" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb31-53"><a href="projects-funded-by-the-afd.html#cb31-53" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb31-54"><a href="projects-funded-by-the-afd.html#cb31-54" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb31-55"><a href="projects-funded-by-the-afd.html#cb31-55" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Countries most targeted by AFD funded protected areas (area)&quot;</span>,</span>
<span id="cb31-56"><a href="projects-funded-by-the-afd.html#cb31-56" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb31-57"><a href="projects-funded-by-the-afd.html#cb31-57" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb31-58"><a href="projects-funded-by-the-afd.html#cb31-58" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of area funded (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-59"><a href="projects-funded-by-the-afd.html#cb31-59" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb31-60"><a href="projects-funded-by-the-afd.html#cb31-60" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb31-61"><a href="projects-funded-by-the-afd.html#cb31-61" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb31-62"><a href="projects-funded-by-the-afd.html#cb31-62" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb31-63"><a href="projects-funded-by-the-afd.html#cb31-63" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb31-64"><a href="projects-funded-by-the-afd.html#cb31-64" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb31-65"><a href="projects-funded-by-the-afd.html#cb31-65" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-66"><a href="projects-funded-by-the-afd.html#cb31-66" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-67"><a href="projects-funded-by-the-afd.html#cb31-67" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-68"><a href="projects-funded-by-the-afd.html#cb31-68" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb31-69"><a href="projects-funded-by-the-afd.html#cb31-69" tabindex="-1"></a>hist_distrib_ctry_top_area_shr</span>
<span id="cb31-70"><a href="projects-funded-by-the-afd.html#cb31-70" tabindex="-1"></a></span>
<span id="cb31-71"><a href="projects-funded-by-the-afd.html#cb31-71" tabindex="-1"></a><span class="co">#Histogram for all countries</span></span>
<span id="cb31-72"><a href="projects-funded-by-the-afd.html#cb31-72" tabindex="-1"></a><span class="co">#Histogram in number</span></span>
<span id="cb31-73"><a href="projects-funded-by-the-afd.html#cb31-73" tabindex="-1"></a>hist_distrib_ctry_n_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;freq_n&quot;</span>), </span>
<span id="cb31-74"><a href="projects-funded-by-the-afd.html#cb31-74" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> iso3)) <span class="sc">%&gt;%</span></span>
<span id="cb31-75"><a href="projects-funded-by-the-afd.html#cb31-75" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-76"><a href="projects-funded-by-the-afd.html#cb31-76" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb31-77"><a href="projects-funded-by-the-afd.html#cb31-77" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb31-78"><a href="projects-funded-by-the-afd.html#cb31-78" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb31-79"><a href="projects-funded-by-the-afd.html#cb31-79" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of protected areas by country (#)&quot;</span>,</span>
<span id="cb31-80"><a href="projects-funded-by-the-afd.html#cb31-80" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb31-81"><a href="projects-funded-by-the-afd.html#cb31-81" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb31-82"><a href="projects-funded-by-the-afd.html#cb31-82" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-83"><a href="projects-funded-by-the-afd.html#cb31-83" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb31-84"><a href="projects-funded-by-the-afd.html#cb31-84" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb31-85"><a href="projects-funded-by-the-afd.html#cb31-85" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb31-86"><a href="projects-funded-by-the-afd.html#cb31-86" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb31-87"><a href="projects-funded-by-the-afd.html#cb31-87" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb31-88"><a href="projects-funded-by-the-afd.html#cb31-88" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb31-89"><a href="projects-funded-by-the-afd.html#cb31-89" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-90"><a href="projects-funded-by-the-afd.html#cb31-90" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-91"><a href="projects-funded-by-the-afd.html#cb31-91" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-92"><a href="projects-funded-by-the-afd.html#cb31-92" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb31-93"><a href="projects-funded-by-the-afd.html#cb31-93" tabindex="-1"></a>hist_distrib_ctry_n_shr</span>
<span id="cb31-94"><a href="projects-funded-by-the-afd.html#cb31-94" tabindex="-1"></a></span>
<span id="cb31-95"><a href="projects-funded-by-the-afd.html#cb31-95" tabindex="-1"></a><span class="co"># Histogram in surfaces</span></span>
<span id="cb31-96"><a href="projects-funded-by-the-afd.html#cb31-96" tabindex="-1"></a>hist_distrib_ctry_area_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;freq_area&quot;</span>), </span>
<span id="cb31-97"><a href="projects-funded-by-the-afd.html#cb31-97" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> iso3)) <span class="sc">%&gt;%</span></span>
<span id="cb31-98"><a href="projects-funded-by-the-afd.html#cb31-98" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-99"><a href="projects-funded-by-the-afd.html#cb31-99" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb31-100"><a href="projects-funded-by-the-afd.html#cb31-100" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb31-101"><a href="projects-funded-by-the-afd.html#cb31-101" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb31-102"><a href="projects-funded-by-the-afd.html#cb31-102" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of protected areas by country (area)&quot;</span>,</span>
<span id="cb31-103"><a href="projects-funded-by-the-afd.html#cb31-103" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb31-104"><a href="projects-funded-by-the-afd.html#cb31-104" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb31-105"><a href="projects-funded-by-the-afd.html#cb31-105" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of area funded (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-106"><a href="projects-funded-by-the-afd.html#cb31-106" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb31-107"><a href="projects-funded-by-the-afd.html#cb31-107" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb31-108"><a href="projects-funded-by-the-afd.html#cb31-108" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb31-109"><a href="projects-funded-by-the-afd.html#cb31-109" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb31-110"><a href="projects-funded-by-the-afd.html#cb31-110" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb31-111"><a href="projects-funded-by-the-afd.html#cb31-111" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb31-112"><a href="projects-funded-by-the-afd.html#cb31-112" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-113"><a href="projects-funded-by-the-afd.html#cb31-113" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-114"><a href="projects-funded-by-the-afd.html#cb31-114" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-115"><a href="projects-funded-by-the-afd.html#cb31-115" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb31-116"><a href="projects-funded-by-the-afd.html#cb31-116" tabindex="-1"></a>hist_distrib_ctry_area_shr</span>
<span id="cb31-117"><a href="projects-funded-by-the-afd.html#cb31-117" tabindex="-1"></a></span>
<span id="cb31-118"><a href="projects-funded-by-the-afd.html#cb31-118" tabindex="-1"></a><span class="do">## Both</span></span>
<span id="cb31-119"><a href="projects-funded-by-the-afd.html#cb31-119" tabindex="-1"></a>hist_distrib_ctry_top_both_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;freq_n&quot;</span>, <span class="st">&quot;freq_area&quot;</span>)), </span>
<span id="cb31-120"><a href="projects-funded-by-the-afd.html#cb31-120" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb31-121"><a href="projects-funded-by-the-afd.html#cb31-121" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-122"><a href="projects-funded-by-the-afd.html#cb31-122" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb31-123"><a href="projects-funded-by-the-afd.html#cb31-123" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb31-124"><a href="projects-funded-by-the-afd.html#cb31-124" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb31-125"><a href="projects-funded-by-the-afd.html#cb31-125" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of AFD funded protected areas by country&quot;</span>,</span>
<span id="cb31-126"><a href="projects-funded-by-the-afd.html#cb31-126" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb31-127"><a href="projects-funded-by-the-afd.html#cb31-127" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb31-128"><a href="projects-funded-by-the-afd.html#cb31-128" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-129"><a href="projects-funded-by-the-afd.html#cb31-129" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Area&quot;</span>, <span class="st">&quot;Number&quot;</span>),</span>
<span id="cb31-130"><a href="projects-funded-by-the-afd.html#cb31-130" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-131"><a href="projects-funded-by-the-afd.html#cb31-131" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb31-132"><a href="projects-funded-by-the-afd.html#cb31-132" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb31-133"><a href="projects-funded-by-the-afd.html#cb31-133" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb31-134"><a href="projects-funded-by-the-afd.html#cb31-134" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb31-135"><a href="projects-funded-by-the-afd.html#cb31-135" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb31-136"><a href="projects-funded-by-the-afd.html#cb31-136" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb31-137"><a href="projects-funded-by-the-afd.html#cb31-137" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-138"><a href="projects-funded-by-the-afd.html#cb31-138" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-139"><a href="projects-funded-by-the-afd.html#cb31-139" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb31-140"><a href="projects-funded-by-the-afd.html#cb31-140" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb31-141"><a href="projects-funded-by-the-afd.html#cb31-141" tabindex="-1"></a>hist_distrib_ctry_top_both_shr</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="projects-funded-by-the-afd.html#cb32-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb32-2"><a href="projects-funded-by-the-afd.html#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="projects-funded-by-the-afd.html#cb32-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb32-4"><a href="projects-funded-by-the-afd.html#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="projects-funded-by-the-afd.html#cb32-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_top_n_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb32-6"><a href="projects-funded-by-the-afd.html#cb32-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_n_shr,</span>
<span id="cb32-7"><a href="projects-funded-by-the-afd.html#cb32-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb32-8"><a href="projects-funded-by-the-afd.html#cb32-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb32-9"><a href="projects-funded-by-the-afd.html#cb32-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_top_area_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb32-10"><a href="projects-funded-by-the-afd.html#cb32-10" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_area_shr,</span>
<span id="cb32-11"><a href="projects-funded-by-the-afd.html#cb32-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb32-12"><a href="projects-funded-by-the-afd.html#cb32-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb32-13"><a href="projects-funded-by-the-afd.html#cb32-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_n_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb32-14"><a href="projects-funded-by-the-afd.html#cb32-14" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_n_shr,</span>
<span id="cb32-15"><a href="projects-funded-by-the-afd.html#cb32-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb32-16"><a href="projects-funded-by-the-afd.html#cb32-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb32-17"><a href="projects-funded-by-the-afd.html#cb32-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_area_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb32-18"><a href="projects-funded-by-the-afd.html#cb32-18" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_area_shr,</span>
<span id="cb32-19"><a href="projects-funded-by-the-afd.html#cb32-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb32-20"><a href="projects-funded-by-the-afd.html#cb32-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb32-21"><a href="projects-funded-by-the-afd.html#cb32-21" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_top_both_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb32-22"><a href="projects-funded-by-the-afd.html#cb32-22" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_both_shr,</span>
<span id="cb32-23"><a href="projects-funded-by-the-afd.html#cb32-23" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb32-24"><a href="projects-funded-by-the-afd.html#cb32-24" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb32-25"><a href="projects-funded-by-the-afd.html#cb32-25" tabindex="-1"></a></span>
<span id="cb32-26"><a href="projects-funded-by-the-afd.html#cb32-26" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb32-27"><a href="projects-funded-by-the-afd.html#cb32-27" tabindex="-1"></a></span>
<span id="cb32-28"><a href="projects-funded-by-the-afd.html#cb32-28" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb32-29"><a href="projects-funded-by-the-afd.html#cb32-29" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-30"><a href="projects-funded-by-the-afd.html#cb32-30" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb32-31"><a href="projects-funded-by-the-afd.html#cb32-31" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb32-32"><a href="projects-funded-by-the-afd.html#cb32-32" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb32-33"><a href="projects-funded-by-the-afd.html#cb32-33" tabindex="-1"></a>{</span>
<span id="cb32-34"><a href="projects-funded-by-the-afd.html#cb32-34" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb32-35"><a href="projects-funded-by-the-afd.html#cb32-35" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb32-36"><a href="projects-funded-by-the-afd.html#cb32-36" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb32-37"><a href="projects-funded-by-the-afd.html#cb32-37" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/distribution/world/all&quot;</span>, </span>
<span id="cb32-38"><a href="projects-funded-by-the-afd.html#cb32-38" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-39"><a href="projects-funded-by-the-afd.html#cb32-39" tabindex="-1"></a>  }</span>
<span id="cb32-40"><a href="projects-funded-by-the-afd.html#cb32-40" tabindex="-1"></a></span>
<span id="cb32-41"><a href="projects-funded-by-the-afd.html#cb32-41" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb32-42"><a href="projects-funded-by-the-afd.html#cb32-42" tabindex="-1"></a></span>
<span id="cb32-43"><a href="projects-funded-by-the-afd.html#cb32-43" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="statistics-at-country-level-non-marine" class="section level4 hasAnchor" number="2.3.3.2">
<h4><span class="header-section-number">2.3.3.2</span> Statistics at country level (non-marine)<a href="projects-funded-by-the-afd.html#statistics-at-country-level-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Non-marine PAs across the world.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="projects-funded-by-the-afd.html#cb33-1" tabindex="-1"></a><span class="co">#Surface and number of PAs by country</span></span>
<span id="cb33-2"><a href="projects-funded-by-the-afd.html#cb33-2" tabindex="-1"></a>data_distrib_ctry <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="projects-funded-by-the-afd.html#cb33-3" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="projects-funded-by-the-afd.html#cb33-4" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3, country_en, country_fr) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="projects-funded-by-the-afd.html#cb33-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb33-6"><a href="projects-funded-by-the-afd.html#cb33-6" tabindex="-1"></a>            <span class="at">area_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="projects-funded-by-the-afd.html#cb33-7" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="projects-funded-by-the-afd.html#cb33-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-9"><a href="projects-funded-by-the-afd.html#cb33-9" tabindex="-1"></a>         <span class="at">area_tot_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-10"><a href="projects-funded-by-the-afd.html#cb33-10" tabindex="-1"></a>         <span class="at">freq_n =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb33-11"><a href="projects-funded-by-the-afd.html#cb33-11" tabindex="-1"></a>         <span class="at">freq_area =</span> <span class="fu">round</span>(area_km2<span class="sc">/</span>area_tot_km2<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href="projects-funded-by-the-afd.html#cb33-12" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;freq_n&quot;</span>, <span class="st">&quot;area_km2&quot;</span>, <span class="st">&quot;freq_area&quot;</span>),</span>
<span id="cb33-13"><a href="projects-funded-by-the-afd.html#cb33-13" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>)</span>
<span id="cb33-14"><a href="projects-funded-by-the-afd.html#cb33-14" tabindex="-1"></a></span>
<span id="cb33-15"><a href="projects-funded-by-the-afd.html#cb33-15" tabindex="-1"></a><span class="co">#Top targeted countries in terms of number/surface of PAs</span></span>
<span id="cb33-16"><a href="projects-funded-by-the-afd.html#cb33-16" tabindex="-1"></a>data_distrib_ctry_top_n <span class="ot">=</span> data_distrib_ctry <span class="sc">%&gt;%</span></span>
<span id="cb33-17"><a href="projects-funded-by-the-afd.html#cb33-17" tabindex="-1"></a>  <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">&quot;freq_n&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-18"><a href="projects-funded-by-the-afd.html#cb33-18" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>value) <span class="sc">%&gt;%</span></span>
<span id="cb33-19"><a href="projects-funded-by-the-afd.html#cb33-19" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb33-20"><a href="projects-funded-by-the-afd.html#cb33-20" tabindex="-1"></a>data_distrib_ctry_top_area <span class="ot">=</span> data_distrib_ctry <span class="sc">%&gt;%</span></span>
<span id="cb33-21"><a href="projects-funded-by-the-afd.html#cb33-21" tabindex="-1"></a>  <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">&quot;freq_area&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-22"><a href="projects-funded-by-the-afd.html#cb33-22" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>value) <span class="sc">%&gt;%</span></span>
<span id="cb33-23"><a href="projects-funded-by-the-afd.html#cb33-23" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb33-24"><a href="projects-funded-by-the-afd.html#cb33-24" tabindex="-1"></a></span>
<span id="cb33-25"><a href="projects-funded-by-the-afd.html#cb33-25" tabindex="-1"></a><span class="co">#Histogram in share (in French) for top countries</span></span>
<span id="cb33-26"><a href="projects-funded-by-the-afd.html#cb33-26" tabindex="-1"></a><span class="do">##Number of PAs</span></span>
<span id="cb33-27"><a href="projects-funded-by-the-afd.html#cb33-27" tabindex="-1"></a>hist_distrib_ctry_top_n_shr <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_top_n, </span>
<span id="cb33-28"><a href="projects-funded-by-the-afd.html#cb33-28" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country_en, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb33-29"><a href="projects-funded-by-the-afd.html#cb33-29" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-30"><a href="projects-funded-by-the-afd.html#cb33-30" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb33-31"><a href="projects-funded-by-the-afd.html#cb33-31" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb33-32"><a href="projects-funded-by-the-afd.html#cb33-32" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb33-33"><a href="projects-funded-by-the-afd.html#cb33-33" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Countries most targeted by AFD funded, non-marine protected areas (#)&quot;</span>,</span>
<span id="cb33-34"><a href="projects-funded-by-the-afd.html#cb33-34" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb33-35"><a href="projects-funded-by-the-afd.html#cb33-35" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb33-36"><a href="projects-funded-by-the-afd.html#cb33-36" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-37"><a href="projects-funded-by-the-afd.html#cb33-37" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb33-38"><a href="projects-funded-by-the-afd.html#cb33-38" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb33-39"><a href="projects-funded-by-the-afd.html#cb33-39" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb33-40"><a href="projects-funded-by-the-afd.html#cb33-40" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb33-41"><a href="projects-funded-by-the-afd.html#cb33-41" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb33-42"><a href="projects-funded-by-the-afd.html#cb33-42" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb33-43"><a href="projects-funded-by-the-afd.html#cb33-43" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-44"><a href="projects-funded-by-the-afd.html#cb33-44" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-45"><a href="projects-funded-by-the-afd.html#cb33-45" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-46"><a href="projects-funded-by-the-afd.html#cb33-46" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb33-47"><a href="projects-funded-by-the-afd.html#cb33-47" tabindex="-1"></a>hist_distrib_ctry_top_n_shr</span>
<span id="cb33-48"><a href="projects-funded-by-the-afd.html#cb33-48" tabindex="-1"></a></span>
<span id="cb33-49"><a href="projects-funded-by-the-afd.html#cb33-49" tabindex="-1"></a><span class="do">##Area of PAs</span></span>
<span id="cb33-50"><a href="projects-funded-by-the-afd.html#cb33-50" tabindex="-1"></a>hist_distrib_ctry_top_area_shr <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_top_area, </span>
<span id="cb33-51"><a href="projects-funded-by-the-afd.html#cb33-51" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country_en, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb33-52"><a href="projects-funded-by-the-afd.html#cb33-52" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-53"><a href="projects-funded-by-the-afd.html#cb33-53" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb33-54"><a href="projects-funded-by-the-afd.html#cb33-54" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb33-55"><a href="projects-funded-by-the-afd.html#cb33-55" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb33-56"><a href="projects-funded-by-the-afd.html#cb33-56" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Countries most targeted by AFD funded, non-marine protected areas (area)&quot;</span>,</span>
<span id="cb33-57"><a href="projects-funded-by-the-afd.html#cb33-57" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb33-58"><a href="projects-funded-by-the-afd.html#cb33-58" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb33-59"><a href="projects-funded-by-the-afd.html#cb33-59" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of area funded (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-60"><a href="projects-funded-by-the-afd.html#cb33-60" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb33-61"><a href="projects-funded-by-the-afd.html#cb33-61" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb33-62"><a href="projects-funded-by-the-afd.html#cb33-62" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb33-63"><a href="projects-funded-by-the-afd.html#cb33-63" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb33-64"><a href="projects-funded-by-the-afd.html#cb33-64" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb33-65"><a href="projects-funded-by-the-afd.html#cb33-65" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb33-66"><a href="projects-funded-by-the-afd.html#cb33-66" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-67"><a href="projects-funded-by-the-afd.html#cb33-67" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-68"><a href="projects-funded-by-the-afd.html#cb33-68" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-69"><a href="projects-funded-by-the-afd.html#cb33-69" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb33-70"><a href="projects-funded-by-the-afd.html#cb33-70" tabindex="-1"></a>hist_distrib_ctry_top_area_shr</span>
<span id="cb33-71"><a href="projects-funded-by-the-afd.html#cb33-71" tabindex="-1"></a></span>
<span id="cb33-72"><a href="projects-funded-by-the-afd.html#cb33-72" tabindex="-1"></a><span class="co">#Histogram for all countries</span></span>
<span id="cb33-73"><a href="projects-funded-by-the-afd.html#cb33-73" tabindex="-1"></a><span class="co">#Histogram in number</span></span>
<span id="cb33-74"><a href="projects-funded-by-the-afd.html#cb33-74" tabindex="-1"></a>hist_distrib_ctry_n_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;freq_n&quot;</span>), </span>
<span id="cb33-75"><a href="projects-funded-by-the-afd.html#cb33-75" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> iso3)) <span class="sc">%&gt;%</span></span>
<span id="cb33-76"><a href="projects-funded-by-the-afd.html#cb33-76" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-77"><a href="projects-funded-by-the-afd.html#cb33-77" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb33-78"><a href="projects-funded-by-the-afd.html#cb33-78" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb33-79"><a href="projects-funded-by-the-afd.html#cb33-79" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb33-80"><a href="projects-funded-by-the-afd.html#cb33-80" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of AFD funded, non-marine protected areas by country (#)&quot;</span>,</span>
<span id="cb33-81"><a href="projects-funded-by-the-afd.html#cb33-81" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb33-82"><a href="projects-funded-by-the-afd.html#cb33-82" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb33-83"><a href="projects-funded-by-the-afd.html#cb33-83" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-84"><a href="projects-funded-by-the-afd.html#cb33-84" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb33-85"><a href="projects-funded-by-the-afd.html#cb33-85" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb33-86"><a href="projects-funded-by-the-afd.html#cb33-86" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb33-87"><a href="projects-funded-by-the-afd.html#cb33-87" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb33-88"><a href="projects-funded-by-the-afd.html#cb33-88" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb33-89"><a href="projects-funded-by-the-afd.html#cb33-89" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb33-90"><a href="projects-funded-by-the-afd.html#cb33-90" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-91"><a href="projects-funded-by-the-afd.html#cb33-91" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-92"><a href="projects-funded-by-the-afd.html#cb33-92" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-93"><a href="projects-funded-by-the-afd.html#cb33-93" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb33-94"><a href="projects-funded-by-the-afd.html#cb33-94" tabindex="-1"></a>hist_distrib_ctry_n_shr</span>
<span id="cb33-95"><a href="projects-funded-by-the-afd.html#cb33-95" tabindex="-1"></a><span class="co"># Histogram in surfaces</span></span>
<span id="cb33-96"><a href="projects-funded-by-the-afd.html#cb33-96" tabindex="-1"></a>hist_distrib_ctry_area_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;freq_area&quot;</span>), </span>
<span id="cb33-97"><a href="projects-funded-by-the-afd.html#cb33-97" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> iso3)) <span class="sc">%&gt;%</span></span>
<span id="cb33-98"><a href="projects-funded-by-the-afd.html#cb33-98" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-99"><a href="projects-funded-by-the-afd.html#cb33-99" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb33-100"><a href="projects-funded-by-the-afd.html#cb33-100" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb33-101"><a href="projects-funded-by-the-afd.html#cb33-101" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb33-102"><a href="projects-funded-by-the-afd.html#cb33-102" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of AFD funded, non-marine protected areas by country (area)&quot;</span>,</span>
<span id="cb33-103"><a href="projects-funded-by-the-afd.html#cb33-103" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb33-104"><a href="projects-funded-by-the-afd.html#cb33-104" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Countries&quot;</span>,</span>
<span id="cb33-105"><a href="projects-funded-by-the-afd.html#cb33-105" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of area funded (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-106"><a href="projects-funded-by-the-afd.html#cb33-106" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb33-107"><a href="projects-funded-by-the-afd.html#cb33-107" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb33-108"><a href="projects-funded-by-the-afd.html#cb33-108" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb33-109"><a href="projects-funded-by-the-afd.html#cb33-109" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb33-110"><a href="projects-funded-by-the-afd.html#cb33-110" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb33-111"><a href="projects-funded-by-the-afd.html#cb33-111" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb33-112"><a href="projects-funded-by-the-afd.html#cb33-112" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-113"><a href="projects-funded-by-the-afd.html#cb33-113" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-114"><a href="projects-funded-by-the-afd.html#cb33-114" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-115"><a href="projects-funded-by-the-afd.html#cb33-115" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb33-116"><a href="projects-funded-by-the-afd.html#cb33-116" tabindex="-1"></a>hist_distrib_ctry_area_shr</span>
<span id="cb33-117"><a href="projects-funded-by-the-afd.html#cb33-117" tabindex="-1"></a></span>
<span id="cb33-118"><a href="projects-funded-by-the-afd.html#cb33-118" tabindex="-1"></a><span class="do">## Both</span></span>
<span id="cb33-119"><a href="projects-funded-by-the-afd.html#cb33-119" tabindex="-1"></a>hist_distrib_ctry_top_both_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;freq_area&quot;</span>, <span class="st">&quot;freq_n&quot;</span>)), </span>
<span id="cb33-120"><a href="projects-funded-by-the-afd.html#cb33-120" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb33-121"><a href="projects-funded-by-the-afd.html#cb33-121" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-122"><a href="projects-funded-by-the-afd.html#cb33-122" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb33-123"><a href="projects-funded-by-the-afd.html#cb33-123" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb33-124"><a href="projects-funded-by-the-afd.html#cb33-124" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb33-125"><a href="projects-funded-by-the-afd.html#cb33-125" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of AFD funded, non-marine protected areas by country&quot;</span>,</span>
<span id="cb33-126"><a href="projects-funded-by-the-afd.html#cb33-126" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb33-127"><a href="projects-funded-by-the-afd.html#cb33-127" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb33-128"><a href="projects-funded-by-the-afd.html#cb33-128" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-129"><a href="projects-funded-by-the-afd.html#cb33-129" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Area&quot;</span>, <span class="st">&quot;Number&quot;</span>),</span>
<span id="cb33-130"><a href="projects-funded-by-the-afd.html#cb33-130" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-131"><a href="projects-funded-by-the-afd.html#cb33-131" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb33-132"><a href="projects-funded-by-the-afd.html#cb33-132" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb33-133"><a href="projects-funded-by-the-afd.html#cb33-133" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb33-134"><a href="projects-funded-by-the-afd.html#cb33-134" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb33-135"><a href="projects-funded-by-the-afd.html#cb33-135" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb33-136"><a href="projects-funded-by-the-afd.html#cb33-136" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb33-137"><a href="projects-funded-by-the-afd.html#cb33-137" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-138"><a href="projects-funded-by-the-afd.html#cb33-138" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-139"><a href="projects-funded-by-the-afd.html#cb33-139" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb33-140"><a href="projects-funded-by-the-afd.html#cb33-140" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb33-141"><a href="projects-funded-by-the-afd.html#cb33-141" tabindex="-1"></a>hist_distrib_ctry_top_both_shr</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="projects-funded-by-the-afd.html#cb34-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb34-2"><a href="projects-funded-by-the-afd.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="projects-funded-by-the-afd.html#cb34-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb34-4"><a href="projects-funded-by-the-afd.html#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="projects-funded-by-the-afd.html#cb34-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_top_n_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb34-6"><a href="projects-funded-by-the-afd.html#cb34-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_n_shr,</span>
<span id="cb34-7"><a href="projects-funded-by-the-afd.html#cb34-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb34-8"><a href="projects-funded-by-the-afd.html#cb34-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb34-9"><a href="projects-funded-by-the-afd.html#cb34-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_top_area_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb34-10"><a href="projects-funded-by-the-afd.html#cb34-10" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_area_shr,</span>
<span id="cb34-11"><a href="projects-funded-by-the-afd.html#cb34-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb34-12"><a href="projects-funded-by-the-afd.html#cb34-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb34-13"><a href="projects-funded-by-the-afd.html#cb34-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_n_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb34-14"><a href="projects-funded-by-the-afd.html#cb34-14" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_n_shr,</span>
<span id="cb34-15"><a href="projects-funded-by-the-afd.html#cb34-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb34-16"><a href="projects-funded-by-the-afd.html#cb34-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb34-17"><a href="projects-funded-by-the-afd.html#cb34-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_area_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb34-18"><a href="projects-funded-by-the-afd.html#cb34-18" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_area_shr,</span>
<span id="cb34-19"><a href="projects-funded-by-the-afd.html#cb34-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb34-20"><a href="projects-funded-by-the-afd.html#cb34-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb34-21"><a href="projects-funded-by-the-afd.html#cb34-21" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_top_both_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb34-22"><a href="projects-funded-by-the-afd.html#cb34-22" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_both_shr,</span>
<span id="cb34-23"><a href="projects-funded-by-the-afd.html#cb34-23" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb34-24"><a href="projects-funded-by-the-afd.html#cb34-24" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb34-25"><a href="projects-funded-by-the-afd.html#cb34-25" tabindex="-1"></a></span>
<span id="cb34-26"><a href="projects-funded-by-the-afd.html#cb34-26" tabindex="-1"></a></span>
<span id="cb34-27"><a href="projects-funded-by-the-afd.html#cb34-27" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb34-28"><a href="projects-funded-by-the-afd.html#cb34-28" tabindex="-1"></a></span>
<span id="cb34-29"><a href="projects-funded-by-the-afd.html#cb34-29" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb34-30"><a href="projects-funded-by-the-afd.html#cb34-30" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-31"><a href="projects-funded-by-the-afd.html#cb34-31" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb34-32"><a href="projects-funded-by-the-afd.html#cb34-32" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb34-33"><a href="projects-funded-by-the-afd.html#cb34-33" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb34-34"><a href="projects-funded-by-the-afd.html#cb34-34" tabindex="-1"></a>{</span>
<span id="cb34-35"><a href="projects-funded-by-the-afd.html#cb34-35" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb34-36"><a href="projects-funded-by-the-afd.html#cb34-36" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb34-37"><a href="projects-funded-by-the-afd.html#cb34-37" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb34-38"><a href="projects-funded-by-the-afd.html#cb34-38" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/distribution/world/no_marine&quot;</span>, </span>
<span id="cb34-39"><a href="projects-funded-by-the-afd.html#cb34-39" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-40"><a href="projects-funded-by-the-afd.html#cb34-40" tabindex="-1"></a>  }</span>
<span id="cb34-41"><a href="projects-funded-by-the-afd.html#cb34-41" tabindex="-1"></a></span>
<span id="cb34-42"><a href="projects-funded-by-the-afd.html#cb34-42" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb34-43"><a href="projects-funded-by-the-afd.html#cb34-43" tabindex="-1"></a></span>
<span id="cb34-44"><a href="projects-funded-by-the-afd.html#cb34-44" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="statistics-at-country-level-region-non-marine" class="section level4 hasAnchor" number="2.3.3.3">
<h4><span class="header-section-number">2.3.3.3</span> Statistics at country level (region, non-marine)<a href="projects-funded-by-the-afd.html#statistics-at-country-level-region-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Non-marine PAs in a given region.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="projects-funded-by-the-afd.html#cb35-1" tabindex="-1"></a>roi <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span></span>
<span id="cb35-2"><a href="projects-funded-by-the-afd.html#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="projects-funded-by-the-afd.html#cb35-3" tabindex="-1"></a><span class="co">#Surface and number of PAs by country</span></span>
<span id="cb35-4"><a href="projects-funded-by-the-afd.html#cb35-4" tabindex="-1"></a>data_distrib_ctry <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="projects-funded-by-the-afd.html#cb35-5" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> roi <span class="sc">&amp;</span> marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="projects-funded-by-the-afd.html#cb35-6" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3, country_en, country_fr) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="projects-funded-by-the-afd.html#cb35-7" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb35-8"><a href="projects-funded-by-the-afd.html#cb35-8" tabindex="-1"></a>            <span class="at">area_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="projects-funded-by-the-afd.html#cb35-9" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="projects-funded-by-the-afd.html#cb35-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-11"><a href="projects-funded-by-the-afd.html#cb35-11" tabindex="-1"></a>         <span class="at">area_tot_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-12"><a href="projects-funded-by-the-afd.html#cb35-12" tabindex="-1"></a>         <span class="at">freq_n =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb35-13"><a href="projects-funded-by-the-afd.html#cb35-13" tabindex="-1"></a>         <span class="at">freq_area =</span> <span class="fu">round</span>(area_km2<span class="sc">/</span>area_tot_km2<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="projects-funded-by-the-afd.html#cb35-14" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;freq_n&quot;</span>, <span class="st">&quot;area_km2&quot;</span>, <span class="st">&quot;freq_area&quot;</span>),</span>
<span id="cb35-15"><a href="projects-funded-by-the-afd.html#cb35-15" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>)</span>
<span id="cb35-16"><a href="projects-funded-by-the-afd.html#cb35-16" tabindex="-1"></a></span>
<span id="cb35-17"><a href="projects-funded-by-the-afd.html#cb35-17" tabindex="-1"></a><span class="co">#Top targeted countries in terms of number/surface of PAs</span></span>
<span id="cb35-18"><a href="projects-funded-by-the-afd.html#cb35-18" tabindex="-1"></a>data_distrib_ctry_top_n <span class="ot">=</span> data_distrib_ctry <span class="sc">%&gt;%</span></span>
<span id="cb35-19"><a href="projects-funded-by-the-afd.html#cb35-19" tabindex="-1"></a>  <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">&quot;freq_n&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-20"><a href="projects-funded-by-the-afd.html#cb35-20" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>value) <span class="sc">%&gt;%</span></span>
<span id="cb35-21"><a href="projects-funded-by-the-afd.html#cb35-21" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb35-22"><a href="projects-funded-by-the-afd.html#cb35-22" tabindex="-1"></a>data_distrib_ctry_top_area <span class="ot">=</span> data_distrib_ctry <span class="sc">%&gt;%</span></span>
<span id="cb35-23"><a href="projects-funded-by-the-afd.html#cb35-23" tabindex="-1"></a>  <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="st">&quot;freq_area&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="projects-funded-by-the-afd.html#cb35-24" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>value) <span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="projects-funded-by-the-afd.html#cb35-25" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb35-26"><a href="projects-funded-by-the-afd.html#cb35-26" tabindex="-1"></a></span>
<span id="cb35-27"><a href="projects-funded-by-the-afd.html#cb35-27" tabindex="-1"></a><span class="co">#Histogram in share (in French) for top countries</span></span>
<span id="cb35-28"><a href="projects-funded-by-the-afd.html#cb35-28" tabindex="-1"></a><span class="do">##Number of PAs</span></span>
<span id="cb35-29"><a href="projects-funded-by-the-afd.html#cb35-29" tabindex="-1"></a>hist_distrib_ctry_top_n_shr <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_top_n, </span>
<span id="cb35-30"><a href="projects-funded-by-the-afd.html#cb35-30" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country_en, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb35-31"><a href="projects-funded-by-the-afd.html#cb35-31" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-32"><a href="projects-funded-by-the-afd.html#cb35-32" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb35-33"><a href="projects-funded-by-the-afd.html#cb35-33" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb35-34"><a href="projects-funded-by-the-afd.html#cb35-34" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb35-35"><a href="projects-funded-by-the-afd.html#cb35-35" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Countries most targeted by AFD funded, non-marine protected areas (#) </span><span class="sc">\n</span><span class="st">&quot;</span>, roi),</span>
<span id="cb35-36"><a href="projects-funded-by-the-afd.html#cb35-36" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb35-37"><a href="projects-funded-by-the-afd.html#cb35-37" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb35-38"><a href="projects-funded-by-the-afd.html#cb35-38" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-39"><a href="projects-funded-by-the-afd.html#cb35-39" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb35-40"><a href="projects-funded-by-the-afd.html#cb35-40" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb35-41"><a href="projects-funded-by-the-afd.html#cb35-41" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb35-42"><a href="projects-funded-by-the-afd.html#cb35-42" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb35-43"><a href="projects-funded-by-the-afd.html#cb35-43" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb35-44"><a href="projects-funded-by-the-afd.html#cb35-44" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb35-45"><a href="projects-funded-by-the-afd.html#cb35-45" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-46"><a href="projects-funded-by-the-afd.html#cb35-46" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-47"><a href="projects-funded-by-the-afd.html#cb35-47" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-48"><a href="projects-funded-by-the-afd.html#cb35-48" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb35-49"><a href="projects-funded-by-the-afd.html#cb35-49" tabindex="-1"></a>hist_distrib_ctry_top_n_shr</span>
<span id="cb35-50"><a href="projects-funded-by-the-afd.html#cb35-50" tabindex="-1"></a></span>
<span id="cb35-51"><a href="projects-funded-by-the-afd.html#cb35-51" tabindex="-1"></a><span class="do">##Area of PAs</span></span>
<span id="cb35-52"><a href="projects-funded-by-the-afd.html#cb35-52" tabindex="-1"></a>hist_distrib_ctry_top_area_shr <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_top_area, </span>
<span id="cb35-53"><a href="projects-funded-by-the-afd.html#cb35-53" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country_en, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb35-54"><a href="projects-funded-by-the-afd.html#cb35-54" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-55"><a href="projects-funded-by-the-afd.html#cb35-55" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb35-56"><a href="projects-funded-by-the-afd.html#cb35-56" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb35-57"><a href="projects-funded-by-the-afd.html#cb35-57" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb35-58"><a href="projects-funded-by-the-afd.html#cb35-58" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Countries most targeted by AFD funded, non-marine protected areas (area)</span><span class="sc">\n</span><span class="st">&quot;</span>, roi),</span>
<span id="cb35-59"><a href="projects-funded-by-the-afd.html#cb35-59" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb35-60"><a href="projects-funded-by-the-afd.html#cb35-60" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb35-61"><a href="projects-funded-by-the-afd.html#cb35-61" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of area funded (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-62"><a href="projects-funded-by-the-afd.html#cb35-62" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb35-63"><a href="projects-funded-by-the-afd.html#cb35-63" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb35-64"><a href="projects-funded-by-the-afd.html#cb35-64" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb35-65"><a href="projects-funded-by-the-afd.html#cb35-65" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb35-66"><a href="projects-funded-by-the-afd.html#cb35-66" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb35-67"><a href="projects-funded-by-the-afd.html#cb35-67" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb35-68"><a href="projects-funded-by-the-afd.html#cb35-68" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-69"><a href="projects-funded-by-the-afd.html#cb35-69" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-70"><a href="projects-funded-by-the-afd.html#cb35-70" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-71"><a href="projects-funded-by-the-afd.html#cb35-71" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb35-72"><a href="projects-funded-by-the-afd.html#cb35-72" tabindex="-1"></a>hist_distrib_ctry_top_area_shr</span>
<span id="cb35-73"><a href="projects-funded-by-the-afd.html#cb35-73" tabindex="-1"></a></span>
<span id="cb35-74"><a href="projects-funded-by-the-afd.html#cb35-74" tabindex="-1"></a><span class="co">#Histogram for all countries</span></span>
<span id="cb35-75"><a href="projects-funded-by-the-afd.html#cb35-75" tabindex="-1"></a><span class="co">#Histogram in number</span></span>
<span id="cb35-76"><a href="projects-funded-by-the-afd.html#cb35-76" tabindex="-1"></a>hist_distrib_ctry_n_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;freq_n&quot;</span>), </span>
<span id="cb35-77"><a href="projects-funded-by-the-afd.html#cb35-77" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> iso3)) <span class="sc">%&gt;%</span></span>
<span id="cb35-78"><a href="projects-funded-by-the-afd.html#cb35-78" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-79"><a href="projects-funded-by-the-afd.html#cb35-79" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb35-80"><a href="projects-funded-by-the-afd.html#cb35-80" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb35-81"><a href="projects-funded-by-the-afd.html#cb35-81" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb35-82"><a href="projects-funded-by-the-afd.html#cb35-82" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Distribution of AFD funded, non-marine protected areas by country (#)</span><span class="sc">\n</span><span class="st">&quot;</span>, roi),</span>
<span id="cb35-83"><a href="projects-funded-by-the-afd.html#cb35-83" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb35-84"><a href="projects-funded-by-the-afd.html#cb35-84" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb35-85"><a href="projects-funded-by-the-afd.html#cb35-85" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-86"><a href="projects-funded-by-the-afd.html#cb35-86" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb35-87"><a href="projects-funded-by-the-afd.html#cb35-87" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb35-88"><a href="projects-funded-by-the-afd.html#cb35-88" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb35-89"><a href="projects-funded-by-the-afd.html#cb35-89" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb35-90"><a href="projects-funded-by-the-afd.html#cb35-90" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb35-91"><a href="projects-funded-by-the-afd.html#cb35-91" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb35-92"><a href="projects-funded-by-the-afd.html#cb35-92" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-93"><a href="projects-funded-by-the-afd.html#cb35-93" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-94"><a href="projects-funded-by-the-afd.html#cb35-94" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-95"><a href="projects-funded-by-the-afd.html#cb35-95" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb35-96"><a href="projects-funded-by-the-afd.html#cb35-96" tabindex="-1"></a>hist_distrib_ctry_n_shr</span>
<span id="cb35-97"><a href="projects-funded-by-the-afd.html#cb35-97" tabindex="-1"></a><span class="co"># Histogram in surfaces</span></span>
<span id="cb35-98"><a href="projects-funded-by-the-afd.html#cb35-98" tabindex="-1"></a>hist_distrib_ctry_area_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;freq_area&quot;</span>), </span>
<span id="cb35-99"><a href="projects-funded-by-the-afd.html#cb35-99" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> iso3)) <span class="sc">%&gt;%</span></span>
<span id="cb35-100"><a href="projects-funded-by-the-afd.html#cb35-100" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-101"><a href="projects-funded-by-the-afd.html#cb35-101" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb35-102"><a href="projects-funded-by-the-afd.html#cb35-102" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb35-103"><a href="projects-funded-by-the-afd.html#cb35-103" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb35-104"><a href="projects-funded-by-the-afd.html#cb35-104" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Distribution of AFD funded, non-marine protected areas by country (area)</span><span class="sc">\n</span><span class="st">&quot;</span>, roi),</span>
<span id="cb35-105"><a href="projects-funded-by-the-afd.html#cb35-105" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb35-106"><a href="projects-funded-by-the-afd.html#cb35-106" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb35-107"><a href="projects-funded-by-the-afd.html#cb35-107" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of area funded (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-108"><a href="projects-funded-by-the-afd.html#cb35-108" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb35-109"><a href="projects-funded-by-the-afd.html#cb35-109" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb35-110"><a href="projects-funded-by-the-afd.html#cb35-110" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb35-111"><a href="projects-funded-by-the-afd.html#cb35-111" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb35-112"><a href="projects-funded-by-the-afd.html#cb35-112" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb35-113"><a href="projects-funded-by-the-afd.html#cb35-113" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb35-114"><a href="projects-funded-by-the-afd.html#cb35-114" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-115"><a href="projects-funded-by-the-afd.html#cb35-115" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-116"><a href="projects-funded-by-the-afd.html#cb35-116" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-117"><a href="projects-funded-by-the-afd.html#cb35-117" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb35-118"><a href="projects-funded-by-the-afd.html#cb35-118" tabindex="-1"></a>hist_distrib_ctry_area_shr</span>
<span id="cb35-119"><a href="projects-funded-by-the-afd.html#cb35-119" tabindex="-1"></a></span>
<span id="cb35-120"><a href="projects-funded-by-the-afd.html#cb35-120" tabindex="-1"></a><span class="do">## Both</span></span>
<span id="cb35-121"><a href="projects-funded-by-the-afd.html#cb35-121" tabindex="-1"></a>hist_distrib_ctry_both_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;freq_area&quot;</span>, <span class="st">&quot;freq_n&quot;</span>)), </span>
<span id="cb35-122"><a href="projects-funded-by-the-afd.html#cb35-122" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb35-123"><a href="projects-funded-by-the-afd.html#cb35-123" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-124"><a href="projects-funded-by-the-afd.html#cb35-124" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb35-125"><a href="projects-funded-by-the-afd.html#cb35-125" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb35-126"><a href="projects-funded-by-the-afd.html#cb35-126" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb35-127"><a href="projects-funded-by-the-afd.html#cb35-127" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Distribution of AFD funded, non-marine protected areas by country</span><span class="sc">\n</span><span class="st">&quot;</span>, roi),</span>
<span id="cb35-128"><a href="projects-funded-by-the-afd.html#cb35-128" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_ctry, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb35-129"><a href="projects-funded-by-the-afd.html#cb35-129" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb35-130"><a href="projects-funded-by-the-afd.html#cb35-130" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-131"><a href="projects-funded-by-the-afd.html#cb35-131" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Area&quot;</span>, <span class="st">&quot;Number&quot;</span>),</span>
<span id="cb35-132"><a href="projects-funded-by-the-afd.html#cb35-132" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-133"><a href="projects-funded-by-the-afd.html#cb35-133" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb35-134"><a href="projects-funded-by-the-afd.html#cb35-134" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb35-135"><a href="projects-funded-by-the-afd.html#cb35-135" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb35-136"><a href="projects-funded-by-the-afd.html#cb35-136" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb35-137"><a href="projects-funded-by-the-afd.html#cb35-137" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb35-138"><a href="projects-funded-by-the-afd.html#cb35-138" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb35-139"><a href="projects-funded-by-the-afd.html#cb35-139" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-140"><a href="projects-funded-by-the-afd.html#cb35-140" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-141"><a href="projects-funded-by-the-afd.html#cb35-141" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb35-142"><a href="projects-funded-by-the-afd.html#cb35-142" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb35-143"><a href="projects-funded-by-the-afd.html#cb35-143" tabindex="-1"></a>hist_distrib_ctry_both_shr</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="projects-funded-by-the-afd.html#cb36-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb36-2"><a href="projects-funded-by-the-afd.html#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="projects-funded-by-the-afd.html#cb36-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb36-4"><a href="projects-funded-by-the-afd.html#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="projects-funded-by-the-afd.html#cb36-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_top_n_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb36-6"><a href="projects-funded-by-the-afd.html#cb36-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_n_shr,</span>
<span id="cb36-7"><a href="projects-funded-by-the-afd.html#cb36-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb36-8"><a href="projects-funded-by-the-afd.html#cb36-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb36-9"><a href="projects-funded-by-the-afd.html#cb36-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_top_area_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb36-10"><a href="projects-funded-by-the-afd.html#cb36-10" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_area_shr,</span>
<span id="cb36-11"><a href="projects-funded-by-the-afd.html#cb36-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb36-12"><a href="projects-funded-by-the-afd.html#cb36-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb36-13"><a href="projects-funded-by-the-afd.html#cb36-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_n_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb36-14"><a href="projects-funded-by-the-afd.html#cb36-14" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_n_shr,</span>
<span id="cb36-15"><a href="projects-funded-by-the-afd.html#cb36-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb36-16"><a href="projects-funded-by-the-afd.html#cb36-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb36-17"><a href="projects-funded-by-the-afd.html#cb36-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_area_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb36-18"><a href="projects-funded-by-the-afd.html#cb36-18" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_top_area_shr,</span>
<span id="cb36-19"><a href="projects-funded-by-the-afd.html#cb36-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb36-20"><a href="projects-funded-by-the-afd.html#cb36-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb36-21"><a href="projects-funded-by-the-afd.html#cb36-21" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_both_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb36-22"><a href="projects-funded-by-the-afd.html#cb36-22" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_both_shr,</span>
<span id="cb36-23"><a href="projects-funded-by-the-afd.html#cb36-23" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb36-24"><a href="projects-funded-by-the-afd.html#cb36-24" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb36-25"><a href="projects-funded-by-the-afd.html#cb36-25" tabindex="-1"></a></span>
<span id="cb36-26"><a href="projects-funded-by-the-afd.html#cb36-26" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb36-27"><a href="projects-funded-by-the-afd.html#cb36-27" tabindex="-1"></a></span>
<span id="cb36-28"><a href="projects-funded-by-the-afd.html#cb36-28" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb36-29"><a href="projects-funded-by-the-afd.html#cb36-29" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-30"><a href="projects-funded-by-the-afd.html#cb36-30" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb36-31"><a href="projects-funded-by-the-afd.html#cb36-31" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb36-32"><a href="projects-funded-by-the-afd.html#cb36-32" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb36-33"><a href="projects-funded-by-the-afd.html#cb36-33" tabindex="-1"></a>{</span>
<span id="cb36-34"><a href="projects-funded-by-the-afd.html#cb36-34" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb36-35"><a href="projects-funded-by-the-afd.html#cb36-35" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb36-36"><a href="projects-funded-by-the-afd.html#cb36-36" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb36-37"><a href="projects-funded-by-the-afd.html#cb36-37" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="fu">paste</span>(<span class="st">&quot;projet-afd-eva-ap/descriptive_stats/distribution&quot;</span>, roi, <span class="st">&quot;no_marine&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), </span>
<span id="cb36-38"><a href="projects-funded-by-the-afd.html#cb36-38" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-39"><a href="projects-funded-by-the-afd.html#cb36-39" tabindex="-1"></a>  }</span>
<span id="cb36-40"><a href="projects-funded-by-the-afd.html#cb36-40" tabindex="-1"></a></span>
<span id="cb36-41"><a href="projects-funded-by-the-afd.html#cb36-41" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb36-42"><a href="projects-funded-by-the-afd.html#cb36-42" tabindex="-1"></a></span>
<span id="cb36-43"><a href="projects-funded-by-the-afd.html#cb36-43" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="statistics-at-country-level-non-marine-wdpa-vs-afd" class="section level4 hasAnchor" number="2.3.3.4">
<h4><span class="header-section-number">2.3.3.4</span> Statistics at country level (non-marine, WDPA vs AFD)<a href="projects-funded-by-the-afd.html#statistics-at-country-level-non-marine-wdpa-vs-afd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="projects-funded-by-the-afd.html#cb37-1" tabindex="-1"></a><span class="co">#For AFD funded PAs</span></span>
<span id="cb37-2"><a href="projects-funded-by-the-afd.html#cb37-2" tabindex="-1"></a><span class="do">##Distribution across countries (all)</span></span>
<span id="cb37-3"><a href="projects-funded-by-the-afd.html#cb37-3" tabindex="-1"></a>data_distrib_ctry_afd <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="projects-funded-by-the-afd.html#cb37-4" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="projects-funded-by-the-afd.html#cb37-5" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3, country_en) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="projects-funded-by-the-afd.html#cb37-6" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_afd =</span> <span class="fu">n</span>(),</span>
<span id="cb37-7"><a href="projects-funded-by-the-afd.html#cb37-7" tabindex="-1"></a>            <span class="at">area_km2_afd =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="projects-funded-by-the-afd.html#cb37-8" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="projects-funded-by-the-afd.html#cb37-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot_afd =</span> <span class="fu">sum</span>(n_afd),</span>
<span id="cb37-10"><a href="projects-funded-by-the-afd.html#cb37-10" tabindex="-1"></a>         <span class="at">area_km2_afd_tot =</span> <span class="fu">sum</span>(area_km2_afd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-11"><a href="projects-funded-by-the-afd.html#cb37-11" tabindex="-1"></a>         <span class="at">freq_n_afd =</span> <span class="fu">round</span>(n_afd<span class="sc">/</span>n_tot_afd<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb37-12"><a href="projects-funded-by-the-afd.html#cb37-12" tabindex="-1"></a>         <span class="at">freq_area_afd =</span> <span class="fu">round</span>(area_km2_afd<span class="sc">/</span>area_km2_afd_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb37-13"><a href="projects-funded-by-the-afd.html#cb37-13" tabindex="-1"></a><span class="do">##Top 10 funded countries</span></span>
<span id="cb37-14"><a href="projects-funded-by-the-afd.html#cb37-14" tabindex="-1"></a><span class="do">###Number</span></span>
<span id="cb37-15"><a href="projects-funded-by-the-afd.html#cb37-15" tabindex="-1"></a>data_distrib_ctry_afd_top_n <span class="ot">=</span> data_distrib_ctry_afd <span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="projects-funded-by-the-afd.html#cb37-16" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq_n_afd) <span class="sc">%&gt;%</span></span>
<span id="cb37-17"><a href="projects-funded-by-the-afd.html#cb37-17" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb37-18"><a href="projects-funded-by-the-afd.html#cb37-18" tabindex="-1"></a><span class="do">###Surface</span></span>
<span id="cb37-19"><a href="projects-funded-by-the-afd.html#cb37-19" tabindex="-1"></a>data_distrib_ctry_afd_top_area <span class="ot">=</span> data_distrib_ctry_afd <span class="sc">%&gt;%</span></span>
<span id="cb37-20"><a href="projects-funded-by-the-afd.html#cb37-20" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq_area_afd) <span class="sc">%&gt;%</span></span>
<span id="cb37-21"><a href="projects-funded-by-the-afd.html#cb37-21" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb37-22"><a href="projects-funded-by-the-afd.html#cb37-22" tabindex="-1"></a></span>
<span id="cb37-23"><a href="projects-funded-by-the-afd.html#cb37-23" tabindex="-1"></a><span class="co">#For WDPA PAs</span></span>
<span id="cb37-24"><a href="projects-funded-by-the-afd.html#cb37-24" tabindex="-1"></a><span class="do">## All countries in the list of interest</span></span>
<span id="cb37-25"><a href="projects-funded-by-the-afd.html#cb37-25" tabindex="-1"></a>data_distrib_ctry_wdpa <span class="ot">=</span> data_wdpa <span class="sc">%&gt;%</span></span>
<span id="cb37-26"><a href="projects-funded-by-the-afd.html#cb37-26" tabindex="-1"></a>  <span class="co">#Non-marine areas only</span></span>
<span id="cb37-27"><a href="projects-funded-by-the-afd.html#cb37-27" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-28"><a href="projects-funded-by-the-afd.html#cb37-28" tabindex="-1"></a>  <span class="co">#Countries of interest only</span></span>
<span id="cb37-29"><a href="projects-funded-by-the-afd.html#cb37-29" tabindex="-1"></a>  <span class="fu">filter</span>(iso3 <span class="sc">%in%</span> lst_ctry_stat_wdpa) <span class="sc">%&gt;%</span></span>
<span id="cb37-30"><a href="projects-funded-by-the-afd.html#cb37-30" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3, country_en) <span class="sc">%&gt;%</span></span>
<span id="cb37-31"><a href="projects-funded-by-the-afd.html#cb37-31" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_wdpa =</span> <span class="fu">n</span>(),</span>
<span id="cb37-32"><a href="projects-funded-by-the-afd.html#cb37-32" tabindex="-1"></a>            <span class="at">area_km2_wdpa =</span> <span class="fu">sum</span>(rep_area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-33"><a href="projects-funded-by-the-afd.html#cb37-33" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-34"><a href="projects-funded-by-the-afd.html#cb37-34" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot_wdpa =</span> <span class="fu">sum</span>(n_wdpa),</span>
<span id="cb37-35"><a href="projects-funded-by-the-afd.html#cb37-35" tabindex="-1"></a>         <span class="at">area_km2_wdpa_tot =</span> <span class="fu">sum</span>(area_km2_wdpa, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-36"><a href="projects-funded-by-the-afd.html#cb37-36" tabindex="-1"></a>         <span class="at">freq_n_wdpa =</span> <span class="fu">round</span>(n_wdpa<span class="sc">/</span>n_tot_wdpa<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb37-37"><a href="projects-funded-by-the-afd.html#cb37-37" tabindex="-1"></a>         <span class="at">freq_area_wdpa =</span> <span class="fu">round</span>(area_km2_wdpa<span class="sc">/</span>area_km2_wdpa_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb37-38"><a href="projects-funded-by-the-afd.html#cb37-38" tabindex="-1"></a><span class="do">## Top 10 targeted countries</span></span>
<span id="cb37-39"><a href="projects-funded-by-the-afd.html#cb37-39" tabindex="-1"></a>data_distrib_ctry_wdpa_top_n <span class="ot">=</span> data_distrib_ctry_wdpa <span class="sc">%&gt;%</span></span>
<span id="cb37-40"><a href="projects-funded-by-the-afd.html#cb37-40" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq_n_wdpa) <span class="sc">%&gt;%</span></span>
<span id="cb37-41"><a href="projects-funded-by-the-afd.html#cb37-41" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb37-42"><a href="projects-funded-by-the-afd.html#cb37-42" tabindex="-1"></a>data_distrib_ctry_wdpa_top_area <span class="ot">=</span> data_distrib_ctry_wdpa <span class="sc">%&gt;%</span></span>
<span id="cb37-43"><a href="projects-funded-by-the-afd.html#cb37-43" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq_area_wdpa) <span class="sc">%&gt;%</span></span>
<span id="cb37-44"><a href="projects-funded-by-the-afd.html#cb37-44" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb37-45"><a href="projects-funded-by-the-afd.html#cb37-45" tabindex="-1"></a></span>
<span id="cb37-46"><a href="projects-funded-by-the-afd.html#cb37-46" tabindex="-1"></a><span class="co">#Then create a plotting dataset with WDPA vs AFD distribution</span></span>
<span id="cb37-47"><a href="projects-funded-by-the-afd.html#cb37-47" tabindex="-1"></a><span class="do">##the distribution for top targeted countries by AFD</span></span>
<span id="cb37-48"><a href="projects-funded-by-the-afd.html#cb37-48" tabindex="-1"></a><span class="do">### in terms of numbers</span></span>
<span id="cb37-49"><a href="projects-funded-by-the-afd.html#cb37-49" tabindex="-1"></a>data_distrib_ctry_vs_n <span class="ot">=</span> data_distrib_ctry_afd_top_n <span class="sc">%&gt;%</span></span>
<span id="cb37-50"><a href="projects-funded-by-the-afd.html#cb37-50" tabindex="-1"></a>  <span class="fu">left_join</span>(data_distrib_ctry_wdpa, <span class="fu">c</span>(<span class="st">&quot;iso3&quot;</span>, <span class="st">&quot;country_en&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-51"><a href="projects-funded-by-the-afd.html#cb37-51" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;area&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-52"><a href="projects-funded-by-the-afd.html#cb37-52" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;n_afd&quot;</span>, <span class="st">&quot;freq_n_afd&quot;</span>, <span class="st">&quot;n_wdpa&quot;</span>, <span class="st">&quot;freq_n_wdpa&quot;</span>),</span>
<span id="cb37-53"><a href="projects-funded-by-the-afd.html#cb37-53" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>) </span>
<span id="cb37-54"><a href="projects-funded-by-the-afd.html#cb37-54" tabindex="-1"></a><span class="do">###in terms of areas</span></span>
<span id="cb37-55"><a href="projects-funded-by-the-afd.html#cb37-55" tabindex="-1"></a>data_distrib_ctry_vs_area <span class="ot">=</span> data_distrib_ctry_afd_top_area <span class="sc">%&gt;%</span></span>
<span id="cb37-56"><a href="projects-funded-by-the-afd.html#cb37-56" tabindex="-1"></a>  <span class="fu">left_join</span>(data_distrib_ctry_wdpa, <span class="fu">c</span>(<span class="st">&quot;iso3&quot;</span>, <span class="st">&quot;country_en&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-57"><a href="projects-funded-by-the-afd.html#cb37-57" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;n_&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-58"><a href="projects-funded-by-the-afd.html#cb37-58" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;area_km2_afd&quot;</span>, <span class="st">&quot;freq_area_afd&quot;</span>, <span class="st">&quot;area_km2_wdpa&quot;</span>, <span class="st">&quot;freq_area_wdpa&quot;</span>),</span>
<span id="cb37-59"><a href="projects-funded-by-the-afd.html#cb37-59" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>) </span>
<span id="cb37-60"><a href="projects-funded-by-the-afd.html#cb37-60" tabindex="-1"></a></span>
<span id="cb37-61"><a href="projects-funded-by-the-afd.html#cb37-61" tabindex="-1"></a><span class="co">#Histogram in share for top countries</span></span>
<span id="cb37-62"><a href="projects-funded-by-the-afd.html#cb37-62" tabindex="-1"></a><span class="do">##For WDPA PAs</span></span>
<span id="cb37-63"><a href="projects-funded-by-the-afd.html#cb37-63" tabindex="-1"></a><span class="do">### number</span></span>
<span id="cb37-64"><a href="projects-funded-by-the-afd.html#cb37-64" tabindex="-1"></a>hist_distrib_ctry_wdpa_top_n <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_wdpa_top_n,</span>
<span id="cb37-65"><a href="projects-funded-by-the-afd.html#cb37-65" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>freq_n_wdpa), <span class="at">y =</span> freq_n_wdpa, <span class="at">fill =</span> freq_n_wdpa)) <span class="sc">%&gt;%</span></span>
<span id="cb37-66"><a href="projects-funded-by-the-afd.html#cb37-66" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-67"><a href="projects-funded-by-the-afd.html#cb37-67" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top countries of non-marine protected areas (#)&quot;</span>,</span>
<span id="cb37-68"><a href="projects-funded-by-the-afd.html#cb37-68" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">min</span>(data_distrib_ctry_wdpa<span class="sc">$</span>n_tot_wdpa), <span class="st">&quot;non-marine protected areas reported by the WDPA, covering&quot;</span>, <span class="fu">format</span>(<span class="fu">min</span>(data_distrib_ctry_wdpa<span class="sc">$</span>area_km2_wdpa_tot), <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb37-69"><a href="projects-funded-by-the-afd.html#cb37-69" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Note : we consider non-marine PAs reported by the WDPA on the full period covered by the data, in countries that are potential AFD partners.</span><span class="sc">\n</span><span class="st">These are low-, lower-middle, upper-middle countries according to the World Bank 2022 classification, </span><span class="sc">\n</span><span class="st">excluding Russia and including Uruguay, Panama, Chile, New Caledonia.</span><span class="sc">\n</span><span class="st">A subset of these PAs is AFD funded, though some PAs funded by the AFD are not reported by the WDPA.&quot;</span>,</span>
<span id="cb37-70"><a href="projects-funded-by-the-afd.html#cb37-70" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb37-71"><a href="projects-funded-by-the-afd.html#cb37-71" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-72"><a href="projects-funded-by-the-afd.html#cb37-72" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;AFD funded&quot;</span>, <span class="st">&quot;Low- to upper-middle income*&quot;</span>),</span>
<span id="cb37-73"><a href="projects-funded-by-the-afd.html#cb37-73" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-74"><a href="projects-funded-by-the-afd.html#cb37-74" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb37-75"><a href="projects-funded-by-the-afd.html#cb37-75" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb37-76"><a href="projects-funded-by-the-afd.html#cb37-76" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb37-77"><a href="projects-funded-by-the-afd.html#cb37-77" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb37-78"><a href="projects-funded-by-the-afd.html#cb37-78" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb37-79"><a href="projects-funded-by-the-afd.html#cb37-79" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb37-80"><a href="projects-funded-by-the-afd.html#cb37-80" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-81"><a href="projects-funded-by-the-afd.html#cb37-81" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-82"><a href="projects-funded-by-the-afd.html#cb37-82" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-83"><a href="projects-funded-by-the-afd.html#cb37-83" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb37-84"><a href="projects-funded-by-the-afd.html#cb37-84" tabindex="-1"></a>hist_distrib_ctry_wdpa_top_n </span>
<span id="cb37-85"><a href="projects-funded-by-the-afd.html#cb37-85" tabindex="-1"></a><span class="do">### Area</span></span>
<span id="cb37-86"><a href="projects-funded-by-the-afd.html#cb37-86" tabindex="-1"></a>hist_distrib_ctry_wdpa_top_area <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_wdpa_top_area,</span>
<span id="cb37-87"><a href="projects-funded-by-the-afd.html#cb37-87" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>freq_area_wdpa), <span class="at">y =</span> freq_area_wdpa, <span class="at">fill =</span> freq_area_wdpa)) <span class="sc">%&gt;%</span></span>
<span id="cb37-88"><a href="projects-funded-by-the-afd.html#cb37-88" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-89"><a href="projects-funded-by-the-afd.html#cb37-89" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top countries of non-marine protected areas (area)&quot;</span>,</span>
<span id="cb37-90"><a href="projects-funded-by-the-afd.html#cb37-90" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">min</span>(data_distrib_ctry_wdpa<span class="sc">$</span>n_tot_wdpa), <span class="st">&quot;non-marine protected areas reported by the WDPA, covering&quot;</span>, <span class="fu">format</span>(<span class="fu">min</span>(data_distrib_ctry_wdpa<span class="sc">$</span>area_km2_wdpa_tot), <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb37-91"><a href="projects-funded-by-the-afd.html#cb37-91" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Note : we consider non-marine PAs reported by the WDPA on the full period covered by the data, in countries that are potential AFD partners.</span><span class="sc">\n</span><span class="st">These are low-, lower-middle, upper-middle countries according to the World Bank 2022 classification, </span><span class="sc">\n</span><span class="st">excluding Russia and including Uruguay, Panama, Chile, New Caledonia.&quot;</span>,</span>
<span id="cb37-92"><a href="projects-funded-by-the-afd.html#cb37-92" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb37-93"><a href="projects-funded-by-the-afd.html#cb37-93" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-94"><a href="projects-funded-by-the-afd.html#cb37-94" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;AFD funded&quot;</span>, <span class="st">&quot;Low- to upper-middle income*&quot;</span>),</span>
<span id="cb37-95"><a href="projects-funded-by-the-afd.html#cb37-95" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-96"><a href="projects-funded-by-the-afd.html#cb37-96" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb37-97"><a href="projects-funded-by-the-afd.html#cb37-97" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb37-98"><a href="projects-funded-by-the-afd.html#cb37-98" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb37-99"><a href="projects-funded-by-the-afd.html#cb37-99" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb37-100"><a href="projects-funded-by-the-afd.html#cb37-100" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb37-101"><a href="projects-funded-by-the-afd.html#cb37-101" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb37-102"><a href="projects-funded-by-the-afd.html#cb37-102" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-103"><a href="projects-funded-by-the-afd.html#cb37-103" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-104"><a href="projects-funded-by-the-afd.html#cb37-104" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-105"><a href="projects-funded-by-the-afd.html#cb37-105" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb37-106"><a href="projects-funded-by-the-afd.html#cb37-106" tabindex="-1"></a>hist_distrib_ctry_wdpa_top_area</span>
<span id="cb37-107"><a href="projects-funded-by-the-afd.html#cb37-107" tabindex="-1"></a></span>
<span id="cb37-108"><a href="projects-funded-by-the-afd.html#cb37-108" tabindex="-1"></a><span class="do">##For AFD funded PAs</span></span>
<span id="cb37-109"><a href="projects-funded-by-the-afd.html#cb37-109" tabindex="-1"></a><span class="do">### number</span></span>
<span id="cb37-110"><a href="projects-funded-by-the-afd.html#cb37-110" tabindex="-1"></a>hist_distrib_ctry_afd_top_n <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_afd_top_n,</span>
<span id="cb37-111"><a href="projects-funded-by-the-afd.html#cb37-111" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>freq_n_afd), <span class="at">y =</span> freq_n_afd, <span class="at">fill =</span> freq_n_afd)) <span class="sc">%&gt;%</span></span>
<span id="cb37-112"><a href="projects-funded-by-the-afd.html#cb37-112" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-113"><a href="projects-funded-by-the-afd.html#cb37-113" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top countries of AFD funded, non-marine protected areas (#)&quot;</span>,</span>
<span id="cb37-114"><a href="projects-funded-by-the-afd.html#cb37-114" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">min</span>(data_distrib_ctry_afd<span class="sc">$</span>n_tot_afd), <span class="st">&quot;non-marine protected areas reported by the WDPA, covering&quot;</span>, <span class="fu">format</span>(<span class="fu">min</span>(data_distrib_ctry_afd<span class="sc">$</span>area_km2_afd_tot), <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb37-115"><a href="projects-funded-by-the-afd.html#cb37-115" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Note : we consider non-marine PAs reported by the WDPA on the full period covered by the data, in countries that are potential AFD partners.</span><span class="sc">\n</span><span class="st">These are low-, lower-middle, upper-middle countries according to the World Bank 2022 classification, </span><span class="sc">\n</span><span class="st">excluding Russia and including Uruguay, Panama, Chile, New Caledonia.</span><span class="sc">\n</span><span class="st">A subset of these PAs is AFD funded, though some PAs funded by the AFD are not reported by the WDPA.&quot;</span>,</span>
<span id="cb37-116"><a href="projects-funded-by-the-afd.html#cb37-116" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb37-117"><a href="projects-funded-by-the-afd.html#cb37-117" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-118"><a href="projects-funded-by-the-afd.html#cb37-118" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;AFD funded&quot;</span>, <span class="st">&quot;Low- to upper-middle income*&quot;</span>),</span>
<span id="cb37-119"><a href="projects-funded-by-the-afd.html#cb37-119" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-120"><a href="projects-funded-by-the-afd.html#cb37-120" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb37-121"><a href="projects-funded-by-the-afd.html#cb37-121" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb37-122"><a href="projects-funded-by-the-afd.html#cb37-122" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb37-123"><a href="projects-funded-by-the-afd.html#cb37-123" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb37-124"><a href="projects-funded-by-the-afd.html#cb37-124" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb37-125"><a href="projects-funded-by-the-afd.html#cb37-125" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb37-126"><a href="projects-funded-by-the-afd.html#cb37-126" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-127"><a href="projects-funded-by-the-afd.html#cb37-127" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-128"><a href="projects-funded-by-the-afd.html#cb37-128" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-129"><a href="projects-funded-by-the-afd.html#cb37-129" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb37-130"><a href="projects-funded-by-the-afd.html#cb37-130" tabindex="-1"></a>hist_distrib_ctry_afd_top_n </span>
<span id="cb37-131"><a href="projects-funded-by-the-afd.html#cb37-131" tabindex="-1"></a><span class="do">### Area</span></span>
<span id="cb37-132"><a href="projects-funded-by-the-afd.html#cb37-132" tabindex="-1"></a>hist_distrib_ctry_afd_top_area <span class="ot">=</span> <span class="fu">ggplot</span>(data_distrib_ctry_afd_top_area,</span>
<span id="cb37-133"><a href="projects-funded-by-the-afd.html#cb37-133" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, <span class="sc">-</span>freq_area_afd), <span class="at">y =</span> freq_area_afd, <span class="at">fill =</span> freq_area_afd)) <span class="sc">%&gt;%</span></span>
<span id="cb37-134"><a href="projects-funded-by-the-afd.html#cb37-134" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-135"><a href="projects-funded-by-the-afd.html#cb37-135" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top countries of AFD funded, non-marine protected areas (area)&quot;</span>,</span>
<span id="cb37-136"><a href="projects-funded-by-the-afd.html#cb37-136" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">min</span>(data_distrib_ctry_afd<span class="sc">$</span>n_tot_afd), <span class="st">&quot;non-marine protected areas reported by the WDPA, covering&quot;</span>, <span class="fu">format</span>(<span class="fu">min</span>(data_distrib_ctry_afd<span class="sc">$</span>area_km2_afd_tot), <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb37-137"><a href="projects-funded-by-the-afd.html#cb37-137" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Note : we consider non-marine PAs reported by the WDPA on the full period covered by the data, in countries that are potential AFD partners.</span><span class="sc">\n</span><span class="st">These are low-, lower-middle, upper-middle countries according to the World Bank 2022 classification, </span><span class="sc">\n</span><span class="st">excluding Russia and including Uruguay, Panama, Chile, New Caledonia.</span><span class="sc">\n</span><span class="st">A subset of these PAs is AFD funded, though some PAs funded by the AFD are not reported by the WDPA.&quot;</span>,</span>
<span id="cb37-138"><a href="projects-funded-by-the-afd.html#cb37-138" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb37-139"><a href="projects-funded-by-the-afd.html#cb37-139" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-140"><a href="projects-funded-by-the-afd.html#cb37-140" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;AFD funded&quot;</span>, <span class="st">&quot;Low- to upper-middle income*&quot;</span>),</span>
<span id="cb37-141"><a href="projects-funded-by-the-afd.html#cb37-141" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-142"><a href="projects-funded-by-the-afd.html#cb37-142" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb37-143"><a href="projects-funded-by-the-afd.html#cb37-143" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb37-144"><a href="projects-funded-by-the-afd.html#cb37-144" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb37-145"><a href="projects-funded-by-the-afd.html#cb37-145" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb37-146"><a href="projects-funded-by-the-afd.html#cb37-146" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb37-147"><a href="projects-funded-by-the-afd.html#cb37-147" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb37-148"><a href="projects-funded-by-the-afd.html#cb37-148" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-149"><a href="projects-funded-by-the-afd.html#cb37-149" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-150"><a href="projects-funded-by-the-afd.html#cb37-150" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-151"><a href="projects-funded-by-the-afd.html#cb37-151" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb37-152"><a href="projects-funded-by-the-afd.html#cb37-152" tabindex="-1"></a>hist_distrib_ctry_afd_top_area</span>
<span id="cb37-153"><a href="projects-funded-by-the-afd.html#cb37-153" tabindex="-1"></a></span>
<span id="cb37-154"><a href="projects-funded-by-the-afd.html#cb37-154" tabindex="-1"></a></span>
<span id="cb37-155"><a href="projects-funded-by-the-afd.html#cb37-155" tabindex="-1"></a><span class="do">## For top AFD, comparison with WDPA in terms of numbers</span></span>
<span id="cb37-156"><a href="projects-funded-by-the-afd.html#cb37-156" tabindex="-1"></a>hist_distrib_ctry_vs_n <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry_vs_n, <span class="fu">grepl</span>(<span class="st">&quot;freq&quot;</span>, metric)),</span>
<span id="cb37-157"><a href="projects-funded-by-the-afd.html#cb37-157" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb37-158"><a href="projects-funded-by-the-afd.html#cb37-158" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-159"><a href="projects-funded-by-the-afd.html#cb37-159" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top countries targeted by AFD funded non-marine protected areas (#)&quot;</span>,</span>
<span id="cb37-160"><a href="projects-funded-by-the-afd.html#cb37-160" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">min</span>(data_distrib_ctry_wdpa<span class="sc">$</span>n_tot_wdpa), <span class="st">&quot;non-marine protected areas reported by the WDPA,&quot;</span>,  <span class="fu">min</span>(data_distrib_ctry_afd<span class="sc">$</span>n_tot_afd), <span class="st">&quot;funded by AFD&quot;</span>),</span>
<span id="cb37-161"><a href="projects-funded-by-the-afd.html#cb37-161" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Note : we consider non-marine PAs reported by the WDPA on the full period covered by the data, in countries that are potential AFD partners.</span><span class="sc">\n</span><span class="st">*These are low-, lower-middle, upper-middle countries according to the World Bank 2022 classification, </span><span class="sc">\n</span><span class="st">excluding Russia and including Uruguay, Panama, Chile, New Caledonia.</span><span class="sc">\n</span><span class="st">A subset of these PAs is AFD funded, though some PAs funded by the AFD are not reported by the WDPA.&quot;</span>,</span>
<span id="cb37-162"><a href="projects-funded-by-the-afd.html#cb37-162" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb37-163"><a href="projects-funded-by-the-afd.html#cb37-163" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-164"><a href="projects-funded-by-the-afd.html#cb37-164" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;AFD funded&quot;</span>, <span class="st">&quot;Low- to upper-middle income*&quot;</span>),</span>
<span id="cb37-165"><a href="projects-funded-by-the-afd.html#cb37-165" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-166"><a href="projects-funded-by-the-afd.html#cb37-166" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb37-167"><a href="projects-funded-by-the-afd.html#cb37-167" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb37-168"><a href="projects-funded-by-the-afd.html#cb37-168" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb37-169"><a href="projects-funded-by-the-afd.html#cb37-169" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb37-170"><a href="projects-funded-by-the-afd.html#cb37-170" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb37-171"><a href="projects-funded-by-the-afd.html#cb37-171" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb37-172"><a href="projects-funded-by-the-afd.html#cb37-172" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-173"><a href="projects-funded-by-the-afd.html#cb37-173" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-174"><a href="projects-funded-by-the-afd.html#cb37-174" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-175"><a href="projects-funded-by-the-afd.html#cb37-175" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb37-176"><a href="projects-funded-by-the-afd.html#cb37-176" tabindex="-1"></a>hist_distrib_ctry_vs_n </span>
<span id="cb37-177"><a href="projects-funded-by-the-afd.html#cb37-177" tabindex="-1"></a></span>
<span id="cb37-178"><a href="projects-funded-by-the-afd.html#cb37-178" tabindex="-1"></a><span class="do">## For top AFD, comparison with WDPA in terms of area</span></span>
<span id="cb37-179"><a href="projects-funded-by-the-afd.html#cb37-179" tabindex="-1"></a>hist_distrib_ctry_vs_area <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_ctry_vs_area, <span class="fu">grepl</span>(<span class="st">&quot;freq&quot;</span>, metric)),</span>
<span id="cb37-180"><a href="projects-funded-by-the-afd.html#cb37-180" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(iso3, value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb37-181"><a href="projects-funded-by-the-afd.html#cb37-181" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-182"><a href="projects-funded-by-the-afd.html#cb37-182" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top countries targeted by AFD funded non-marine protected areas (area)&quot;</span>,</span>
<span id="cb37-183"><a href="projects-funded-by-the-afd.html#cb37-183" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">min</span>(data_distrib_ctry_wdpa<span class="sc">$</span>n_tot_wdpa), <span class="st">&quot;non-marine protected areas reported by the the WDPA,&quot;</span>,  <span class="fu">min</span>(data_distrib_ctry_afd<span class="sc">$</span>n_tot_afd), <span class="st">&quot;funded by AFD&quot;</span>),</span>
<span id="cb37-184"><a href="projects-funded-by-the-afd.html#cb37-184" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Note : we consider non-marine PAs reported by the WDPA on the full period covered by the data, in countries that are potential AFD partners.</span><span class="sc">\n</span><span class="st">*These are low-, lower-middle, upper-middle countries according to the World Bank 2022 classification, </span><span class="sc">\n</span><span class="st">excluding Russia and including Uruguay, Panama, Chile, New Caledonia.</span><span class="sc">\n</span><span class="st">A subset of these PAs is AFD funded, though some PAs funded by the AFD are not reported by the WDPA.&quot;</span>,</span>
<span id="cb37-185"><a href="projects-funded-by-the-afd.html#cb37-185" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb37-186"><a href="projects-funded-by-the-afd.html#cb37-186" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of funded areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-187"><a href="projects-funded-by-the-afd.html#cb37-187" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;AFD funded&quot;</span>, <span class="st">&quot;Low- to upper-middle income*&quot;</span>),</span>
<span id="cb37-188"><a href="projects-funded-by-the-afd.html#cb37-188" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-189"><a href="projects-funded-by-the-afd.html#cb37-189" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb37-190"><a href="projects-funded-by-the-afd.html#cb37-190" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb37-191"><a href="projects-funded-by-the-afd.html#cb37-191" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb37-192"><a href="projects-funded-by-the-afd.html#cb37-192" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb37-193"><a href="projects-funded-by-the-afd.html#cb37-193" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb37-194"><a href="projects-funded-by-the-afd.html#cb37-194" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb37-195"><a href="projects-funded-by-the-afd.html#cb37-195" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-196"><a href="projects-funded-by-the-afd.html#cb37-196" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-197"><a href="projects-funded-by-the-afd.html#cb37-197" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb37-198"><a href="projects-funded-by-the-afd.html#cb37-198" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb37-199"><a href="projects-funded-by-the-afd.html#cb37-199" tabindex="-1"></a>hist_distrib_ctry_vs_area</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="projects-funded-by-the-afd.html#cb38-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb38-2"><a href="projects-funded-by-the-afd.html#cb38-2" tabindex="-1"></a></span>
<span id="cb38-3"><a href="projects-funded-by-the-afd.html#cb38-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb38-4"><a href="projects-funded-by-the-afd.html#cb38-4" tabindex="-1"></a></span>
<span id="cb38-5"><a href="projects-funded-by-the-afd.html#cb38-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_wdpa_top_n.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb38-6"><a href="projects-funded-by-the-afd.html#cb38-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_wdpa_top_n,</span>
<span id="cb38-7"><a href="projects-funded-by-the-afd.html#cb38-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb38-8"><a href="projects-funded-by-the-afd.html#cb38-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb38-9"><a href="projects-funded-by-the-afd.html#cb38-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_wdpa_top_area.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb38-10"><a href="projects-funded-by-the-afd.html#cb38-10" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_wdpa_top_area,</span>
<span id="cb38-11"><a href="projects-funded-by-the-afd.html#cb38-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb38-12"><a href="projects-funded-by-the-afd.html#cb38-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb38-13"><a href="projects-funded-by-the-afd.html#cb38-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_afd_top_n.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb38-14"><a href="projects-funded-by-the-afd.html#cb38-14" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_afd_top_n,</span>
<span id="cb38-15"><a href="projects-funded-by-the-afd.html#cb38-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb38-16"><a href="projects-funded-by-the-afd.html#cb38-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb38-17"><a href="projects-funded-by-the-afd.html#cb38-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_afd_top_area.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb38-18"><a href="projects-funded-by-the-afd.html#cb38-18" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_afd_top_area,</span>
<span id="cb38-19"><a href="projects-funded-by-the-afd.html#cb38-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb38-20"><a href="projects-funded-by-the-afd.html#cb38-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb38-21"><a href="projects-funded-by-the-afd.html#cb38-21" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_vs_n.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb38-22"><a href="projects-funded-by-the-afd.html#cb38-22" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_vs_n,</span>
<span id="cb38-23"><a href="projects-funded-by-the-afd.html#cb38-23" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb38-24"><a href="projects-funded-by-the-afd.html#cb38-24" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb38-25"><a href="projects-funded-by-the-afd.html#cb38-25" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_ctry_vs_area.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb38-26"><a href="projects-funded-by-the-afd.html#cb38-26" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_ctry_vs_area,</span>
<span id="cb38-27"><a href="projects-funded-by-the-afd.html#cb38-27" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb38-28"><a href="projects-funded-by-the-afd.html#cb38-28" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb38-29"><a href="projects-funded-by-the-afd.html#cb38-29" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb38-30"><a href="projects-funded-by-the-afd.html#cb38-30" tabindex="-1"></a></span>
<span id="cb38-31"><a href="projects-funded-by-the-afd.html#cb38-31" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb38-32"><a href="projects-funded-by-the-afd.html#cb38-32" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-33"><a href="projects-funded-by-the-afd.html#cb38-33" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb38-34"><a href="projects-funded-by-the-afd.html#cb38-34" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb38-35"><a href="projects-funded-by-the-afd.html#cb38-35" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb38-36"><a href="projects-funded-by-the-afd.html#cb38-36" tabindex="-1"></a>{</span>
<span id="cb38-37"><a href="projects-funded-by-the-afd.html#cb38-37" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb38-38"><a href="projects-funded-by-the-afd.html#cb38-38" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb38-39"><a href="projects-funded-by-the-afd.html#cb38-39" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb38-40"><a href="projects-funded-by-the-afd.html#cb38-40" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/distribution/wdpa_vs_afd/no_marine&quot;</span>, </span>
<span id="cb38-41"><a href="projects-funded-by-the-afd.html#cb38-41" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-42"><a href="projects-funded-by-the-afd.html#cb38-42" tabindex="-1"></a>  }</span>
<span id="cb38-43"><a href="projects-funded-by-the-afd.html#cb38-43" tabindex="-1"></a></span>
<span id="cb38-44"><a href="projects-funded-by-the-afd.html#cb38-44" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb38-45"><a href="projects-funded-by-the-afd.html#cb38-45" tabindex="-1"></a></span>
<span id="cb38-46"><a href="projects-funded-by-the-afd.html#cb38-46" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="statistics-at-region-level-all" class="section level4 hasAnchor" number="2.3.3.5">
<h4><span class="header-section-number">2.3.3.5</span> Statistics at region level (all)<a href="projects-funded-by-the-afd.html#statistics-at-region-level-all" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>All PAs across the world.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="projects-funded-by-the-afd.html#cb39-1" tabindex="-1"></a><span class="co">#Surface and number of PAs by country</span></span>
<span id="cb39-2"><a href="projects-funded-by-the-afd.html#cb39-2" tabindex="-1"></a>data_distrib_reg <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="projects-funded-by-the-afd.html#cb39-3" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="projects-funded-by-the-afd.html#cb39-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb39-5"><a href="projects-funded-by-the-afd.html#cb39-5" tabindex="-1"></a>            <span class="at">area_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="projects-funded-by-the-afd.html#cb39-6" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="projects-funded-by-the-afd.html#cb39-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-8"><a href="projects-funded-by-the-afd.html#cb39-8" tabindex="-1"></a>         <span class="at">area_tot_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb39-9"><a href="projects-funded-by-the-afd.html#cb39-9" tabindex="-1"></a>         <span class="at">freq_n =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb39-10"><a href="projects-funded-by-the-afd.html#cb39-10" tabindex="-1"></a>         <span class="at">freq_area =</span> <span class="fu">round</span>(area_km2<span class="sc">/</span>area_tot_km2<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="projects-funded-by-the-afd.html#cb39-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;freq_n&quot;</span>, <span class="st">&quot;area_km2&quot;</span>, <span class="st">&quot;freq_area&quot;</span>),</span>
<span id="cb39-12"><a href="projects-funded-by-the-afd.html#cb39-12" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="projects-funded-by-the-afd.html#cb39-13" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(region) <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-14"><a href="projects-funded-by-the-afd.html#cb39-14" tabindex="-1"></a></span>
<span id="cb39-15"><a href="projects-funded-by-the-afd.html#cb39-15" tabindex="-1"></a></span>
<span id="cb39-16"><a href="projects-funded-by-the-afd.html#cb39-16" tabindex="-1"></a><span class="co">#Histogram for all countries</span></span>
<span id="cb39-17"><a href="projects-funded-by-the-afd.html#cb39-17" tabindex="-1"></a><span class="co">#Histogram in number</span></span>
<span id="cb39-18"><a href="projects-funded-by-the-afd.html#cb39-18" tabindex="-1"></a>hist_distrib_reg_n_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;freq_n&quot;</span>), </span>
<span id="cb39-19"><a href="projects-funded-by-the-afd.html#cb39-19" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> region)) <span class="sc">%&gt;%</span></span>
<span id="cb39-20"><a href="projects-funded-by-the-afd.html#cb39-20" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-21"><a href="projects-funded-by-the-afd.html#cb39-21" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb39-22"><a href="projects-funded-by-the-afd.html#cb39-22" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb39-23"><a href="projects-funded-by-the-afd.html#cb39-23" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb39-24"><a href="projects-funded-by-the-afd.html#cb39-24" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of protected areas by region (#)&quot;</span>,</span>
<span id="cb39-25"><a href="projects-funded-by-the-afd.html#cb39-25" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb39-26"><a href="projects-funded-by-the-afd.html#cb39-26" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb39-27"><a href="projects-funded-by-the-afd.html#cb39-27" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-28"><a href="projects-funded-by-the-afd.html#cb39-28" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb39-29"><a href="projects-funded-by-the-afd.html#cb39-29" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb39-30"><a href="projects-funded-by-the-afd.html#cb39-30" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb39-31"><a href="projects-funded-by-the-afd.html#cb39-31" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb39-32"><a href="projects-funded-by-the-afd.html#cb39-32" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb39-33"><a href="projects-funded-by-the-afd.html#cb39-33" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb39-34"><a href="projects-funded-by-the-afd.html#cb39-34" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-35"><a href="projects-funded-by-the-afd.html#cb39-35" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-36"><a href="projects-funded-by-the-afd.html#cb39-36" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-37"><a href="projects-funded-by-the-afd.html#cb39-37" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb39-38"><a href="projects-funded-by-the-afd.html#cb39-38" tabindex="-1"></a>hist_distrib_reg_n_shr</span>
<span id="cb39-39"><a href="projects-funded-by-the-afd.html#cb39-39" tabindex="-1"></a></span>
<span id="cb39-40"><a href="projects-funded-by-the-afd.html#cb39-40" tabindex="-1"></a><span class="co"># Histogram in surfaces</span></span>
<span id="cb39-41"><a href="projects-funded-by-the-afd.html#cb39-41" tabindex="-1"></a>hist_distrib_reg_area_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;freq_area&quot;</span>), </span>
<span id="cb39-42"><a href="projects-funded-by-the-afd.html#cb39-42" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> region)) <span class="sc">%&gt;%</span></span>
<span id="cb39-43"><a href="projects-funded-by-the-afd.html#cb39-43" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-44"><a href="projects-funded-by-the-afd.html#cb39-44" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb39-45"><a href="projects-funded-by-the-afd.html#cb39-45" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb39-46"><a href="projects-funded-by-the-afd.html#cb39-46" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb39-47"><a href="projects-funded-by-the-afd.html#cb39-47" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of protected areas by region (area)&quot;</span>,</span>
<span id="cb39-48"><a href="projects-funded-by-the-afd.html#cb39-48" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb39-49"><a href="projects-funded-by-the-afd.html#cb39-49" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb39-50"><a href="projects-funded-by-the-afd.html#cb39-50" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of areas funded (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-51"><a href="projects-funded-by-the-afd.html#cb39-51" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb39-52"><a href="projects-funded-by-the-afd.html#cb39-52" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb39-53"><a href="projects-funded-by-the-afd.html#cb39-53" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb39-54"><a href="projects-funded-by-the-afd.html#cb39-54" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb39-55"><a href="projects-funded-by-the-afd.html#cb39-55" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb39-56"><a href="projects-funded-by-the-afd.html#cb39-56" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb39-57"><a href="projects-funded-by-the-afd.html#cb39-57" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-58"><a href="projects-funded-by-the-afd.html#cb39-58" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-59"><a href="projects-funded-by-the-afd.html#cb39-59" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-60"><a href="projects-funded-by-the-afd.html#cb39-60" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb39-61"><a href="projects-funded-by-the-afd.html#cb39-61" tabindex="-1"></a>hist_distrib_reg_area_shr</span>
<span id="cb39-62"><a href="projects-funded-by-the-afd.html#cb39-62" tabindex="-1"></a></span>
<span id="cb39-63"><a href="projects-funded-by-the-afd.html#cb39-63" tabindex="-1"></a><span class="do">## Both</span></span>
<span id="cb39-64"><a href="projects-funded-by-the-afd.html#cb39-64" tabindex="-1"></a>hist_distrib_reg_top_both_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;freq_area&quot;</span>, <span class="st">&quot;freq_n&quot;</span>)), </span>
<span id="cb39-65"><a href="projects-funded-by-the-afd.html#cb39-65" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb39-66"><a href="projects-funded-by-the-afd.html#cb39-66" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-67"><a href="projects-funded-by-the-afd.html#cb39-67" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb39-68"><a href="projects-funded-by-the-afd.html#cb39-68" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb39-69"><a href="projects-funded-by-the-afd.html#cb39-69" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb39-70"><a href="projects-funded-by-the-afd.html#cb39-70" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of AFD funded protected areas by region&quot;</span>,</span>
<span id="cb39-71"><a href="projects-funded-by-the-afd.html#cb39-71" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb39-72"><a href="projects-funded-by-the-afd.html#cb39-72" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb39-73"><a href="projects-funded-by-the-afd.html#cb39-73" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-74"><a href="projects-funded-by-the-afd.html#cb39-74" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Area&quot;</span>, <span class="st">&quot;Number&quot;</span>),</span>
<span id="cb39-75"><a href="projects-funded-by-the-afd.html#cb39-75" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-76"><a href="projects-funded-by-the-afd.html#cb39-76" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb39-77"><a href="projects-funded-by-the-afd.html#cb39-77" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb39-78"><a href="projects-funded-by-the-afd.html#cb39-78" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb39-79"><a href="projects-funded-by-the-afd.html#cb39-79" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb39-80"><a href="projects-funded-by-the-afd.html#cb39-80" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb39-81"><a href="projects-funded-by-the-afd.html#cb39-81" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb39-82"><a href="projects-funded-by-the-afd.html#cb39-82" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-83"><a href="projects-funded-by-the-afd.html#cb39-83" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-84"><a href="projects-funded-by-the-afd.html#cb39-84" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb39-85"><a href="projects-funded-by-the-afd.html#cb39-85" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb39-86"><a href="projects-funded-by-the-afd.html#cb39-86" tabindex="-1"></a>hist_distrib_reg_top_both_shr</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="projects-funded-by-the-afd.html#cb40-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb40-2"><a href="projects-funded-by-the-afd.html#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="projects-funded-by-the-afd.html#cb40-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb40-4"><a href="projects-funded-by-the-afd.html#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="projects-funded-by-the-afd.html#cb40-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_reg_n_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb40-6"><a href="projects-funded-by-the-afd.html#cb40-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_reg_n_shr,</span>
<span id="cb40-7"><a href="projects-funded-by-the-afd.html#cb40-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb40-8"><a href="projects-funded-by-the-afd.html#cb40-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb40-9"><a href="projects-funded-by-the-afd.html#cb40-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_reg_area_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb40-10"><a href="projects-funded-by-the-afd.html#cb40-10" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_reg_area_shr,</span>
<span id="cb40-11"><a href="projects-funded-by-the-afd.html#cb40-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb40-12"><a href="projects-funded-by-the-afd.html#cb40-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb40-13"><a href="projects-funded-by-the-afd.html#cb40-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_reg_top_both_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb40-14"><a href="projects-funded-by-the-afd.html#cb40-14" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_reg_top_both_shr,</span>
<span id="cb40-15"><a href="projects-funded-by-the-afd.html#cb40-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb40-16"><a href="projects-funded-by-the-afd.html#cb40-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb40-17"><a href="projects-funded-by-the-afd.html#cb40-17" tabindex="-1"></a></span>
<span id="cb40-18"><a href="projects-funded-by-the-afd.html#cb40-18" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb40-19"><a href="projects-funded-by-the-afd.html#cb40-19" tabindex="-1"></a></span>
<span id="cb40-20"><a href="projects-funded-by-the-afd.html#cb40-20" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb40-21"><a href="projects-funded-by-the-afd.html#cb40-21" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-22"><a href="projects-funded-by-the-afd.html#cb40-22" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb40-23"><a href="projects-funded-by-the-afd.html#cb40-23" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb40-24"><a href="projects-funded-by-the-afd.html#cb40-24" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb40-25"><a href="projects-funded-by-the-afd.html#cb40-25" tabindex="-1"></a>{</span>
<span id="cb40-26"><a href="projects-funded-by-the-afd.html#cb40-26" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb40-27"><a href="projects-funded-by-the-afd.html#cb40-27" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb40-28"><a href="projects-funded-by-the-afd.html#cb40-28" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb40-29"><a href="projects-funded-by-the-afd.html#cb40-29" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/distribution/world/all&quot;</span>, </span>
<span id="cb40-30"><a href="projects-funded-by-the-afd.html#cb40-30" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-31"><a href="projects-funded-by-the-afd.html#cb40-31" tabindex="-1"></a>  }</span>
<span id="cb40-32"><a href="projects-funded-by-the-afd.html#cb40-32" tabindex="-1"></a></span>
<span id="cb40-33"><a href="projects-funded-by-the-afd.html#cb40-33" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb40-34"><a href="projects-funded-by-the-afd.html#cb40-34" tabindex="-1"></a></span>
<span id="cb40-35"><a href="projects-funded-by-the-afd.html#cb40-35" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="statistics-at-region-level-non-marine" class="section level4 hasAnchor" number="2.3.3.6">
<h4><span class="header-section-number">2.3.3.6</span> Statistics at region level (non-marine)<a href="projects-funded-by-the-afd.html#statistics-at-region-level-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="projects-funded-by-the-afd.html#cb41-1" tabindex="-1"></a><span class="co">#Surface and number of PAs by country</span></span>
<span id="cb41-2"><a href="projects-funded-by-the-afd.html#cb41-2" tabindex="-1"></a>data_distrib_reg <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="projects-funded-by-the-afd.html#cb41-3" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="projects-funded-by-the-afd.html#cb41-4" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="projects-funded-by-the-afd.html#cb41-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb41-6"><a href="projects-funded-by-the-afd.html#cb41-6" tabindex="-1"></a>            <span class="at">area_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="projects-funded-by-the-afd.html#cb41-7" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="projects-funded-by-the-afd.html#cb41-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-9"><a href="projects-funded-by-the-afd.html#cb41-9" tabindex="-1"></a>         <span class="at">area_tot_km2 =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb41-10"><a href="projects-funded-by-the-afd.html#cb41-10" tabindex="-1"></a>         <span class="at">freq_n =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb41-11"><a href="projects-funded-by-the-afd.html#cb41-11" tabindex="-1"></a>         <span class="at">freq_area =</span> <span class="fu">round</span>(area_km2<span class="sc">/</span>area_tot_km2<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="projects-funded-by-the-afd.html#cb41-12" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;freq_n&quot;</span>, <span class="st">&quot;area_km2&quot;</span>, <span class="st">&quot;freq_area&quot;</span>),</span>
<span id="cb41-13"><a href="projects-funded-by-the-afd.html#cb41-13" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="projects-funded-by-the-afd.html#cb41-14" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(region) <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-15"><a href="projects-funded-by-the-afd.html#cb41-15" tabindex="-1"></a></span>
<span id="cb41-16"><a href="projects-funded-by-the-afd.html#cb41-16" tabindex="-1"></a></span>
<span id="cb41-17"><a href="projects-funded-by-the-afd.html#cb41-17" tabindex="-1"></a><span class="co">#Histogram for all countries</span></span>
<span id="cb41-18"><a href="projects-funded-by-the-afd.html#cb41-18" tabindex="-1"></a><span class="co">#Histogram in number</span></span>
<span id="cb41-19"><a href="projects-funded-by-the-afd.html#cb41-19" tabindex="-1"></a>hist_distrib_reg_n_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;freq_n&quot;</span>), </span>
<span id="cb41-20"><a href="projects-funded-by-the-afd.html#cb41-20" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> region)) <span class="sc">%&gt;%</span></span>
<span id="cb41-21"><a href="projects-funded-by-the-afd.html#cb41-21" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-22"><a href="projects-funded-by-the-afd.html#cb41-22" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb41-23"><a href="projects-funded-by-the-afd.html#cb41-23" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb41-24"><a href="projects-funded-by-the-afd.html#cb41-24" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb41-25"><a href="projects-funded-by-the-afd.html#cb41-25" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of AFD funded, non-marine protected areas by region (#)&quot;</span>,</span>
<span id="cb41-26"><a href="projects-funded-by-the-afd.html#cb41-26" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb41-27"><a href="projects-funded-by-the-afd.html#cb41-27" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-28"><a href="projects-funded-by-the-afd.html#cb41-28" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="projects-funded-by-the-afd.html#cb41-29" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb41-30"><a href="projects-funded-by-the-afd.html#cb41-30" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb41-31"><a href="projects-funded-by-the-afd.html#cb41-31" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb41-32"><a href="projects-funded-by-the-afd.html#cb41-32" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb41-33"><a href="projects-funded-by-the-afd.html#cb41-33" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb41-34"><a href="projects-funded-by-the-afd.html#cb41-34" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb41-35"><a href="projects-funded-by-the-afd.html#cb41-35" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-36"><a href="projects-funded-by-the-afd.html#cb41-36" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-37"><a href="projects-funded-by-the-afd.html#cb41-37" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-38"><a href="projects-funded-by-the-afd.html#cb41-38" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb41-39"><a href="projects-funded-by-the-afd.html#cb41-39" tabindex="-1"></a>hist_distrib_reg_n_shr</span>
<span id="cb41-40"><a href="projects-funded-by-the-afd.html#cb41-40" tabindex="-1"></a></span>
<span id="cb41-41"><a href="projects-funded-by-the-afd.html#cb41-41" tabindex="-1"></a><span class="co"># Histogram in surfaces</span></span>
<span id="cb41-42"><a href="projects-funded-by-the-afd.html#cb41-42" tabindex="-1"></a>hist_distrib_reg_area_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;freq_area&quot;</span>), </span>
<span id="cb41-43"><a href="projects-funded-by-the-afd.html#cb41-43" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> region)) <span class="sc">%&gt;%</span></span>
<span id="cb41-44"><a href="projects-funded-by-the-afd.html#cb41-44" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.50</span>, <span class="at">fill=</span> <span class="st">&quot;#3182BD&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-45"><a href="projects-funded-by-the-afd.html#cb41-45" tabindex="-1"></a><span class="co"># + geom_text(aes(label = n, y = n), </span></span>
<span id="cb41-46"><a href="projects-funded-by-the-afd.html#cb41-46" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb41-47"><a href="projects-funded-by-the-afd.html#cb41-47" tabindex="-1"></a><span class="co">#         size=3) %&gt;%</span></span>
<span id="cb41-48"><a href="projects-funded-by-the-afd.html#cb41-48" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of AFD funded, non-marine protected areas by region (area)&quot;</span>,</span>
<span id="cb41-49"><a href="projects-funded-by-the-afd.html#cb41-49" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb41-50"><a href="projects-funded-by-the-afd.html#cb41-50" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-51"><a href="projects-funded-by-the-afd.html#cb41-51" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of areas funded (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-52"><a href="projects-funded-by-the-afd.html#cb41-52" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb41-53"><a href="projects-funded-by-the-afd.html#cb41-53" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb41-54"><a href="projects-funded-by-the-afd.html#cb41-54" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb41-55"><a href="projects-funded-by-the-afd.html#cb41-55" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb41-56"><a href="projects-funded-by-the-afd.html#cb41-56" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb41-57"><a href="projects-funded-by-the-afd.html#cb41-57" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb41-58"><a href="projects-funded-by-the-afd.html#cb41-58" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-59"><a href="projects-funded-by-the-afd.html#cb41-59" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-60"><a href="projects-funded-by-the-afd.html#cb41-60" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-61"><a href="projects-funded-by-the-afd.html#cb41-61" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb41-62"><a href="projects-funded-by-the-afd.html#cb41-62" tabindex="-1"></a>hist_distrib_reg_area_shr</span>
<span id="cb41-63"><a href="projects-funded-by-the-afd.html#cb41-63" tabindex="-1"></a></span>
<span id="cb41-64"><a href="projects-funded-by-the-afd.html#cb41-64" tabindex="-1"></a><span class="do">## Both</span></span>
<span id="cb41-65"><a href="projects-funded-by-the-afd.html#cb41-65" tabindex="-1"></a>hist_distrib_reg_top_both_shr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;freq_area&quot;</span>, <span class="st">&quot;freq_n&quot;</span>)), </span>
<span id="cb41-66"><a href="projects-funded-by-the-afd.html#cb41-66" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, <span class="sc">-</span>value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb41-67"><a href="projects-funded-by-the-afd.html#cb41-67" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-68"><a href="projects-funded-by-the-afd.html#cb41-68" tabindex="-1"></a><span class="co"># + geom_text(aes(label = paste(value, &quot;PAs&quot;), y = value), </span></span>
<span id="cb41-69"><a href="projects-funded-by-the-afd.html#cb41-69" tabindex="-1"></a><span class="co">#         vjust = -0.1, color=&quot;black&quot;,</span></span>
<span id="cb41-70"><a href="projects-funded-by-the-afd.html#cb41-70" tabindex="-1"></a><span class="co">#         size=3.5) %&gt;%</span></span>
<span id="cb41-71"><a href="projects-funded-by-the-afd.html#cb41-71" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of AFD funded, non-marine protected areas by region&quot;</span>,</span>
<span id="cb41-72"><a href="projects-funded-by-the-afd.html#cb41-72" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;n&quot;</span>)<span class="sc">$</span>value), <span class="st">&quot;non-marine protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">filter</span>(data_distrib_reg, metric <span class="sc">==</span> <span class="st">&quot;area_km2&quot;</span>)<span class="sc">$</span>value), <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb41-73"><a href="projects-funded-by-the-afd.html#cb41-73" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-74"><a href="projects-funded-by-the-afd.html#cb41-74" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-75"><a href="projects-funded-by-the-afd.html#cb41-75" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Area&quot;</span>, <span class="st">&quot;Number&quot;</span>),</span>
<span id="cb41-76"><a href="projects-funded-by-the-afd.html#cb41-76" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-77"><a href="projects-funded-by-the-afd.html#cb41-77" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb41-78"><a href="projects-funded-by-the-afd.html#cb41-78" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb41-79"><a href="projects-funded-by-the-afd.html#cb41-79" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb41-80"><a href="projects-funded-by-the-afd.html#cb41-80" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb41-81"><a href="projects-funded-by-the-afd.html#cb41-81" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb41-82"><a href="projects-funded-by-the-afd.html#cb41-82" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb41-83"><a href="projects-funded-by-the-afd.html#cb41-83" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-84"><a href="projects-funded-by-the-afd.html#cb41-84" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-85"><a href="projects-funded-by-the-afd.html#cb41-85" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb41-86"><a href="projects-funded-by-the-afd.html#cb41-86" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>))</span>
<span id="cb41-87"><a href="projects-funded-by-the-afd.html#cb41-87" tabindex="-1"></a>hist_distrib_reg_top_both_shr</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="projects-funded-by-the-afd.html#cb42-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb42-2"><a href="projects-funded-by-the-afd.html#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="projects-funded-by-the-afd.html#cb42-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb42-4"><a href="projects-funded-by-the-afd.html#cb42-4" tabindex="-1"></a></span>
<span id="cb42-5"><a href="projects-funded-by-the-afd.html#cb42-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_reg_n_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb42-6"><a href="projects-funded-by-the-afd.html#cb42-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_reg_n_shr,</span>
<span id="cb42-7"><a href="projects-funded-by-the-afd.html#cb42-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb42-8"><a href="projects-funded-by-the-afd.html#cb42-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb42-9"><a href="projects-funded-by-the-afd.html#cb42-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_reg_area_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb42-10"><a href="projects-funded-by-the-afd.html#cb42-10" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_reg_area_shr,</span>
<span id="cb42-11"><a href="projects-funded-by-the-afd.html#cb42-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb42-12"><a href="projects-funded-by-the-afd.html#cb42-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb42-13"><a href="projects-funded-by-the-afd.html#cb42-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_reg_top_both_shr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb42-14"><a href="projects-funded-by-the-afd.html#cb42-14" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_reg_top_both_shr,</span>
<span id="cb42-15"><a href="projects-funded-by-the-afd.html#cb42-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb42-16"><a href="projects-funded-by-the-afd.html#cb42-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb42-17"><a href="projects-funded-by-the-afd.html#cb42-17" tabindex="-1"></a></span>
<span id="cb42-18"><a href="projects-funded-by-the-afd.html#cb42-18" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb42-19"><a href="projects-funded-by-the-afd.html#cb42-19" tabindex="-1"></a></span>
<span id="cb42-20"><a href="projects-funded-by-the-afd.html#cb42-20" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb42-21"><a href="projects-funded-by-the-afd.html#cb42-21" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-22"><a href="projects-funded-by-the-afd.html#cb42-22" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb42-23"><a href="projects-funded-by-the-afd.html#cb42-23" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb42-24"><a href="projects-funded-by-the-afd.html#cb42-24" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb42-25"><a href="projects-funded-by-the-afd.html#cb42-25" tabindex="-1"></a>{</span>
<span id="cb42-26"><a href="projects-funded-by-the-afd.html#cb42-26" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb42-27"><a href="projects-funded-by-the-afd.html#cb42-27" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb42-28"><a href="projects-funded-by-the-afd.html#cb42-28" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb42-29"><a href="projects-funded-by-the-afd.html#cb42-29" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/distribution/world/no_marine&quot;</span>, </span>
<span id="cb42-30"><a href="projects-funded-by-the-afd.html#cb42-30" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-31"><a href="projects-funded-by-the-afd.html#cb42-31" tabindex="-1"></a>  }</span>
<span id="cb42-32"><a href="projects-funded-by-the-afd.html#cb42-32" tabindex="-1"></a></span>
<span id="cb42-33"><a href="projects-funded-by-the-afd.html#cb42-33" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb42-34"><a href="projects-funded-by-the-afd.html#cb42-34" tabindex="-1"></a></span>
<span id="cb42-35"><a href="projects-funded-by-the-afd.html#cb42-35" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="statistics-at-region-level-non-marine-wdpa-vs-afd" class="section level4 hasAnchor" number="2.3.3.7">
<h4><span class="header-section-number">2.3.3.7</span> Statistics at region level (non-marine, WDPA vs AFD)<a href="projects-funded-by-the-afd.html#statistics-at-region-level-non-marine-wdpa-vs-afd" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Distribution of PAs funded by the AFD across regions, is compared to the distribution of the full WDPA database. Note the comparison in terms of number instead of percentage is irrelevant. Indeed WDPA reports around 3e5 PAs, and about 100 are AFD funded.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="projects-funded-by-the-afd.html#cb43-1" tabindex="-1"></a><span class="co">#For AFD funded PAs</span></span>
<span id="cb43-2"><a href="projects-funded-by-the-afd.html#cb43-2" tabindex="-1"></a><span class="do">##Distribution across countries (all)</span></span>
<span id="cb43-3"><a href="projects-funded-by-the-afd.html#cb43-3" tabindex="-1"></a>data_distrib_reg_afd <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="projects-funded-by-the-afd.html#cb43-4" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="projects-funded-by-the-afd.html#cb43-5" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="projects-funded-by-the-afd.html#cb43-6" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_afd =</span> <span class="fu">n</span>(),</span>
<span id="cb43-7"><a href="projects-funded-by-the-afd.html#cb43-7" tabindex="-1"></a>            <span class="at">area_km2_afd =</span> <span class="fu">sum</span>(area_km2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="projects-funded-by-the-afd.html#cb43-8" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="projects-funded-by-the-afd.html#cb43-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot_afd =</span> <span class="fu">sum</span>(n_afd),</span>
<span id="cb43-10"><a href="projects-funded-by-the-afd.html#cb43-10" tabindex="-1"></a>         <span class="at">area_km2_afd_tot =</span> <span class="fu">sum</span>(area_km2_afd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-11"><a href="projects-funded-by-the-afd.html#cb43-11" tabindex="-1"></a>         <span class="at">freq_n_afd =</span> <span class="fu">round</span>(n_afd<span class="sc">/</span>n_tot_afd<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb43-12"><a href="projects-funded-by-the-afd.html#cb43-12" tabindex="-1"></a>         <span class="at">freq_area_afd =</span> <span class="fu">round</span>(area_km2_afd<span class="sc">/</span>area_km2_afd_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb43-13"><a href="projects-funded-by-the-afd.html#cb43-13" tabindex="-1"></a></span>
<span id="cb43-14"><a href="projects-funded-by-the-afd.html#cb43-14" tabindex="-1"></a><span class="co">#For WDPA PAs</span></span>
<span id="cb43-15"><a href="projects-funded-by-the-afd.html#cb43-15" tabindex="-1"></a><span class="do">## All countries</span></span>
<span id="cb43-16"><a href="projects-funded-by-the-afd.html#cb43-16" tabindex="-1"></a>data_distrib_reg_wdpa <span class="ot">=</span> data_wdpa <span class="sc">%&gt;%</span></span>
<span id="cb43-17"><a href="projects-funded-by-the-afd.html#cb43-17" tabindex="-1"></a>  <span class="co">#Non-marine areas only</span></span>
<span id="cb43-18"><a href="projects-funded-by-the-afd.html#cb43-18" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-19"><a href="projects-funded-by-the-afd.html#cb43-19" tabindex="-1"></a>  <span class="co">#Countries of interest only</span></span>
<span id="cb43-20"><a href="projects-funded-by-the-afd.html#cb43-20" tabindex="-1"></a>  <span class="fu">filter</span>(iso3 <span class="sc">%in%</span> lst_ctry_stat_wdpa) <span class="sc">%&gt;%</span></span>
<span id="cb43-21"><a href="projects-funded-by-the-afd.html#cb43-21" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="projects-funded-by-the-afd.html#cb43-22" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_wdpa =</span> <span class="fu">n</span>(),</span>
<span id="cb43-23"><a href="projects-funded-by-the-afd.html#cb43-23" tabindex="-1"></a>            <span class="at">area_km2_wdpa =</span> <span class="fu">sum</span>(rep_area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-24"><a href="projects-funded-by-the-afd.html#cb43-24" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-25"><a href="projects-funded-by-the-afd.html#cb43-25" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot_wdpa =</span> <span class="fu">sum</span>(n_wdpa),</span>
<span id="cb43-26"><a href="projects-funded-by-the-afd.html#cb43-26" tabindex="-1"></a>         <span class="at">area_km2_wdpa_tot =</span> <span class="fu">sum</span>(area_km2_wdpa, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb43-27"><a href="projects-funded-by-the-afd.html#cb43-27" tabindex="-1"></a>         <span class="at">freq_n_wdpa =</span> <span class="fu">round</span>(n_wdpa<span class="sc">/</span>n_tot_wdpa<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb43-28"><a href="projects-funded-by-the-afd.html#cb43-28" tabindex="-1"></a>         <span class="at">freq_area_wdpa =</span> <span class="fu">round</span>(area_km2_wdpa<span class="sc">/</span>area_km2_wdpa_tot<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb43-29"><a href="projects-funded-by-the-afd.html#cb43-29" tabindex="-1"></a></span>
<span id="cb43-30"><a href="projects-funded-by-the-afd.html#cb43-30" tabindex="-1"></a><span class="co">#Then create a plotting dataset with WDPA vs AFD distribution</span></span>
<span id="cb43-31"><a href="projects-funded-by-the-afd.html#cb43-31" tabindex="-1"></a><span class="do">##the distribution for top targeted countries by AFD</span></span>
<span id="cb43-32"><a href="projects-funded-by-the-afd.html#cb43-32" tabindex="-1"></a><span class="do">### in terms of numbers</span></span>
<span id="cb43-33"><a href="projects-funded-by-the-afd.html#cb43-33" tabindex="-1"></a>data_distrib_reg_vs_n <span class="ot">=</span> data_distrib_reg_wdpa <span class="sc">%&gt;%</span></span>
<span id="cb43-34"><a href="projects-funded-by-the-afd.html#cb43-34" tabindex="-1"></a>  <span class="fu">left_join</span>(data_distrib_reg_afd, <span class="at">by =</span> <span class="st">&quot;region&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-35"><a href="projects-funded-by-the-afd.html#cb43-35" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;area&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-36"><a href="projects-funded-by-the-afd.html#cb43-36" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;n_afd&quot;</span>, <span class="st">&quot;freq_n_afd&quot;</span>, <span class="st">&quot;n_wdpa&quot;</span>, <span class="st">&quot;freq_n_wdpa&quot;</span>),</span>
<span id="cb43-37"><a href="projects-funded-by-the-afd.html#cb43-37" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-38"><a href="projects-funded-by-the-afd.html#cb43-38" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(region) <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-39"><a href="projects-funded-by-the-afd.html#cb43-39" tabindex="-1"></a> <span class="do">###in terms of areas</span></span>
<span id="cb43-40"><a href="projects-funded-by-the-afd.html#cb43-40" tabindex="-1"></a>data_distrib_reg_vs_area <span class="ot">=</span> data_distrib_reg_wdpa <span class="sc">%&gt;%</span></span>
<span id="cb43-41"><a href="projects-funded-by-the-afd.html#cb43-41" tabindex="-1"></a>  <span class="fu">left_join</span>(data_distrib_reg_afd, <span class="at">by =</span> <span class="st">&quot;region&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-42"><a href="projects-funded-by-the-afd.html#cb43-42" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;n_&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-43"><a href="projects-funded-by-the-afd.html#cb43-43" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;area_km2_afd&quot;</span>, <span class="st">&quot;freq_area_afd&quot;</span>, <span class="st">&quot;area_km2_wdpa&quot;</span>, <span class="st">&quot;freq_area_wdpa&quot;</span>),</span>
<span id="cb43-44"><a href="projects-funded-by-the-afd.html#cb43-44" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-45"><a href="projects-funded-by-the-afd.html#cb43-45" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(region) <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-46"><a href="projects-funded-by-the-afd.html#cb43-46" tabindex="-1"></a></span>
<span id="cb43-47"><a href="projects-funded-by-the-afd.html#cb43-47" tabindex="-1"></a><span class="do">## For top AFD, comparison with WDPA in terms of numbers</span></span>
<span id="cb43-48"><a href="projects-funded-by-the-afd.html#cb43-48" tabindex="-1"></a>hist_distrib_reg_vs_n <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_reg_vs_n, <span class="fu">grepl</span>(<span class="st">&quot;freq&quot;</span>, metric)),</span>
<span id="cb43-49"><a href="projects-funded-by-the-afd.html#cb43-49" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb43-50"><a href="projects-funded-by-the-afd.html#cb43-50" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-51"><a href="projects-funded-by-the-afd.html#cb43-51" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of non-marine protected areas across regions (#)&quot;</span>,</span>
<span id="cb43-52"><a href="projects-funded-by-the-afd.html#cb43-52" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">min</span>(data_distrib_reg_wdpa<span class="sc">$</span>n_tot_wdpa), <span class="st">&quot;non-marine protected areas reported by the WDPA,&quot;</span>,  <span class="fu">min</span>(data_distrib_reg_afd<span class="sc">$</span>n_tot_afd), <span class="st">&quot;funded by AFD&quot;</span>),</span>
<span id="cb43-53"><a href="projects-funded-by-the-afd.html#cb43-53" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Note : we consider non-marine PAs reported by the WDPA on the full period covered by the data, in countries that are potential AFD partners.</span><span class="sc">\n</span><span class="st">*These are low-, lower-middle, upper-middle countries according to the World Bank 2022 classification, </span><span class="sc">\n</span><span class="st">excluding Russia and including Uruguay, Panama, Chile, New Caledonia.</span><span class="sc">\n</span><span class="st">A subset of these PAs is AFD funded, though some PAs funded by the AFD are not reported by the WDPA.&quot;</span>,</span>
<span id="cb43-54"><a href="projects-funded-by-the-afd.html#cb43-54" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb43-55"><a href="projects-funded-by-the-afd.html#cb43-55" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of protected areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-56"><a href="projects-funded-by-the-afd.html#cb43-56" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;AFD funded&quot;</span>, <span class="st">&quot;Low- to upper-middle income*&quot;</span>),</span>
<span id="cb43-57"><a href="projects-funded-by-the-afd.html#cb43-57" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-58"><a href="projects-funded-by-the-afd.html#cb43-58" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb43-59"><a href="projects-funded-by-the-afd.html#cb43-59" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb43-60"><a href="projects-funded-by-the-afd.html#cb43-60" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb43-61"><a href="projects-funded-by-the-afd.html#cb43-61" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb43-62"><a href="projects-funded-by-the-afd.html#cb43-62" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb43-63"><a href="projects-funded-by-the-afd.html#cb43-63" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb43-64"><a href="projects-funded-by-the-afd.html#cb43-64" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-65"><a href="projects-funded-by-the-afd.html#cb43-65" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-66"><a href="projects-funded-by-the-afd.html#cb43-66" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-67"><a href="projects-funded-by-the-afd.html#cb43-67" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb43-68"><a href="projects-funded-by-the-afd.html#cb43-68" tabindex="-1"></a>hist_distrib_reg_vs_n </span>
<span id="cb43-69"><a href="projects-funded-by-the-afd.html#cb43-69" tabindex="-1"></a></span>
<span id="cb43-70"><a href="projects-funded-by-the-afd.html#cb43-70" tabindex="-1"></a><span class="do">## For top AFD, comparison with WDPA in terms of area</span></span>
<span id="cb43-71"><a href="projects-funded-by-the-afd.html#cb43-71" tabindex="-1"></a>hist_distrib_reg_vs_area <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">filter</span>(data_distrib_reg_vs_area, <span class="fu">grepl</span>(<span class="st">&quot;freq&quot;</span>, metric)),</span>
<span id="cb43-72"><a href="projects-funded-by-the-afd.html#cb43-72" tabindex="-1"></a>                                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(region, value), <span class="at">y =</span> value, <span class="at">fill =</span> metric)) <span class="sc">%&gt;%</span></span>
<span id="cb43-73"><a href="projects-funded-by-the-afd.html#cb43-73" tabindex="-1"></a><span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-74"><a href="projects-funded-by-the-afd.html#cb43-74" tabindex="-1"></a><span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of non-marine protected areas across regions (area)&quot;</span>,</span>
<span id="cb43-75"><a href="projects-funded-by-the-afd.html#cb43-75" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">min</span>(data_distrib_reg_wdpa<span class="sc">$</span>n_tot_wdpa), <span class="st">&quot;non-marine protected areas reported by the WDPA -&quot;</span>, <span class="fu">format</span>(<span class="fu">min</span>(data_distrib_reg_wdpa<span class="sc">$</span>area_km2_wdpa_tot), <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;km² - </span><span class="sc">\n</span><span class="st">and&quot;</span>,  <span class="fu">min</span>(data_distrib_reg_afd<span class="sc">$</span>n_tot_afd), <span class="st">&quot;funded by AFD -&quot;</span>, <span class="fu">format</span>(<span class="fu">min</span>(data_distrib_reg_afd<span class="sc">$</span>area_km2_afd_tot) , <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;km² -&quot;</span>),</span>
<span id="cb43-76"><a href="projects-funded-by-the-afd.html#cb43-76" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Note : we consider non-marine PAs reported by the WDPA on the full period covered by the data, in countries that are potential AFD partners.</span><span class="sc">\n</span><span class="st">*These are low-, lower-middle, upper-middle countries according to the World Bank 2022 classification, </span><span class="sc">\n</span><span class="st">excluding Russia and including Uruguay, Panama, Chile, New Caledonia.</span><span class="sc">\n</span><span class="st">A subset of these PAs is AFD funded, though some PAs funded by the AFD are not reported by the WDPA.&quot;</span>,</span>
<span id="cb43-77"><a href="projects-funded-by-the-afd.html#cb43-77" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb43-78"><a href="projects-funded-by-the-afd.html#cb43-78" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Share of areas (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-79"><a href="projects-funded-by-the-afd.html#cb43-79" tabindex="-1"></a><span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;AFD funded&quot;</span>, <span class="st">&quot;Low- to upper-middle income*&quot;</span>),</span>
<span id="cb43-80"><a href="projects-funded-by-the-afd.html#cb43-80" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-81"><a href="projects-funded-by-the-afd.html#cb43-81" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb43-82"><a href="projects-funded-by-the-afd.html#cb43-82" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb43-83"><a href="projects-funded-by-the-afd.html#cb43-83" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb43-84"><a href="projects-funded-by-the-afd.html#cb43-84" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb43-85"><a href="projects-funded-by-the-afd.html#cb43-85" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb43-86"><a href="projects-funded-by-the-afd.html#cb43-86" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb43-87"><a href="projects-funded-by-the-afd.html#cb43-87" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-88"><a href="projects-funded-by-the-afd.html#cb43-88" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-89"><a href="projects-funded-by-the-afd.html#cb43-89" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb43-90"><a href="projects-funded-by-the-afd.html#cb43-90" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb43-91"><a href="projects-funded-by-the-afd.html#cb43-91" tabindex="-1"></a>hist_distrib_reg_vs_area</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="projects-funded-by-the-afd.html#cb44-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb44-2"><a href="projects-funded-by-the-afd.html#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="projects-funded-by-the-afd.html#cb44-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb44-4"><a href="projects-funded-by-the-afd.html#cb44-4" tabindex="-1"></a></span>
<span id="cb44-5"><a href="projects-funded-by-the-afd.html#cb44-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_reg_vs_area.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb44-6"><a href="projects-funded-by-the-afd.html#cb44-6" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_reg_vs_area,</span>
<span id="cb44-7"><a href="projects-funded-by-the-afd.html#cb44-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb44-8"><a href="projects-funded-by-the-afd.html#cb44-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb44-9"><a href="projects-funded-by-the-afd.html#cb44-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;hist_distrib_reg_vs_n.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb44-10"><a href="projects-funded-by-the-afd.html#cb44-10" tabindex="-1"></a>       <span class="at">plot =</span> hist_distrib_reg_vs_n,</span>
<span id="cb44-11"><a href="projects-funded-by-the-afd.html#cb44-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb44-12"><a href="projects-funded-by-the-afd.html#cb44-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb44-13"><a href="projects-funded-by-the-afd.html#cb44-13" tabindex="-1"></a></span>
<span id="cb44-14"><a href="projects-funded-by-the-afd.html#cb44-14" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb44-15"><a href="projects-funded-by-the-afd.html#cb44-15" tabindex="-1"></a></span>
<span id="cb44-16"><a href="projects-funded-by-the-afd.html#cb44-16" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb44-17"><a href="projects-funded-by-the-afd.html#cb44-17" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-18"><a href="projects-funded-by-the-afd.html#cb44-18" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb44-19"><a href="projects-funded-by-the-afd.html#cb44-19" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb44-20"><a href="projects-funded-by-the-afd.html#cb44-20" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb44-21"><a href="projects-funded-by-the-afd.html#cb44-21" tabindex="-1"></a>{</span>
<span id="cb44-22"><a href="projects-funded-by-the-afd.html#cb44-22" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb44-23"><a href="projects-funded-by-the-afd.html#cb44-23" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb44-24"><a href="projects-funded-by-the-afd.html#cb44-24" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb44-25"><a href="projects-funded-by-the-afd.html#cb44-25" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/distribution/wdpa_vs_afd/no_marine&quot;</span>, </span>
<span id="cb44-26"><a href="projects-funded-by-the-afd.html#cb44-26" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-27"><a href="projects-funded-by-the-afd.html#cb44-27" tabindex="-1"></a>  }</span>
<span id="cb44-28"><a href="projects-funded-by-the-afd.html#cb44-28" tabindex="-1"></a></span>
<span id="cb44-29"><a href="projects-funded-by-the-afd.html#cb44-29" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb44-30"><a href="projects-funded-by-the-afd.html#cb44-30" tabindex="-1"></a></span>
<span id="cb44-31"><a href="projects-funded-by-the-afd.html#cb44-31" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
</div>
<div id="surface-of-pas" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Surface of PAs<a href="projects-funded-by-the-afd.html#surface-of-pas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Statistics on PAs surfaces in the different regions and countries.</p>
<div id="distribution-of-surfaces" class="section level4 hasAnchor" number="2.3.4.1">
<h4><span class="header-section-number">2.3.4.1</span> Distribution of surfaces<a href="projects-funded-by-the-afd.html#distribution-of-surfaces" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="projects-funded-by-the-afd.html#cb45-1" tabindex="-1"></a>tbl_distrib_area_no0 <span class="ot">=</span> <span class="fu">summary</span>(</span>
<span id="cb45-2"><a href="projects-funded-by-the-afd.html#cb45-2" tabindex="-1"></a>  <span class="fu">filter</span>(data_stat_nodupl, area_km2 <span class="sc">!=</span> <span class="dv">0</span>)<span class="sc">$</span>area_km2) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="projects-funded-by-the-afd.html#cb45-3" tabindex="-1"></a>  <span class="fu">format</span>(<span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="projects-funded-by-the-afd.html#cb45-4" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="projects-funded-by-the-afd.html#cb45-5" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="projects-funded-by-the-afd.html#cb45-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="projects-funded-by-the-afd.html#cb45-7" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;1st Qu.&quot;</span>,<span class="st">&quot;3rd Qu.&quot;</span>))</span></code></pre></div>
</div>
<div id="average-surface-in-countries-and-regions" class="section level4 hasAnchor" number="2.3.4.2">
<h4><span class="header-section-number">2.3.4.2</span> Average surface in countries and regions<a href="projects-funded-by-the-afd.html#average-surface-in-countries-and-regions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="projects-funded-by-the-afd.html#cb46-1" tabindex="-1"></a><span class="co">#Distribution of PA WITH SURFACE &gt;0 across countries and regions</span></span>
<span id="cb46-2"><a href="projects-funded-by-the-afd.html#cb46-2" tabindex="-1"></a><span class="do">##Country</span></span>
<span id="cb46-3"><a href="projects-funded-by-the-afd.html#cb46-3" tabindex="-1"></a>data_distrib_no0_ctry <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="projects-funded-by-the-afd.html#cb46-4" tabindex="-1"></a>  <span class="fu">filter</span>(area_km2 <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="projects-funded-by-the-afd.html#cb46-5" tabindex="-1"></a>  <span class="fu">group_by</span>(iso3, country_en, country_fr) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="projects-funded-by-the-afd.html#cb46-6" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb46-7"><a href="projects-funded-by-the-afd.html#cb46-7" tabindex="-1"></a>            <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span><span class="fu">nrow</span>(data_stat_nodupl), <span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="projects-funded-by-the-afd.html#cb46-8" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb46-9"><a href="projects-funded-by-the-afd.html#cb46-9" tabindex="-1"></a></span>
<span id="cb46-10"><a href="projects-funded-by-the-afd.html#cb46-10" tabindex="-1"></a><span class="do">##Region</span></span>
<span id="cb46-11"><a href="projects-funded-by-the-afd.html#cb46-11" tabindex="-1"></a>data_distrib_no0_region <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb46-12"><a href="projects-funded-by-the-afd.html#cb46-12" tabindex="-1"></a>  <span class="fu">filter</span>(area_km2 <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="projects-funded-by-the-afd.html#cb46-13" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span></span>
<span id="cb46-14"><a href="projects-funded-by-the-afd.html#cb46-14" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb46-15"><a href="projects-funded-by-the-afd.html#cb46-15" tabindex="-1"></a>            <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span><span class="fu">nrow</span>(data_stat_nodupl), <span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-16"><a href="projects-funded-by-the-afd.html#cb46-16" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb46-17"><a href="projects-funded-by-the-afd.html#cb46-17" tabindex="-1"></a></span>
<span id="cb46-18"><a href="projects-funded-by-the-afd.html#cb46-18" tabindex="-1"></a><span class="co">#By country..</span></span>
<span id="cb46-19"><a href="projects-funded-by-the-afd.html#cb46-19" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb46-20"><a href="projects-funded-by-the-afd.html#cb46-20" tabindex="-1"></a>tbl_area_avg_ctry_fr <span class="ot">=</span> data_distrib_no0_ctry <span class="sc">%&gt;%</span></span>
<span id="cb46-21"><a href="projects-funded-by-the-afd.html#cb46-21" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>freq) <span class="sc">%&gt;%</span></span>
<span id="cb46-22"><a href="projects-funded-by-the-afd.html#cb46-22" tabindex="-1"></a>  <span class="fu">left_join</span>(pa_area_ctry, <span class="at">by =</span> <span class="st">&quot;iso3&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-23"><a href="projects-funded-by-the-afd.html#cb46-23" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(iso3, area_tot_km2, tot_area_int)) <span class="sc">%&gt;%</span></span>
<span id="cb46-24"><a href="projects-funded-by-the-afd.html#cb46-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area_avg_noint_km2 =</span> <span class="fu">format</span>(area_tot_noint_km2<span class="sc">/</span>n, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb46-25"><a href="projects-funded-by-the-afd.html#cb46-25" tabindex="-1"></a>         <span class="at">area_tot_noint_km2 =</span> <span class="fu">format</span>(area_tot_noint_km2, <span class="at">big.mark  =</span> <span class="st">&quot; &quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb46-26"><a href="projects-funded-by-the-afd.html#cb46-26" tabindex="-1"></a>         )</span>
<span id="cb46-27"><a href="projects-funded-by-the-afd.html#cb46-27" tabindex="-1"></a><span class="fu">names</span>(tbl_area_avg_ctry_fr) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Pays&quot;</span>, <span class="st">&quot;Nombre d&#39;AP&quot;</span>, <span class="st">&quot;Superficie totale (km2)&quot;</span>, <span class="st">&quot;Superficie moyenne (km2)&quot;</span>)</span>
<span id="cb46-28"><a href="projects-funded-by-the-afd.html#cb46-28" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb46-29"><a href="projects-funded-by-the-afd.html#cb46-29" tabindex="-1"></a>tbl_area_avg_ctry_en <span class="ot">=</span> data_distrib_no0_ctry <span class="sc">%&gt;%</span></span>
<span id="cb46-30"><a href="projects-funded-by-the-afd.html#cb46-30" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>freq) <span class="sc">%&gt;%</span></span>
<span id="cb46-31"><a href="projects-funded-by-the-afd.html#cb46-31" tabindex="-1"></a>  <span class="fu">left_join</span>(pa_area_ctry, <span class="at">by =</span> <span class="st">&quot;iso3&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-32"><a href="projects-funded-by-the-afd.html#cb46-32" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(iso3, area_tot_km2, tot_area_int)) <span class="sc">%&gt;%</span></span>
<span id="cb46-33"><a href="projects-funded-by-the-afd.html#cb46-33" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area_avg_noint_km2 =</span> <span class="fu">format</span>(area_tot_noint_km2<span class="sc">/</span>n, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb46-34"><a href="projects-funded-by-the-afd.html#cb46-34" tabindex="-1"></a>         <span class="at">area_tot_noint_km2 =</span> <span class="fu">format</span>(area_tot_noint_km2, <span class="at">big.mark  =</span> <span class="st">&quot; &quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb46-35"><a href="projects-funded-by-the-afd.html#cb46-35" tabindex="-1"></a>         )</span>
<span id="cb46-36"><a href="projects-funded-by-the-afd.html#cb46-36" tabindex="-1"></a><span class="fu">names</span>(tbl_area_avg_ctry_en) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;Number of PAs&quot;</span>, <span class="st">&quot;Total area (km2)&quot;</span>, <span class="st">&quot;Average area (km2)&quot;</span>)</span>
<span id="cb46-37"><a href="projects-funded-by-the-afd.html#cb46-37" tabindex="-1"></a></span>
<span id="cb46-38"><a href="projects-funded-by-the-afd.html#cb46-38" tabindex="-1"></a><span class="co">#By region</span></span>
<span id="cb46-39"><a href="projects-funded-by-the-afd.html#cb46-39" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb46-40"><a href="projects-funded-by-the-afd.html#cb46-40" tabindex="-1"></a>tbl_area_avg_region_fr <span class="ot">=</span> data_distrib_no0_region <span class="sc">%&gt;%</span></span>
<span id="cb46-41"><a href="projects-funded-by-the-afd.html#cb46-41" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>freq) <span class="sc">%&gt;%</span></span>
<span id="cb46-42"><a href="projects-funded-by-the-afd.html#cb46-42" tabindex="-1"></a>  <span class="fu">left_join</span>(pa_area_region, <span class="at">by =</span> <span class="st">&quot;region&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-43"><a href="projects-funded-by-the-afd.html#cb46-43" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(area_tot_km2, tot_area_int, region)) <span class="sc">%&gt;%</span></span>
<span id="cb46-44"><a href="projects-funded-by-the-afd.html#cb46-44" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area_avg_noint_km2 =</span> <span class="fu">format</span>(area_tot_noint_km2<span class="sc">/</span>n, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb46-45"><a href="projects-funded-by-the-afd.html#cb46-45" tabindex="-1"></a>         <span class="at">area_tot_noint_km2 =</span> <span class="fu">format</span>(area_tot_noint_km2, <span class="at">big.mark  =</span> <span class="st">&quot; &quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb46-46"><a href="projects-funded-by-the-afd.html#cb46-46" tabindex="-1"></a>         )</span>
<span id="cb46-47"><a href="projects-funded-by-the-afd.html#cb46-47" tabindex="-1"></a><span class="fu">names</span>(tbl_area_avg_region_fr) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Région&quot;</span>, <span class="st">&quot;Nombre d&#39;AP&quot;</span>, <span class="st">&quot;Superficie totale (km2)&quot;</span>, <span class="st">&quot;Superficie moyenne (km2)&quot;</span>)</span>
<span id="cb46-48"><a href="projects-funded-by-the-afd.html#cb46-48" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb46-49"><a href="projects-funded-by-the-afd.html#cb46-49" tabindex="-1"></a>tbl_area_avg_region_en <span class="ot">=</span> data_distrib_no0_region <span class="sc">%&gt;%</span></span>
<span id="cb46-50"><a href="projects-funded-by-the-afd.html#cb46-50" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>freq) <span class="sc">%&gt;%</span></span>
<span id="cb46-51"><a href="projects-funded-by-the-afd.html#cb46-51" tabindex="-1"></a>  <span class="fu">left_join</span>(pa_area_region, <span class="at">by =</span> <span class="st">&quot;region&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-52"><a href="projects-funded-by-the-afd.html#cb46-52" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(area_tot_km2, tot_area_int, region)) <span class="sc">%&gt;%</span></span>
<span id="cb46-53"><a href="projects-funded-by-the-afd.html#cb46-53" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area_avg_noint_km2 =</span> <span class="fu">format</span>(area_tot_noint_km2<span class="sc">/</span>n, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb46-54"><a href="projects-funded-by-the-afd.html#cb46-54" tabindex="-1"></a>         <span class="at">area_tot_noint_km2 =</span> <span class="fu">format</span>(area_tot_noint_km2, <span class="at">big.mark  =</span> <span class="st">&quot; &quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb46-55"><a href="projects-funded-by-the-afd.html#cb46-55" tabindex="-1"></a>         )</span>
<span id="cb46-56"><a href="projects-funded-by-the-afd.html#cb46-56" tabindex="-1"></a><span class="fu">names</span>(tbl_area_avg_region_en) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Rgion&quot;</span>, <span class="st">&quot;Number of PAs&quot;</span>, <span class="st">&quot;Total area (km2)&quot;</span>, <span class="st">&quot;Average area (km2)&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="projects-funded-by-the-afd.html#cb47-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb47-2"><a href="projects-funded-by-the-afd.html#cb47-2" tabindex="-1"></a></span>
<span id="cb47-3"><a href="projects-funded-by-the-afd.html#cb47-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb47-4"><a href="projects-funded-by-the-afd.html#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="projects-funded-by-the-afd.html#cb47-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_distrib_area_no0, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb47-6"><a href="projects-funded-by-the-afd.html#cb47-6" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_distrib_area_no0.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb47-7"><a href="projects-funded-by-the-afd.html#cb47-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_area_avg_ctry_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb47-8"><a href="projects-funded-by-the-afd.html#cb47-8" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_area_avg_ctry_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb47-9"><a href="projects-funded-by-the-afd.html#cb47-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_area_avg_ctry_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb47-10"><a href="projects-funded-by-the-afd.html#cb47-10" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_area_avg_ctry_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb47-11"><a href="projects-funded-by-the-afd.html#cb47-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_area_avg_region_fr, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb47-12"><a href="projects-funded-by-the-afd.html#cb47-12" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_area_avg_region_fr.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb47-13"><a href="projects-funded-by-the-afd.html#cb47-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_area_avg_region_en, <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>), </span>
<span id="cb47-14"><a href="projects-funded-by-the-afd.html#cb47-14" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_area_avg_region_en.tex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>))</span>
<span id="cb47-15"><a href="projects-funded-by-the-afd.html#cb47-15" tabindex="-1"></a></span>
<span id="cb47-16"><a href="projects-funded-by-the-afd.html#cb47-16" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb47-17"><a href="projects-funded-by-the-afd.html#cb47-17" tabindex="-1"></a></span>
<span id="cb47-18"><a href="projects-funded-by-the-afd.html#cb47-18" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb47-19"><a href="projects-funded-by-the-afd.html#cb47-19" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-20"><a href="projects-funded-by-the-afd.html#cb47-20" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb47-21"><a href="projects-funded-by-the-afd.html#cb47-21" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb47-22"><a href="projects-funded-by-the-afd.html#cb47-22" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb47-23"><a href="projects-funded-by-the-afd.html#cb47-23" tabindex="-1"></a>{</span>
<span id="cb47-24"><a href="projects-funded-by-the-afd.html#cb47-24" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-25"><a href="projects-funded-by-the-afd.html#cb47-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb47-26"><a href="projects-funded-by-the-afd.html#cb47-26" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb47-27"><a href="projects-funded-by-the-afd.html#cb47-27" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/surface/world&quot;</span>, </span>
<span id="cb47-28"><a href="projects-funded-by-the-afd.html#cb47-28" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-29"><a href="projects-funded-by-the-afd.html#cb47-29" tabindex="-1"></a>  }</span>
<span id="cb47-30"><a href="projects-funded-by-the-afd.html#cb47-30" tabindex="-1"></a></span>
<span id="cb47-31"><a href="projects-funded-by-the-afd.html#cb47-31" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb47-32"><a href="projects-funded-by-the-afd.html#cb47-32" tabindex="-1"></a></span>
<span id="cb47-33"><a href="projects-funded-by-the-afd.html#cb47-33" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
</div>
<div id="temporal-evolution" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Temporal evolution<a href="projects-funded-by-the-afd.html#temporal-evolution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="number-of-pas-world-all" class="section level4 hasAnchor" number="2.3.5.1">
<h4><span class="header-section-number">2.3.5.1</span> Number of PAs (world, all)<a href="projects-funded-by-the-afd.html#number-of-pas-world-all" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="projects-funded-by-the-afd.html#cb48-1" tabindex="-1"></a>data_time_range <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">year =</span> </span>
<span id="cb48-2"><a href="projects-funded-by-the-afd.html#cb48-2" tabindex="-1"></a>                              <span class="fu">c</span>(<span class="fu">min</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">:</span><span class="fu">max</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb48-3"><a href="projects-funded-by-the-afd.html#cb48-3" tabindex="-1"></a>)</span>
<span id="cb48-4"><a href="projects-funded-by-the-afd.html#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="projects-funded-by-the-afd.html#cb48-5" tabindex="-1"></a></span>
<span id="cb48-6"><a href="projects-funded-by-the-afd.html#cb48-6" tabindex="-1"></a>data_time_n <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="projects-funded-by-the-afd.html#cb48-7" tabindex="-1"></a>  <span class="co">#filter(is.na(year_funding_first) == FALSE) %&gt;%</span></span>
<span id="cb48-8"><a href="projects-funded-by-the-afd.html#cb48-8" tabindex="-1"></a>  <span class="fu">group_by</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="projects-funded-by-the-afd.html#cb48-9" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="projects-funded-by-the-afd.html#cb48-10" tabindex="-1"></a>  <span class="fu">full_join</span>(data_time_range, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;year&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="projects-funded-by-the-afd.html#cb48-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(n)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>n)) <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="projects-funded-by-the-afd.html#cb48-12" tabindex="-1"></a>  <span class="fu">arrange</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb48-13"><a href="projects-funded-by-the-afd.html#cb48-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_cum =</span> <span class="fu">cumsum</span>(n)) </span>
<span id="cb48-14"><a href="projects-funded-by-the-afd.html#cb48-14" tabindex="-1"></a></span>
<span id="cb48-15"><a href="projects-funded-by-the-afd.html#cb48-15" tabindex="-1"></a><span class="co">#Number of PAs funded by year </span></span>
<span id="cb48-16"><a href="projects-funded-by-the-afd.html#cb48-16" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb48-17"><a href="projects-funded-by-the-afd.html#cb48-17" tabindex="-1"></a>fig_n_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb48-18"><a href="projects-funded-by-the-afd.html#cb48-18" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n)) <span class="sc">%&gt;%</span></span>
<span id="cb48-19"><a href="projects-funded-by-the-afd.html#cb48-19" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-20"><a href="projects-funded-by-the-afd.html#cb48-20" tabindex="-1"></a>  <span class="co"># + geom_text(aes(y = n, label = ifelse(n == 0, NA, n)), </span></span>
<span id="cb48-21"><a href="projects-funded-by-the-afd.html#cb48-21" tabindex="-1"></a>  <span class="co">#             color = &quot;black&quot;, size=4, vjust = -0.3) %&gt;%</span></span>
<span id="cb48-22"><a href="projects-funded-by-the-afd.html#cb48-22" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Nombre d&#39;aires protégées appuyées par année par l&#39;AFD&quot;</span>,</span>
<span id="cb48-23"><a href="projects-funded-by-the-afd.html#cb48-23" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb48-24"><a href="projects-funded-by-the-afd.html#cb48-24" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Sur les&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;aires protégées financées recensées,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;ont une date de financement inconnue.&quot;</span>),</span>
<span id="cb48-25"><a href="projects-funded-by-the-afd.html#cb48-25" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb48-26"><a href="projects-funded-by-the-afd.html#cb48-26" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Nombre d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-27"><a href="projects-funded-by-the-afd.html#cb48-27" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb48-28"><a href="projects-funded-by-the-afd.html#cb48-28" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb48-29"><a href="projects-funded-by-the-afd.html#cb48-29" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb48-30"><a href="projects-funded-by-the-afd.html#cb48-30" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb48-31"><a href="projects-funded-by-the-afd.html#cb48-31" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb48-32"><a href="projects-funded-by-the-afd.html#cb48-32" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb48-33"><a href="projects-funded-by-the-afd.html#cb48-33" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-34"><a href="projects-funded-by-the-afd.html#cb48-34" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-35"><a href="projects-funded-by-the-afd.html#cb48-35" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-36"><a href="projects-funded-by-the-afd.html#cb48-36" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb48-37"><a href="projects-funded-by-the-afd.html#cb48-37" tabindex="-1"></a>fig_n_pa_fr</span>
<span id="cb48-38"><a href="projects-funded-by-the-afd.html#cb48-38" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb48-39"><a href="projects-funded-by-the-afd.html#cb48-39" tabindex="-1"></a>fig_n_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb48-40"><a href="projects-funded-by-the-afd.html#cb48-40" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n)) <span class="sc">%&gt;%</span></span>
<span id="cb48-41"><a href="projects-funded-by-the-afd.html#cb48-41" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-42"><a href="projects-funded-by-the-afd.html#cb48-42" tabindex="-1"></a>  <span class="co"># + geom_text(aes(y = n, label = ifelse(n == 0, NA, n)), </span></span>
<span id="cb48-43"><a href="projects-funded-by-the-afd.html#cb48-43" tabindex="-1"></a>  <span class="co">#             color = &quot;black&quot;, size=4, vjust = -0.3) %&gt;%</span></span>
<span id="cb48-44"><a href="projects-funded-by-the-afd.html#cb48-44" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of protected areas funded each year by AFD&quot;</span>,</span>
<span id="cb48-45"><a href="projects-funded-by-the-afd.html#cb48-45" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb48-46"><a href="projects-funded-by-the-afd.html#cb48-46" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Out of&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;known funded protected areas,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;have unknown funding year.&quot;</span>),</span>
<span id="cb48-47"><a href="projects-funded-by-the-afd.html#cb48-47" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb48-48"><a href="projects-funded-by-the-afd.html#cb48-48" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-49"><a href="projects-funded-by-the-afd.html#cb48-49" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb48-50"><a href="projects-funded-by-the-afd.html#cb48-50" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb48-51"><a href="projects-funded-by-the-afd.html#cb48-51" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb48-52"><a href="projects-funded-by-the-afd.html#cb48-52" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb48-53"><a href="projects-funded-by-the-afd.html#cb48-53" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb48-54"><a href="projects-funded-by-the-afd.html#cb48-54" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb48-55"><a href="projects-funded-by-the-afd.html#cb48-55" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-56"><a href="projects-funded-by-the-afd.html#cb48-56" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-57"><a href="projects-funded-by-the-afd.html#cb48-57" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-58"><a href="projects-funded-by-the-afd.html#cb48-58" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb48-59"><a href="projects-funded-by-the-afd.html#cb48-59" tabindex="-1"></a>fig_n_pa_en</span>
<span id="cb48-60"><a href="projects-funded-by-the-afd.html#cb48-60" tabindex="-1"></a></span>
<span id="cb48-61"><a href="projects-funded-by-the-afd.html#cb48-61" tabindex="-1"></a></span>
<span id="cb48-62"><a href="projects-funded-by-the-afd.html#cb48-62" tabindex="-1"></a><span class="co">#Cumulative number over time</span></span>
<span id="cb48-63"><a href="projects-funded-by-the-afd.html#cb48-63" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb48-64"><a href="projects-funded-by-the-afd.html#cb48-64" tabindex="-1"></a>fig_ncum_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb48-65"><a href="projects-funded-by-the-afd.html#cb48-65" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n_cum)) <span class="sc">%&gt;%</span></span>
<span id="cb48-66"><a href="projects-funded-by-the-afd.html#cb48-66" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb48-67"><a href="projects-funded-by-the-afd.html#cb48-67" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb48-68"><a href="projects-funded-by-the-afd.html#cb48-68" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-69"><a href="projects-funded-by-the-afd.html#cb48-69" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> n_cum, <span class="at">label =</span> n_cum), </span>
<span id="cb48-70"><a href="projects-funded-by-the-afd.html#cb48-70" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-71"><a href="projects-funded-by-the-afd.html#cb48-71" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolution cumulée du nombre d&#39;aires protégées appuyées par l&#39;AFD&quot;</span>,</span>
<span id="cb48-72"><a href="projects-funded-by-the-afd.html#cb48-72" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb48-73"><a href="projects-funded-by-the-afd.html#cb48-73" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Sur les&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;aires protégées financées recensées,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;ont une date de financement inconnue.&quot;</span>),</span>
<span id="cb48-74"><a href="projects-funded-by-the-afd.html#cb48-74" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb48-75"><a href="projects-funded-by-the-afd.html#cb48-75" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Nombre d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-76"><a href="projects-funded-by-the-afd.html#cb48-76" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb48-77"><a href="projects-funded-by-the-afd.html#cb48-77" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb48-78"><a href="projects-funded-by-the-afd.html#cb48-78" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb48-79"><a href="projects-funded-by-the-afd.html#cb48-79" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb48-80"><a href="projects-funded-by-the-afd.html#cb48-80" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb48-81"><a href="projects-funded-by-the-afd.html#cb48-81" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb48-82"><a href="projects-funded-by-the-afd.html#cb48-82" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-83"><a href="projects-funded-by-the-afd.html#cb48-83" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-84"><a href="projects-funded-by-the-afd.html#cb48-84" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-85"><a href="projects-funded-by-the-afd.html#cb48-85" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb48-86"><a href="projects-funded-by-the-afd.html#cb48-86" tabindex="-1"></a>fig_ncum_pa_fr</span>
<span id="cb48-87"><a href="projects-funded-by-the-afd.html#cb48-87" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb48-88"><a href="projects-funded-by-the-afd.html#cb48-88" tabindex="-1"></a>fig_ncum_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb48-89"><a href="projects-funded-by-the-afd.html#cb48-89" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n_cum)) <span class="sc">%&gt;%</span></span>
<span id="cb48-90"><a href="projects-funded-by-the-afd.html#cb48-90" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb48-91"><a href="projects-funded-by-the-afd.html#cb48-91" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb48-92"><a href="projects-funded-by-the-afd.html#cb48-92" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-93"><a href="projects-funded-by-the-afd.html#cb48-93" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> n_cum, <span class="at">label =</span> n_cum), </span>
<span id="cb48-94"><a href="projects-funded-by-the-afd.html#cb48-94" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-95"><a href="projects-funded-by-the-afd.html#cb48-95" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cumulative number of protected areas funded by AFD&quot;</span>,</span>
<span id="cb48-96"><a href="projects-funded-by-the-afd.html#cb48-96" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb48-97"><a href="projects-funded-by-the-afd.html#cb48-97" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Out of&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;known funded protected areas,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;have unknown funding year.&quot;</span>),</span>
<span id="cb48-98"><a href="projects-funded-by-the-afd.html#cb48-98" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb48-99"><a href="projects-funded-by-the-afd.html#cb48-99" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Number of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-100"><a href="projects-funded-by-the-afd.html#cb48-100" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb48-101"><a href="projects-funded-by-the-afd.html#cb48-101" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb48-102"><a href="projects-funded-by-the-afd.html#cb48-102" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb48-103"><a href="projects-funded-by-the-afd.html#cb48-103" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb48-104"><a href="projects-funded-by-the-afd.html#cb48-104" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb48-105"><a href="projects-funded-by-the-afd.html#cb48-105" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb48-106"><a href="projects-funded-by-the-afd.html#cb48-106" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-107"><a href="projects-funded-by-the-afd.html#cb48-107" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-108"><a href="projects-funded-by-the-afd.html#cb48-108" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb48-109"><a href="projects-funded-by-the-afd.html#cb48-109" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb48-110"><a href="projects-funded-by-the-afd.html#cb48-110" tabindex="-1"></a>fig_ncum_pa_en</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="projects-funded-by-the-afd.html#cb49-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb49-2"><a href="projects-funded-by-the-afd.html#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="projects-funded-by-the-afd.html#cb49-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb49-4"><a href="projects-funded-by-the-afd.html#cb49-4" tabindex="-1"></a></span>
<span id="cb49-5"><a href="projects-funded-by-the-afd.html#cb49-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_n_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb49-6"><a href="projects-funded-by-the-afd.html#cb49-6" tabindex="-1"></a>       fig_n_pa_fr,</span>
<span id="cb49-7"><a href="projects-funded-by-the-afd.html#cb49-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb49-8"><a href="projects-funded-by-the-afd.html#cb49-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb49-9"><a href="projects-funded-by-the-afd.html#cb49-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_n_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb49-10"><a href="projects-funded-by-the-afd.html#cb49-10" tabindex="-1"></a>       fig_n_pa_en,</span>
<span id="cb49-11"><a href="projects-funded-by-the-afd.html#cb49-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb49-12"><a href="projects-funded-by-the-afd.html#cb49-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb49-13"><a href="projects-funded-by-the-afd.html#cb49-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_ncum_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb49-14"><a href="projects-funded-by-the-afd.html#cb49-14" tabindex="-1"></a>       fig_ncum_pa_fr,</span>
<span id="cb49-15"><a href="projects-funded-by-the-afd.html#cb49-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb49-16"><a href="projects-funded-by-the-afd.html#cb49-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb49-17"><a href="projects-funded-by-the-afd.html#cb49-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_ncum_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb49-18"><a href="projects-funded-by-the-afd.html#cb49-18" tabindex="-1"></a>       fig_ncum_pa_en,</span>
<span id="cb49-19"><a href="projects-funded-by-the-afd.html#cb49-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb49-20"><a href="projects-funded-by-the-afd.html#cb49-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb49-21"><a href="projects-funded-by-the-afd.html#cb49-21" tabindex="-1"></a></span>
<span id="cb49-22"><a href="projects-funded-by-the-afd.html#cb49-22" tabindex="-1"></a></span>
<span id="cb49-23"><a href="projects-funded-by-the-afd.html#cb49-23" tabindex="-1"></a></span>
<span id="cb49-24"><a href="projects-funded-by-the-afd.html#cb49-24" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb49-25"><a href="projects-funded-by-the-afd.html#cb49-25" tabindex="-1"></a></span>
<span id="cb49-26"><a href="projects-funded-by-the-afd.html#cb49-26" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb49-27"><a href="projects-funded-by-the-afd.html#cb49-27" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-28"><a href="projects-funded-by-the-afd.html#cb49-28" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb49-29"><a href="projects-funded-by-the-afd.html#cb49-29" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb49-30"><a href="projects-funded-by-the-afd.html#cb49-30" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb49-31"><a href="projects-funded-by-the-afd.html#cb49-31" tabindex="-1"></a>{</span>
<span id="cb49-32"><a href="projects-funded-by-the-afd.html#cb49-32" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb49-33"><a href="projects-funded-by-the-afd.html#cb49-33" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb49-34"><a href="projects-funded-by-the-afd.html#cb49-34" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb49-35"><a href="projects-funded-by-the-afd.html#cb49-35" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/time_evolution/world/all&quot;</span>, </span>
<span id="cb49-36"><a href="projects-funded-by-the-afd.html#cb49-36" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-37"><a href="projects-funded-by-the-afd.html#cb49-37" tabindex="-1"></a>  }</span>
<span id="cb49-38"><a href="projects-funded-by-the-afd.html#cb49-38" tabindex="-1"></a></span>
<span id="cb49-39"><a href="projects-funded-by-the-afd.html#cb49-39" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb49-40"><a href="projects-funded-by-the-afd.html#cb49-40" tabindex="-1"></a></span>
<span id="cb49-41"><a href="projects-funded-by-the-afd.html#cb49-41" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="number-of-pas-world-non-marine" class="section level4 hasAnchor" number="2.3.5.2">
<h4><span class="header-section-number">2.3.5.2</span> Number of PAs (world, non-marine)<a href="projects-funded-by-the-afd.html#number-of-pas-world-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="projects-funded-by-the-afd.html#cb50-1" tabindex="-1"></a>data_time_range <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">year =</span> </span>
<span id="cb50-2"><a href="projects-funded-by-the-afd.html#cb50-2" tabindex="-1"></a>                              <span class="fu">c</span>(<span class="fu">min</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">:</span><span class="fu">max</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb50-3"><a href="projects-funded-by-the-afd.html#cb50-3" tabindex="-1"></a>)</span>
<span id="cb50-4"><a href="projects-funded-by-the-afd.html#cb50-4" tabindex="-1"></a></span>
<span id="cb50-5"><a href="projects-funded-by-the-afd.html#cb50-5" tabindex="-1"></a></span>
<span id="cb50-6"><a href="projects-funded-by-the-afd.html#cb50-6" tabindex="-1"></a>data_time_n <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="projects-funded-by-the-afd.html#cb50-7" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="projects-funded-by-the-afd.html#cb50-8" tabindex="-1"></a>  <span class="co">#filter(is.na(year_funding_first) == FALSE) %&gt;%</span></span>
<span id="cb50-9"><a href="projects-funded-by-the-afd.html#cb50-9" tabindex="-1"></a>  <span class="fu">group_by</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="projects-funded-by-the-afd.html#cb50-10" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb50-11"><a href="projects-funded-by-the-afd.html#cb50-11" tabindex="-1"></a>  <span class="fu">full_join</span>(data_time_range, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;year&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-12"><a href="projects-funded-by-the-afd.html#cb50-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(n)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>n)) <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="projects-funded-by-the-afd.html#cb50-13" tabindex="-1"></a>  <span class="fu">arrange</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb50-14"><a href="projects-funded-by-the-afd.html#cb50-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_cum =</span> <span class="fu">cumsum</span>(n)) </span>
<span id="cb50-15"><a href="projects-funded-by-the-afd.html#cb50-15" tabindex="-1"></a></span>
<span id="cb50-16"><a href="projects-funded-by-the-afd.html#cb50-16" tabindex="-1"></a><span class="co">#Number of PAs funded by year </span></span>
<span id="cb50-17"><a href="projects-funded-by-the-afd.html#cb50-17" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb50-18"><a href="projects-funded-by-the-afd.html#cb50-18" tabindex="-1"></a>fig_n_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb50-19"><a href="projects-funded-by-the-afd.html#cb50-19" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n)) <span class="sc">%&gt;%</span></span>
<span id="cb50-20"><a href="projects-funded-by-the-afd.html#cb50-20" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-21"><a href="projects-funded-by-the-afd.html#cb50-21" tabindex="-1"></a>  <span class="co"># + geom_text(aes(y = n, label = ifelse(n == 0, NA, n)), </span></span>
<span id="cb50-22"><a href="projects-funded-by-the-afd.html#cb50-22" tabindex="-1"></a>  <span class="co">#             color = &quot;black&quot;, size=4, vjust = -0.3) %&gt;%</span></span>
<span id="cb50-23"><a href="projects-funded-by-the-afd.html#cb50-23" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Nombre d&#39;aires protégées non-marines appuyées par année par l&#39;AFD&quot;</span>,</span>
<span id="cb50-24"><a href="projects-funded-by-the-afd.html#cb50-24" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb50-25"><a href="projects-funded-by-the-afd.html#cb50-25" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Sur les&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;aires protégées non-marines financées recensées,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;ont une date de financement inconnue.&quot;</span>),</span>
<span id="cb50-26"><a href="projects-funded-by-the-afd.html#cb50-26" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb50-27"><a href="projects-funded-by-the-afd.html#cb50-27" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Nombre d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-28"><a href="projects-funded-by-the-afd.html#cb50-28" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb50-29"><a href="projects-funded-by-the-afd.html#cb50-29" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb50-30"><a href="projects-funded-by-the-afd.html#cb50-30" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb50-31"><a href="projects-funded-by-the-afd.html#cb50-31" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb50-32"><a href="projects-funded-by-the-afd.html#cb50-32" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb50-33"><a href="projects-funded-by-the-afd.html#cb50-33" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb50-34"><a href="projects-funded-by-the-afd.html#cb50-34" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-35"><a href="projects-funded-by-the-afd.html#cb50-35" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-36"><a href="projects-funded-by-the-afd.html#cb50-36" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-37"><a href="projects-funded-by-the-afd.html#cb50-37" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb50-38"><a href="projects-funded-by-the-afd.html#cb50-38" tabindex="-1"></a>fig_n_pa_fr</span>
<span id="cb50-39"><a href="projects-funded-by-the-afd.html#cb50-39" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb50-40"><a href="projects-funded-by-the-afd.html#cb50-40" tabindex="-1"></a>fig_n_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb50-41"><a href="projects-funded-by-the-afd.html#cb50-41" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n)) <span class="sc">%&gt;%</span></span>
<span id="cb50-42"><a href="projects-funded-by-the-afd.html#cb50-42" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-43"><a href="projects-funded-by-the-afd.html#cb50-43" tabindex="-1"></a>  <span class="co"># + geom_text(aes(y = n, label = ifelse(n == 0, NA, n)), </span></span>
<span id="cb50-44"><a href="projects-funded-by-the-afd.html#cb50-44" tabindex="-1"></a>  <span class="co">#             color = &quot;black&quot;, size=4, vjust = -0.3) %&gt;%</span></span>
<span id="cb50-45"><a href="projects-funded-by-the-afd.html#cb50-45" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of non-marine protected areas funded each year by AFD&quot;</span>,</span>
<span id="cb50-46"><a href="projects-funded-by-the-afd.html#cb50-46" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb50-47"><a href="projects-funded-by-the-afd.html#cb50-47" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Out of&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;known, non-marine funded protected areas,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;have unknown funding year.&quot;</span>),</span>
<span id="cb50-48"><a href="projects-funded-by-the-afd.html#cb50-48" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb50-49"><a href="projects-funded-by-the-afd.html#cb50-49" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Number of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-50"><a href="projects-funded-by-the-afd.html#cb50-50" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb50-51"><a href="projects-funded-by-the-afd.html#cb50-51" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb50-52"><a href="projects-funded-by-the-afd.html#cb50-52" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb50-53"><a href="projects-funded-by-the-afd.html#cb50-53" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb50-54"><a href="projects-funded-by-the-afd.html#cb50-54" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb50-55"><a href="projects-funded-by-the-afd.html#cb50-55" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb50-56"><a href="projects-funded-by-the-afd.html#cb50-56" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-57"><a href="projects-funded-by-the-afd.html#cb50-57" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-58"><a href="projects-funded-by-the-afd.html#cb50-58" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-59"><a href="projects-funded-by-the-afd.html#cb50-59" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb50-60"><a href="projects-funded-by-the-afd.html#cb50-60" tabindex="-1"></a>fig_n_pa_en</span>
<span id="cb50-61"><a href="projects-funded-by-the-afd.html#cb50-61" tabindex="-1"></a></span>
<span id="cb50-62"><a href="projects-funded-by-the-afd.html#cb50-62" tabindex="-1"></a></span>
<span id="cb50-63"><a href="projects-funded-by-the-afd.html#cb50-63" tabindex="-1"></a><span class="co">#Cumulative number over time</span></span>
<span id="cb50-64"><a href="projects-funded-by-the-afd.html#cb50-64" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb50-65"><a href="projects-funded-by-the-afd.html#cb50-65" tabindex="-1"></a>fig_ncum_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb50-66"><a href="projects-funded-by-the-afd.html#cb50-66" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n_cum)) <span class="sc">%&gt;%</span></span>
<span id="cb50-67"><a href="projects-funded-by-the-afd.html#cb50-67" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb50-68"><a href="projects-funded-by-the-afd.html#cb50-68" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb50-69"><a href="projects-funded-by-the-afd.html#cb50-69" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-70"><a href="projects-funded-by-the-afd.html#cb50-70" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> n_cum, <span class="at">label =</span> n_cum), </span>
<span id="cb50-71"><a href="projects-funded-by-the-afd.html#cb50-71" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-72"><a href="projects-funded-by-the-afd.html#cb50-72" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolution cumulée du nombre d&#39;aires protégées non-marines appuyées par l&#39;AFD&quot;</span>,</span>
<span id="cb50-73"><a href="projects-funded-by-the-afd.html#cb50-73" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb50-74"><a href="projects-funded-by-the-afd.html#cb50-74" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Sur les&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;aires protégées non-marines financées recensées,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;ont une date de financement inconnue.&quot;</span>),</span>
<span id="cb50-75"><a href="projects-funded-by-the-afd.html#cb50-75" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb50-76"><a href="projects-funded-by-the-afd.html#cb50-76" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Nombre d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-77"><a href="projects-funded-by-the-afd.html#cb50-77" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb50-78"><a href="projects-funded-by-the-afd.html#cb50-78" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb50-79"><a href="projects-funded-by-the-afd.html#cb50-79" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb50-80"><a href="projects-funded-by-the-afd.html#cb50-80" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb50-81"><a href="projects-funded-by-the-afd.html#cb50-81" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb50-82"><a href="projects-funded-by-the-afd.html#cb50-82" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb50-83"><a href="projects-funded-by-the-afd.html#cb50-83" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-84"><a href="projects-funded-by-the-afd.html#cb50-84" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-85"><a href="projects-funded-by-the-afd.html#cb50-85" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-86"><a href="projects-funded-by-the-afd.html#cb50-86" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb50-87"><a href="projects-funded-by-the-afd.html#cb50-87" tabindex="-1"></a>fig_ncum_pa_fr</span>
<span id="cb50-88"><a href="projects-funded-by-the-afd.html#cb50-88" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb50-89"><a href="projects-funded-by-the-afd.html#cb50-89" tabindex="-1"></a>fig_ncum_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb50-90"><a href="projects-funded-by-the-afd.html#cb50-90" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n_cum)) <span class="sc">%&gt;%</span></span>
<span id="cb50-91"><a href="projects-funded-by-the-afd.html#cb50-91" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb50-92"><a href="projects-funded-by-the-afd.html#cb50-92" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb50-93"><a href="projects-funded-by-the-afd.html#cb50-93" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-94"><a href="projects-funded-by-the-afd.html#cb50-94" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> n_cum, <span class="at">label =</span> n_cum), </span>
<span id="cb50-95"><a href="projects-funded-by-the-afd.html#cb50-95" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-96"><a href="projects-funded-by-the-afd.html#cb50-96" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cumulative number of non-marine protected areas funded by AFD&quot;</span>,</span>
<span id="cb50-97"><a href="projects-funded-by-the-afd.html#cb50-97" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb50-98"><a href="projects-funded-by-the-afd.html#cb50-98" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Out of&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;known, non-marine funded protected areas,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;have unknown funding year.&quot;</span>),</span>
<span id="cb50-99"><a href="projects-funded-by-the-afd.html#cb50-99" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb50-100"><a href="projects-funded-by-the-afd.html#cb50-100" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Number of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-101"><a href="projects-funded-by-the-afd.html#cb50-101" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb50-102"><a href="projects-funded-by-the-afd.html#cb50-102" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb50-103"><a href="projects-funded-by-the-afd.html#cb50-103" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb50-104"><a href="projects-funded-by-the-afd.html#cb50-104" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb50-105"><a href="projects-funded-by-the-afd.html#cb50-105" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb50-106"><a href="projects-funded-by-the-afd.html#cb50-106" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb50-107"><a href="projects-funded-by-the-afd.html#cb50-107" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-108"><a href="projects-funded-by-the-afd.html#cb50-108" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-109"><a href="projects-funded-by-the-afd.html#cb50-109" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb50-110"><a href="projects-funded-by-the-afd.html#cb50-110" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb50-111"><a href="projects-funded-by-the-afd.html#cb50-111" tabindex="-1"></a>fig_ncum_pa_en</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="projects-funded-by-the-afd.html#cb51-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb51-2"><a href="projects-funded-by-the-afd.html#cb51-2" tabindex="-1"></a></span>
<span id="cb51-3"><a href="projects-funded-by-the-afd.html#cb51-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb51-4"><a href="projects-funded-by-the-afd.html#cb51-4" tabindex="-1"></a></span>
<span id="cb51-5"><a href="projects-funded-by-the-afd.html#cb51-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_n_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb51-6"><a href="projects-funded-by-the-afd.html#cb51-6" tabindex="-1"></a>       fig_n_pa_fr,</span>
<span id="cb51-7"><a href="projects-funded-by-the-afd.html#cb51-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb51-8"><a href="projects-funded-by-the-afd.html#cb51-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb51-9"><a href="projects-funded-by-the-afd.html#cb51-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_n_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb51-10"><a href="projects-funded-by-the-afd.html#cb51-10" tabindex="-1"></a>       fig_n_pa_en,</span>
<span id="cb51-11"><a href="projects-funded-by-the-afd.html#cb51-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb51-12"><a href="projects-funded-by-the-afd.html#cb51-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb51-13"><a href="projects-funded-by-the-afd.html#cb51-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_ncum_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb51-14"><a href="projects-funded-by-the-afd.html#cb51-14" tabindex="-1"></a>       fig_ncum_pa_fr,</span>
<span id="cb51-15"><a href="projects-funded-by-the-afd.html#cb51-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb51-16"><a href="projects-funded-by-the-afd.html#cb51-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb51-17"><a href="projects-funded-by-the-afd.html#cb51-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_ncum_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb51-18"><a href="projects-funded-by-the-afd.html#cb51-18" tabindex="-1"></a>       fig_ncum_pa_en,</span>
<span id="cb51-19"><a href="projects-funded-by-the-afd.html#cb51-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb51-20"><a href="projects-funded-by-the-afd.html#cb51-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb51-21"><a href="projects-funded-by-the-afd.html#cb51-21" tabindex="-1"></a></span>
<span id="cb51-22"><a href="projects-funded-by-the-afd.html#cb51-22" tabindex="-1"></a></span>
<span id="cb51-23"><a href="projects-funded-by-the-afd.html#cb51-23" tabindex="-1"></a></span>
<span id="cb51-24"><a href="projects-funded-by-the-afd.html#cb51-24" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb51-25"><a href="projects-funded-by-the-afd.html#cb51-25" tabindex="-1"></a></span>
<span id="cb51-26"><a href="projects-funded-by-the-afd.html#cb51-26" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb51-27"><a href="projects-funded-by-the-afd.html#cb51-27" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-28"><a href="projects-funded-by-the-afd.html#cb51-28" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb51-29"><a href="projects-funded-by-the-afd.html#cb51-29" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb51-30"><a href="projects-funded-by-the-afd.html#cb51-30" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb51-31"><a href="projects-funded-by-the-afd.html#cb51-31" tabindex="-1"></a>{</span>
<span id="cb51-32"><a href="projects-funded-by-the-afd.html#cb51-32" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb51-33"><a href="projects-funded-by-the-afd.html#cb51-33" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb51-34"><a href="projects-funded-by-the-afd.html#cb51-34" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb51-35"><a href="projects-funded-by-the-afd.html#cb51-35" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/time_evolution/world/no_marine&quot;</span>, </span>
<span id="cb51-36"><a href="projects-funded-by-the-afd.html#cb51-36" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-37"><a href="projects-funded-by-the-afd.html#cb51-37" tabindex="-1"></a>  }</span>
<span id="cb51-38"><a href="projects-funded-by-the-afd.html#cb51-38" tabindex="-1"></a></span>
<span id="cb51-39"><a href="projects-funded-by-the-afd.html#cb51-39" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb51-40"><a href="projects-funded-by-the-afd.html#cb51-40" tabindex="-1"></a></span>
<span id="cb51-41"><a href="projects-funded-by-the-afd.html#cb51-41" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="number-of-pas-region-non-marine" class="section level4 hasAnchor" number="2.3.5.3">
<h4><span class="header-section-number">2.3.5.3</span> Number of PAs (region, non-marine)<a href="projects-funded-by-the-afd.html#number-of-pas-region-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="projects-funded-by-the-afd.html#cb52-1" tabindex="-1"></a>roi <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span></span>
<span id="cb52-2"><a href="projects-funded-by-the-afd.html#cb52-2" tabindex="-1"></a></span>
<span id="cb52-3"><a href="projects-funded-by-the-afd.html#cb52-3" tabindex="-1"></a>data_time_range <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">year =</span> </span>
<span id="cb52-4"><a href="projects-funded-by-the-afd.html#cb52-4" tabindex="-1"></a>                              <span class="fu">c</span>(<span class="fu">min</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">:</span><span class="fu">max</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb52-5"><a href="projects-funded-by-the-afd.html#cb52-5" tabindex="-1"></a>)</span>
<span id="cb52-6"><a href="projects-funded-by-the-afd.html#cb52-6" tabindex="-1"></a></span>
<span id="cb52-7"><a href="projects-funded-by-the-afd.html#cb52-7" tabindex="-1"></a></span>
<span id="cb52-8"><a href="projects-funded-by-the-afd.html#cb52-8" tabindex="-1"></a>data_time_n <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="projects-funded-by-the-afd.html#cb52-9" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> roi <span class="sc">&amp;</span> marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="projects-funded-by-the-afd.html#cb52-10" tabindex="-1"></a>  <span class="co">#filter(is.na(year_funding_first) == FALSE) %&gt;%</span></span>
<span id="cb52-11"><a href="projects-funded-by-the-afd.html#cb52-11" tabindex="-1"></a>  <span class="fu">group_by</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb52-12"><a href="projects-funded-by-the-afd.html#cb52-12" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb52-13"><a href="projects-funded-by-the-afd.html#cb52-13" tabindex="-1"></a>  <span class="fu">full_join</span>(data_time_range, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;year&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-14"><a href="projects-funded-by-the-afd.html#cb52-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(n)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>n)) <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="projects-funded-by-the-afd.html#cb52-15" tabindex="-1"></a>  <span class="fu">arrange</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb52-16"><a href="projects-funded-by-the-afd.html#cb52-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_cum =</span> <span class="fu">cumsum</span>(n)) </span>
<span id="cb52-17"><a href="projects-funded-by-the-afd.html#cb52-17" tabindex="-1"></a></span>
<span id="cb52-18"><a href="projects-funded-by-the-afd.html#cb52-18" tabindex="-1"></a><span class="co">#Number of PAs funded by year </span></span>
<span id="cb52-19"><a href="projects-funded-by-the-afd.html#cb52-19" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb52-20"><a href="projects-funded-by-the-afd.html#cb52-20" tabindex="-1"></a>fig_n_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb52-21"><a href="projects-funded-by-the-afd.html#cb52-21" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n)) <span class="sc">%&gt;%</span></span>
<span id="cb52-22"><a href="projects-funded-by-the-afd.html#cb52-22" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-23"><a href="projects-funded-by-the-afd.html#cb52-23" tabindex="-1"></a>  <span class="co"># + geom_text(aes(y = n, label = ifelse(n == 0, NA, n)), </span></span>
<span id="cb52-24"><a href="projects-funded-by-the-afd.html#cb52-24" tabindex="-1"></a>  <span class="co">#             color = &quot;black&quot;, size=4, vjust = -0.3) %&gt;%</span></span>
<span id="cb52-25"><a href="projects-funded-by-the-afd.html#cb52-25" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Nombre d&#39;aires protégées non-marines appuyées par année par l&#39;AFD,&quot;</span>, roi),</span>
<span id="cb52-26"><a href="projects-funded-by-the-afd.html#cb52-26" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb52-27"><a href="projects-funded-by-the-afd.html#cb52-27" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Sur les&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;aires protégées non-marines financées recensées,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;ont une date de financement inconnue.&quot;</span>),</span>
<span id="cb52-28"><a href="projects-funded-by-the-afd.html#cb52-28" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb52-29"><a href="projects-funded-by-the-afd.html#cb52-29" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Nombre d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-30"><a href="projects-funded-by-the-afd.html#cb52-30" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb52-31"><a href="projects-funded-by-the-afd.html#cb52-31" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb52-32"><a href="projects-funded-by-the-afd.html#cb52-32" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb52-33"><a href="projects-funded-by-the-afd.html#cb52-33" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb52-34"><a href="projects-funded-by-the-afd.html#cb52-34" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb52-35"><a href="projects-funded-by-the-afd.html#cb52-35" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb52-36"><a href="projects-funded-by-the-afd.html#cb52-36" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-37"><a href="projects-funded-by-the-afd.html#cb52-37" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-38"><a href="projects-funded-by-the-afd.html#cb52-38" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-39"><a href="projects-funded-by-the-afd.html#cb52-39" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb52-40"><a href="projects-funded-by-the-afd.html#cb52-40" tabindex="-1"></a>fig_n_pa_fr</span>
<span id="cb52-41"><a href="projects-funded-by-the-afd.html#cb52-41" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb52-42"><a href="projects-funded-by-the-afd.html#cb52-42" tabindex="-1"></a>fig_n_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb52-43"><a href="projects-funded-by-the-afd.html#cb52-43" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n)) <span class="sc">%&gt;%</span></span>
<span id="cb52-44"><a href="projects-funded-by-the-afd.html#cb52-44" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-45"><a href="projects-funded-by-the-afd.html#cb52-45" tabindex="-1"></a>  <span class="co"># + geom_text(aes(y = n, label = ifelse(n == 0, NA, n)), </span></span>
<span id="cb52-46"><a href="projects-funded-by-the-afd.html#cb52-46" tabindex="-1"></a>  <span class="co">#             color = &quot;black&quot;, size=4, vjust = -0.3) %&gt;%</span></span>
<span id="cb52-47"><a href="projects-funded-by-the-afd.html#cb52-47" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Number of non-marine protected areas funded each year by AFD,&quot;</span>, roi),</span>
<span id="cb52-48"><a href="projects-funded-by-the-afd.html#cb52-48" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb52-49"><a href="projects-funded-by-the-afd.html#cb52-49" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Out of&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;known non-marine, funded protected areas,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;have unknown funding year.&quot;</span>),</span>
<span id="cb52-50"><a href="projects-funded-by-the-afd.html#cb52-50" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb52-51"><a href="projects-funded-by-the-afd.html#cb52-51" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Number of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-52"><a href="projects-funded-by-the-afd.html#cb52-52" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb52-53"><a href="projects-funded-by-the-afd.html#cb52-53" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb52-54"><a href="projects-funded-by-the-afd.html#cb52-54" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb52-55"><a href="projects-funded-by-the-afd.html#cb52-55" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb52-56"><a href="projects-funded-by-the-afd.html#cb52-56" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb52-57"><a href="projects-funded-by-the-afd.html#cb52-57" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb52-58"><a href="projects-funded-by-the-afd.html#cb52-58" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-59"><a href="projects-funded-by-the-afd.html#cb52-59" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-60"><a href="projects-funded-by-the-afd.html#cb52-60" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-61"><a href="projects-funded-by-the-afd.html#cb52-61" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb52-62"><a href="projects-funded-by-the-afd.html#cb52-62" tabindex="-1"></a>fig_n_pa_en</span>
<span id="cb52-63"><a href="projects-funded-by-the-afd.html#cb52-63" tabindex="-1"></a></span>
<span id="cb52-64"><a href="projects-funded-by-the-afd.html#cb52-64" tabindex="-1"></a></span>
<span id="cb52-65"><a href="projects-funded-by-the-afd.html#cb52-65" tabindex="-1"></a><span class="co">#Cumulative number over time</span></span>
<span id="cb52-66"><a href="projects-funded-by-the-afd.html#cb52-66" tabindex="-1"></a><span class="co">#French</span></span>
<span id="cb52-67"><a href="projects-funded-by-the-afd.html#cb52-67" tabindex="-1"></a>fig_ncum_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb52-68"><a href="projects-funded-by-the-afd.html#cb52-68" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n_cum)) <span class="sc">%&gt;%</span></span>
<span id="cb52-69"><a href="projects-funded-by-the-afd.html#cb52-69" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb52-70"><a href="projects-funded-by-the-afd.html#cb52-70" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb52-71"><a href="projects-funded-by-the-afd.html#cb52-71" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-72"><a href="projects-funded-by-the-afd.html#cb52-72" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> n_cum, <span class="at">label =</span> n_cum), </span>
<span id="cb52-73"><a href="projects-funded-by-the-afd.html#cb52-73" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-74"><a href="projects-funded-by-the-afd.html#cb52-74" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Evolution cumulée du nombre d&#39;aires protégées non-marines,&quot;</span>, roi),</span>
<span id="cb52-75"><a href="projects-funded-by-the-afd.html#cb52-75" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;aires protégées&quot;</span>),</span>
<span id="cb52-76"><a href="projects-funded-by-the-afd.html#cb52-76" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Sur les&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;aires protégées non-marines financées recensées,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;ont une date de financement inconnue.&quot;</span>),</span>
<span id="cb52-77"><a href="projects-funded-by-the-afd.html#cb52-77" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb52-78"><a href="projects-funded-by-the-afd.html#cb52-78" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Nombre d&#39;aires protégées&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-79"><a href="projects-funded-by-the-afd.html#cb52-79" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb52-80"><a href="projects-funded-by-the-afd.html#cb52-80" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb52-81"><a href="projects-funded-by-the-afd.html#cb52-81" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb52-82"><a href="projects-funded-by-the-afd.html#cb52-82" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb52-83"><a href="projects-funded-by-the-afd.html#cb52-83" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb52-84"><a href="projects-funded-by-the-afd.html#cb52-84" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb52-85"><a href="projects-funded-by-the-afd.html#cb52-85" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-86"><a href="projects-funded-by-the-afd.html#cb52-86" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-87"><a href="projects-funded-by-the-afd.html#cb52-87" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-88"><a href="projects-funded-by-the-afd.html#cb52-88" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb52-89"><a href="projects-funded-by-the-afd.html#cb52-89" tabindex="-1"></a>fig_ncum_pa_fr</span>
<span id="cb52-90"><a href="projects-funded-by-the-afd.html#cb52-90" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb52-91"><a href="projects-funded-by-the-afd.html#cb52-91" tabindex="-1"></a>fig_ncum_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb52-92"><a href="projects-funded-by-the-afd.html#cb52-92" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> n_cum)) <span class="sc">%&gt;%</span></span>
<span id="cb52-93"><a href="projects-funded-by-the-afd.html#cb52-93" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb52-94"><a href="projects-funded-by-the-afd.html#cb52-94" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb52-95"><a href="projects-funded-by-the-afd.html#cb52-95" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-96"><a href="projects-funded-by-the-afd.html#cb52-96" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> n_cum, <span class="at">label =</span> n_cum), </span>
<span id="cb52-97"><a href="projects-funded-by-the-afd.html#cb52-97" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-98"><a href="projects-funded-by-the-afd.html#cb52-98" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Cumulated number of non-marine protected areas funded by AFD,&quot;</span>, roi),</span>
<span id="cb52-99"><a href="projects-funded-by-the-afd.html#cb52-99" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n), <span class="st">&quot;protected areas&quot;</span>),</span>
<span id="cb52-100"><a href="projects-funded-by-the-afd.html#cb52-100" tabindex="-1"></a>       <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Out of&quot;</span>, <span class="fu">sum</span>(data_time_n<span class="sc">$</span>n), <span class="st">&quot;known non-marine, funded protected areas,&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_n, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">TRUE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;have unknown funding year.&quot;</span>),</span>
<span id="cb52-101"><a href="projects-funded-by-the-afd.html#cb52-101" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb52-102"><a href="projects-funded-by-the-afd.html#cb52-102" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Number of protected areas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-103"><a href="projects-funded-by-the-afd.html#cb52-103" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb52-104"><a href="projects-funded-by-the-afd.html#cb52-104" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb52-105"><a href="projects-funded-by-the-afd.html#cb52-105" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb52-106"><a href="projects-funded-by-the-afd.html#cb52-106" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb52-107"><a href="projects-funded-by-the-afd.html#cb52-107" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb52-108"><a href="projects-funded-by-the-afd.html#cb52-108" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb52-109"><a href="projects-funded-by-the-afd.html#cb52-109" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-110"><a href="projects-funded-by-the-afd.html#cb52-110" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-111"><a href="projects-funded-by-the-afd.html#cb52-111" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb52-112"><a href="projects-funded-by-the-afd.html#cb52-112" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb52-113"><a href="projects-funded-by-the-afd.html#cb52-113" tabindex="-1"></a>fig_ncum_pa_en</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="projects-funded-by-the-afd.html#cb53-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb53-2"><a href="projects-funded-by-the-afd.html#cb53-2" tabindex="-1"></a></span>
<span id="cb53-3"><a href="projects-funded-by-the-afd.html#cb53-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb53-4"><a href="projects-funded-by-the-afd.html#cb53-4" tabindex="-1"></a></span>
<span id="cb53-5"><a href="projects-funded-by-the-afd.html#cb53-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_n_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb53-6"><a href="projects-funded-by-the-afd.html#cb53-6" tabindex="-1"></a>       fig_n_pa_fr,</span>
<span id="cb53-7"><a href="projects-funded-by-the-afd.html#cb53-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb53-8"><a href="projects-funded-by-the-afd.html#cb53-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb53-9"><a href="projects-funded-by-the-afd.html#cb53-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_n_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb53-10"><a href="projects-funded-by-the-afd.html#cb53-10" tabindex="-1"></a>       fig_n_pa_en,</span>
<span id="cb53-11"><a href="projects-funded-by-the-afd.html#cb53-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb53-12"><a href="projects-funded-by-the-afd.html#cb53-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb53-13"><a href="projects-funded-by-the-afd.html#cb53-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_ncum_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb53-14"><a href="projects-funded-by-the-afd.html#cb53-14" tabindex="-1"></a>       fig_ncum_pa_fr,</span>
<span id="cb53-15"><a href="projects-funded-by-the-afd.html#cb53-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb53-16"><a href="projects-funded-by-the-afd.html#cb53-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb53-17"><a href="projects-funded-by-the-afd.html#cb53-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_ncum_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb53-18"><a href="projects-funded-by-the-afd.html#cb53-18" tabindex="-1"></a>       fig_ncum_pa_en,</span>
<span id="cb53-19"><a href="projects-funded-by-the-afd.html#cb53-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb53-20"><a href="projects-funded-by-the-afd.html#cb53-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb53-21"><a href="projects-funded-by-the-afd.html#cb53-21" tabindex="-1"></a></span>
<span id="cb53-22"><a href="projects-funded-by-the-afd.html#cb53-22" tabindex="-1"></a></span>
<span id="cb53-23"><a href="projects-funded-by-the-afd.html#cb53-23" tabindex="-1"></a></span>
<span id="cb53-24"><a href="projects-funded-by-the-afd.html#cb53-24" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb53-25"><a href="projects-funded-by-the-afd.html#cb53-25" tabindex="-1"></a></span>
<span id="cb53-26"><a href="projects-funded-by-the-afd.html#cb53-26" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb53-27"><a href="projects-funded-by-the-afd.html#cb53-27" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-28"><a href="projects-funded-by-the-afd.html#cb53-28" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb53-29"><a href="projects-funded-by-the-afd.html#cb53-29" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb53-30"><a href="projects-funded-by-the-afd.html#cb53-30" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb53-31"><a href="projects-funded-by-the-afd.html#cb53-31" tabindex="-1"></a>{</span>
<span id="cb53-32"><a href="projects-funded-by-the-afd.html#cb53-32" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb53-33"><a href="projects-funded-by-the-afd.html#cb53-33" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-34"><a href="projects-funded-by-the-afd.html#cb53-34" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb53-35"><a href="projects-funded-by-the-afd.html#cb53-35" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="fu">paste</span>(<span class="st">&quot;projet-afd-eva-ap/descriptive_stats/time_evolution&quot;</span>, roi, <span class="st">&quot;no_marine&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), </span>
<span id="cb53-36"><a href="projects-funded-by-the-afd.html#cb53-36" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-37"><a href="projects-funded-by-the-afd.html#cb53-37" tabindex="-1"></a>  }</span>
<span id="cb53-38"><a href="projects-funded-by-the-afd.html#cb53-38" tabindex="-1"></a></span>
<span id="cb53-39"><a href="projects-funded-by-the-afd.html#cb53-39" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb53-40"><a href="projects-funded-by-the-afd.html#cb53-40" tabindex="-1"></a></span>
<span id="cb53-41"><a href="projects-funded-by-the-afd.html#cb53-41" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="surface-of-pas-world-all" class="section level4 hasAnchor" number="2.3.5.4">
<h4><span class="header-section-number">2.3.5.4</span> Surface of PAs (world, all)<a href="projects-funded-by-the-afd.html#surface-of-pas-world-all" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="projects-funded-by-the-afd.html#cb54-1" tabindex="-1"></a>data_time_range <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">year =</span> </span>
<span id="cb54-2"><a href="projects-funded-by-the-afd.html#cb54-2" tabindex="-1"></a>                              <span class="fu">c</span>(<span class="fu">min</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">:</span><span class="fu">max</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb54-3"><a href="projects-funded-by-the-afd.html#cb54-3" tabindex="-1"></a>)</span>
<span id="cb54-4"><a href="projects-funded-by-the-afd.html#cb54-4" tabindex="-1"></a></span>
<span id="cb54-5"><a href="projects-funded-by-the-afd.html#cb54-5" tabindex="-1"></a></span>
<span id="cb54-6"><a href="projects-funded-by-the-afd.html#cb54-6" tabindex="-1"></a>data_time_area <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb54-7"><a href="projects-funded-by-the-afd.html#cb54-7" tabindex="-1"></a>  <span class="co">#filter(is.na(year_funding_first) == FALSE) %&gt;%</span></span>
<span id="cb54-8"><a href="projects-funded-by-the-afd.html#cb54-8" tabindex="-1"></a>  <span class="fu">group_by</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="projects-funded-by-the-afd.html#cb54-9" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">tot_area_km2 =</span> <span class="fu">sum</span>(area_km2),</span>
<span id="cb54-10"><a href="projects-funded-by-the-afd.html#cb54-10" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="projects-funded-by-the-afd.html#cb54-11" tabindex="-1"></a>  <span class="fu">left_join</span>(pa_int_yr, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;annee_int&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-12"><a href="projects-funded-by-the-afd.html#cb54-12" tabindex="-1"></a>  <span class="fu">full_join</span>(data_time_range, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;year&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-13"><a href="projects-funded-by-the-afd.html#cb54-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_area_km2 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(tot_area_km2)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>tot_area_km2),</span>
<span id="cb54-14"><a href="projects-funded-by-the-afd.html#cb54-14" tabindex="-1"></a>         <span class="at">tot_int_km2 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(tot_int_km2)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>tot_int_km2),</span>
<span id="cb54-15"><a href="projects-funded-by-the-afd.html#cb54-15" tabindex="-1"></a>         <span class="at">tot_area_noint_km2 =</span> tot_area_km2 <span class="sc">-</span> tot_int_km2) <span class="sc">%&gt;%</span></span>
<span id="cb54-16"><a href="projects-funded-by-the-afd.html#cb54-16" tabindex="-1"></a>  <span class="fu">arrange</span>(year_funding_first)</span>
<span id="cb54-17"><a href="projects-funded-by-the-afd.html#cb54-17" tabindex="-1"></a></span>
<span id="cb54-18"><a href="projects-funded-by-the-afd.html#cb54-18" tabindex="-1"></a><span class="co">#Evolution of area over time</span></span>
<span id="cb54-19"><a href="projects-funded-by-the-afd.html#cb54-19" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb54-20"><a href="projects-funded-by-the-afd.html#cb54-20" tabindex="-1"></a>fig_area_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb54-21"><a href="projects-funded-by-the-afd.html#cb54-21" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> tot_area_noint_km2)) <span class="sc">%&gt;%</span></span>
<span id="cb54-22"><a href="projects-funded-by-the-afd.html#cb54-22" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-23"><a href="projects-funded-by-the-afd.html#cb54-23" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_area_noint_km2, </span>
<span id="cb54-24"><a href="projects-funded-by-the-afd.html#cb54-24" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">ifelse</span>(tot_area_noint_km2 <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb54-25"><a href="projects-funded-by-the-afd.html#cb54-25" tabindex="-1"></a>                                 <span class="fu">format</span>(tot_area_noint_km2, </span>
<span id="cb54-26"><a href="projects-funded-by-the-afd.html#cb54-26" tabindex="-1"></a>                                        <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb54-27"><a href="projects-funded-by-the-afd.html#cb54-27" tabindex="-1"></a>                                        <span class="at">scientific =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-28"><a href="projects-funded-by-the-afd.html#cb54-28" tabindex="-1"></a>                                 <span class="cn">NA</span>)), </span>
<span id="cb54-29"><a href="projects-funded-by-the-afd.html#cb54-29" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-30"><a href="projects-funded-by-the-afd.html#cb54-30" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">&quot;log10&quot;</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb54-31"><a href="projects-funded-by-the-afd.html#cb54-31" tabindex="-1"></a>                  <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">%&gt;%</span></span>
<span id="cb54-32"><a href="projects-funded-by-the-afd.html#cb54-32" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">base =</span> <span class="dv">10</span>, <span class="at">sides =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb54-33"><a href="projects-funded-by-the-afd.html#cb54-33" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">outside =</span> <span class="st">&quot;TRUE&quot;</span>,</span>
<span id="cb54-34"><a href="projects-funded-by-the-afd.html#cb54-34" tabindex="-1"></a>                        <span class="at">short =</span> <span class="fu">unit</span>(.<span class="dv">5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb54-35"><a href="projects-funded-by-the-afd.html#cb54-35" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb54-36"><a href="projects-funded-by-the-afd.html#cb54-36" tabindex="-1"></a>                        <span class="at">long =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">&quot;mm&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-37"><a href="projects-funded-by-the-afd.html#cb54-37" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-38"><a href="projects-funded-by-the-afd.html#cb54-38" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolution de la superficie financée par l&#39;AFD&quot;</span>,</span>
<span id="cb54-39"><a href="projects-funded-by-the-afd.html#cb54-39" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;aires protégées couvrant&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb54-40"><a href="projects-funded-by-the-afd.html#cb54-40" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Sur les &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; aires protégées financées recensées, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; ont une date de financement connue.</span><span class="sc">\n</span><span class="st">Soit &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² sur &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb54-41"><a href="projects-funded-by-the-afd.html#cb54-41" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb54-42"><a href="projects-funded-by-the-afd.html#cb54-42" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Superficie (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-43"><a href="projects-funded-by-the-afd.html#cb54-43" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb54-44"><a href="projects-funded-by-the-afd.html#cb54-44" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb54-45"><a href="projects-funded-by-the-afd.html#cb54-45" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb54-46"><a href="projects-funded-by-the-afd.html#cb54-46" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb54-47"><a href="projects-funded-by-the-afd.html#cb54-47" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb54-48"><a href="projects-funded-by-the-afd.html#cb54-48" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb54-49"><a href="projects-funded-by-the-afd.html#cb54-49" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-50"><a href="projects-funded-by-the-afd.html#cb54-50" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-51"><a href="projects-funded-by-the-afd.html#cb54-51" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-52"><a href="projects-funded-by-the-afd.html#cb54-52" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb54-53"><a href="projects-funded-by-the-afd.html#cb54-53" tabindex="-1"></a>fig_area_pa_fr</span>
<span id="cb54-54"><a href="projects-funded-by-the-afd.html#cb54-54" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb54-55"><a href="projects-funded-by-the-afd.html#cb54-55" tabindex="-1"></a>fig_area_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb54-56"><a href="projects-funded-by-the-afd.html#cb54-56" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> tot_area_noint_km2)) <span class="sc">%&gt;%</span></span>
<span id="cb54-57"><a href="projects-funded-by-the-afd.html#cb54-57" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-58"><a href="projects-funded-by-the-afd.html#cb54-58" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_area_noint_km2, </span>
<span id="cb54-59"><a href="projects-funded-by-the-afd.html#cb54-59" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">ifelse</span>(tot_area_noint_km2 <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb54-60"><a href="projects-funded-by-the-afd.html#cb54-60" tabindex="-1"></a>                                 <span class="fu">format</span>(tot_area_noint_km2, </span>
<span id="cb54-61"><a href="projects-funded-by-the-afd.html#cb54-61" tabindex="-1"></a>                                        <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb54-62"><a href="projects-funded-by-the-afd.html#cb54-62" tabindex="-1"></a>                                        <span class="at">scientific =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-63"><a href="projects-funded-by-the-afd.html#cb54-63" tabindex="-1"></a>                                 <span class="cn">NA</span>)), </span>
<span id="cb54-64"><a href="projects-funded-by-the-afd.html#cb54-64" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-65"><a href="projects-funded-by-the-afd.html#cb54-65" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">&quot;log10&quot;</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb54-66"><a href="projects-funded-by-the-afd.html#cb54-66" tabindex="-1"></a>                  <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">%&gt;%</span></span>
<span id="cb54-67"><a href="projects-funded-by-the-afd.html#cb54-67" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">base =</span> <span class="dv">10</span>, <span class="at">sides =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb54-68"><a href="projects-funded-by-the-afd.html#cb54-68" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">outside =</span> <span class="st">&quot;TRUE&quot;</span>,</span>
<span id="cb54-69"><a href="projects-funded-by-the-afd.html#cb54-69" tabindex="-1"></a>                        <span class="at">short =</span> <span class="fu">unit</span>(.<span class="dv">5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb54-70"><a href="projects-funded-by-the-afd.html#cb54-70" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb54-71"><a href="projects-funded-by-the-afd.html#cb54-71" tabindex="-1"></a>                        <span class="at">long =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">&quot;mm&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-72"><a href="projects-funded-by-the-afd.html#cb54-72" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-73"><a href="projects-funded-by-the-afd.html#cb54-73" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolution of AFD funded area&quot;</span>,</span>
<span id="cb54-74"><a href="projects-funded-by-the-afd.html#cb54-74" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb54-75"><a href="projects-funded-by-the-afd.html#cb54-75" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Out of &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; known funded protected areas, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; have a known funding year.</span><span class="sc">\n</span><span class="st">In terms of area, &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² out of &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb54-76"><a href="projects-funded-by-the-afd.html#cb54-76" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb54-77"><a href="projects-funded-by-the-afd.html#cb54-77" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Area (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-78"><a href="projects-funded-by-the-afd.html#cb54-78" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb54-79"><a href="projects-funded-by-the-afd.html#cb54-79" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb54-80"><a href="projects-funded-by-the-afd.html#cb54-80" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb54-81"><a href="projects-funded-by-the-afd.html#cb54-81" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb54-82"><a href="projects-funded-by-the-afd.html#cb54-82" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb54-83"><a href="projects-funded-by-the-afd.html#cb54-83" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb54-84"><a href="projects-funded-by-the-afd.html#cb54-84" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-85"><a href="projects-funded-by-the-afd.html#cb54-85" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-86"><a href="projects-funded-by-the-afd.html#cb54-86" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-87"><a href="projects-funded-by-the-afd.html#cb54-87" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb54-88"><a href="projects-funded-by-the-afd.html#cb54-88" tabindex="-1"></a>fig_area_pa_en</span>
<span id="cb54-89"><a href="projects-funded-by-the-afd.html#cb54-89" tabindex="-1"></a></span>
<span id="cb54-90"><a href="projects-funded-by-the-afd.html#cb54-90" tabindex="-1"></a></span>
<span id="cb54-91"><a href="projects-funded-by-the-afd.html#cb54-91" tabindex="-1"></a></span>
<span id="cb54-92"><a href="projects-funded-by-the-afd.html#cb54-92" tabindex="-1"></a><span class="co">#Cumulative area over time</span></span>
<span id="cb54-93"><a href="projects-funded-by-the-afd.html#cb54-93" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb54-94"><a href="projects-funded-by-the-afd.html#cb54-94" tabindex="-1"></a>fig_area_cum_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb54-95"><a href="projects-funded-by-the-afd.html#cb54-95" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first),</span>
<span id="cb54-96"><a href="projects-funded-by-the-afd.html#cb54-96" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2))) <span class="sc">%&gt;%</span></span>
<span id="cb54-97"><a href="projects-funded-by-the-afd.html#cb54-97" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb54-98"><a href="projects-funded-by-the-afd.html#cb54-98" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb54-99"><a href="projects-funded-by-the-afd.html#cb54-99" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-100"><a href="projects-funded-by-the-afd.html#cb54-100" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb54-101"><a href="projects-funded-by-the-afd.html#cb54-101" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">format</span>(<span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb54-102"><a href="projects-funded-by-the-afd.html#cb54-102" tabindex="-1"></a>                                 <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb54-103"><a href="projects-funded-by-the-afd.html#cb54-103" tabindex="-1"></a>                                 <span class="at">scientific =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb54-104"><a href="projects-funded-by-the-afd.html#cb54-104" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-105"><a href="projects-funded-by-the-afd.html#cb54-105" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolution cumulée de la superficie des aires protégées, financées par l&#39;AFD&quot;</span>,</span>
<span id="cb54-106"><a href="projects-funded-by-the-afd.html#cb54-106" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;aires protégées couvrant&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb54-107"><a href="projects-funded-by-the-afd.html#cb54-107" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Sur les &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n), <span class="st">&quot; aires protégées financées recensées, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; ont une date de financement connue.</span><span class="sc">\n</span><span class="st">Soit &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² sur &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb54-108"><a href="projects-funded-by-the-afd.html#cb54-108" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb54-109"><a href="projects-funded-by-the-afd.html#cb54-109" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Superficie (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-110"><a href="projects-funded-by-the-afd.html#cb54-110" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb54-111"><a href="projects-funded-by-the-afd.html#cb54-111" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb54-112"><a href="projects-funded-by-the-afd.html#cb54-112" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb54-113"><a href="projects-funded-by-the-afd.html#cb54-113" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb54-114"><a href="projects-funded-by-the-afd.html#cb54-114" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb54-115"><a href="projects-funded-by-the-afd.html#cb54-115" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb54-116"><a href="projects-funded-by-the-afd.html#cb54-116" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-117"><a href="projects-funded-by-the-afd.html#cb54-117" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-118"><a href="projects-funded-by-the-afd.html#cb54-118" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-119"><a href="projects-funded-by-the-afd.html#cb54-119" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb54-120"><a href="projects-funded-by-the-afd.html#cb54-120" tabindex="-1"></a>fig_area_cum_pa_fr</span>
<span id="cb54-121"><a href="projects-funded-by-the-afd.html#cb54-121" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb54-122"><a href="projects-funded-by-the-afd.html#cb54-122" tabindex="-1"></a>fig_area_cum_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb54-123"><a href="projects-funded-by-the-afd.html#cb54-123" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first),</span>
<span id="cb54-124"><a href="projects-funded-by-the-afd.html#cb54-124" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2))) <span class="sc">%&gt;%</span></span>
<span id="cb54-125"><a href="projects-funded-by-the-afd.html#cb54-125" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb54-126"><a href="projects-funded-by-the-afd.html#cb54-126" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb54-127"><a href="projects-funded-by-the-afd.html#cb54-127" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-128"><a href="projects-funded-by-the-afd.html#cb54-128" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb54-129"><a href="projects-funded-by-the-afd.html#cb54-129" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">format</span>(<span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb54-130"><a href="projects-funded-by-the-afd.html#cb54-130" tabindex="-1"></a>                                 <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb54-131"><a href="projects-funded-by-the-afd.html#cb54-131" tabindex="-1"></a>                                 <span class="at">scientific =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb54-132"><a href="projects-funded-by-the-afd.html#cb54-132" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-133"><a href="projects-funded-by-the-afd.html#cb54-133" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cumulative evolution of area funded by AFD&quot;</span>,</span>
<span id="cb54-134"><a href="projects-funded-by-the-afd.html#cb54-134" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb54-135"><a href="projects-funded-by-the-afd.html#cb54-135" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Out of &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n), <span class="st">&quot; known funded protected areas, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; have a known funding year.</span><span class="sc">\n</span><span class="st">In terms of area, &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² out of &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb54-136"><a href="projects-funded-by-the-afd.html#cb54-136" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Area (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-137"><a href="projects-funded-by-the-afd.html#cb54-137" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb54-138"><a href="projects-funded-by-the-afd.html#cb54-138" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb54-139"><a href="projects-funded-by-the-afd.html#cb54-139" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb54-140"><a href="projects-funded-by-the-afd.html#cb54-140" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb54-141"><a href="projects-funded-by-the-afd.html#cb54-141" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb54-142"><a href="projects-funded-by-the-afd.html#cb54-142" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb54-143"><a href="projects-funded-by-the-afd.html#cb54-143" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-144"><a href="projects-funded-by-the-afd.html#cb54-144" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-145"><a href="projects-funded-by-the-afd.html#cb54-145" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb54-146"><a href="projects-funded-by-the-afd.html#cb54-146" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb54-147"><a href="projects-funded-by-the-afd.html#cb54-147" tabindex="-1"></a>fig_area_cum_pa_en</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="projects-funded-by-the-afd.html#cb55-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb55-2"><a href="projects-funded-by-the-afd.html#cb55-2" tabindex="-1"></a></span>
<span id="cb55-3"><a href="projects-funded-by-the-afd.html#cb55-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb55-4"><a href="projects-funded-by-the-afd.html#cb55-4" tabindex="-1"></a></span>
<span id="cb55-5"><a href="projects-funded-by-the-afd.html#cb55-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb55-6"><a href="projects-funded-by-the-afd.html#cb55-6" tabindex="-1"></a>       fig_area_pa_fr,</span>
<span id="cb55-7"><a href="projects-funded-by-the-afd.html#cb55-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb55-8"><a href="projects-funded-by-the-afd.html#cb55-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb55-9"><a href="projects-funded-by-the-afd.html#cb55-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb55-10"><a href="projects-funded-by-the-afd.html#cb55-10" tabindex="-1"></a>       fig_area_pa_en,</span>
<span id="cb55-11"><a href="projects-funded-by-the-afd.html#cb55-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb55-12"><a href="projects-funded-by-the-afd.html#cb55-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb55-13"><a href="projects-funded-by-the-afd.html#cb55-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_cum_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb55-14"><a href="projects-funded-by-the-afd.html#cb55-14" tabindex="-1"></a>       fig_area_cum_pa_fr,</span>
<span id="cb55-15"><a href="projects-funded-by-the-afd.html#cb55-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb55-16"><a href="projects-funded-by-the-afd.html#cb55-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb55-17"><a href="projects-funded-by-the-afd.html#cb55-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_cum_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb55-18"><a href="projects-funded-by-the-afd.html#cb55-18" tabindex="-1"></a>       fig_area_cum_pa_en,</span>
<span id="cb55-19"><a href="projects-funded-by-the-afd.html#cb55-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb55-20"><a href="projects-funded-by-the-afd.html#cb55-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb55-21"><a href="projects-funded-by-the-afd.html#cb55-21" tabindex="-1"></a></span>
<span id="cb55-22"><a href="projects-funded-by-the-afd.html#cb55-22" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb55-23"><a href="projects-funded-by-the-afd.html#cb55-23" tabindex="-1"></a></span>
<span id="cb55-24"><a href="projects-funded-by-the-afd.html#cb55-24" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb55-25"><a href="projects-funded-by-the-afd.html#cb55-25" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-26"><a href="projects-funded-by-the-afd.html#cb55-26" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb55-27"><a href="projects-funded-by-the-afd.html#cb55-27" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb55-28"><a href="projects-funded-by-the-afd.html#cb55-28" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb55-29"><a href="projects-funded-by-the-afd.html#cb55-29" tabindex="-1"></a>{</span>
<span id="cb55-30"><a href="projects-funded-by-the-afd.html#cb55-30" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb55-31"><a href="projects-funded-by-the-afd.html#cb55-31" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb55-32"><a href="projects-funded-by-the-afd.html#cb55-32" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb55-33"><a href="projects-funded-by-the-afd.html#cb55-33" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/time_evolution/world/all&quot;</span>, </span>
<span id="cb55-34"><a href="projects-funded-by-the-afd.html#cb55-34" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-35"><a href="projects-funded-by-the-afd.html#cb55-35" tabindex="-1"></a>  }</span>
<span id="cb55-36"><a href="projects-funded-by-the-afd.html#cb55-36" tabindex="-1"></a></span>
<span id="cb55-37"><a href="projects-funded-by-the-afd.html#cb55-37" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb55-38"><a href="projects-funded-by-the-afd.html#cb55-38" tabindex="-1"></a></span>
<span id="cb55-39"><a href="projects-funded-by-the-afd.html#cb55-39" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="surface-of-pas-world-non-marine" class="section level4 hasAnchor" number="2.3.5.5">
<h4><span class="header-section-number">2.3.5.5</span> Surface of PAs (world, non-marine)<a href="projects-funded-by-the-afd.html#surface-of-pas-world-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="projects-funded-by-the-afd.html#cb56-1" tabindex="-1"></a>data_time_range <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">year =</span> </span>
<span id="cb56-2"><a href="projects-funded-by-the-afd.html#cb56-2" tabindex="-1"></a>                              <span class="fu">c</span>(<span class="fu">min</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">:</span><span class="fu">max</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb56-3"><a href="projects-funded-by-the-afd.html#cb56-3" tabindex="-1"></a>)</span>
<span id="cb56-4"><a href="projects-funded-by-the-afd.html#cb56-4" tabindex="-1"></a></span>
<span id="cb56-5"><a href="projects-funded-by-the-afd.html#cb56-5" tabindex="-1"></a></span>
<span id="cb56-6"><a href="projects-funded-by-the-afd.html#cb56-6" tabindex="-1"></a>data_time_area <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="projects-funded-by-the-afd.html#cb56-7" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="projects-funded-by-the-afd.html#cb56-8" tabindex="-1"></a>  <span class="co">#filter(is.na(year_funding_first) == FALSE) %&gt;%</span></span>
<span id="cb56-9"><a href="projects-funded-by-the-afd.html#cb56-9" tabindex="-1"></a>  <span class="fu">group_by</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb56-10"><a href="projects-funded-by-the-afd.html#cb56-10" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">tot_area_km2 =</span> <span class="fu">sum</span>(area_km2),</span>
<span id="cb56-11"><a href="projects-funded-by-the-afd.html#cb56-11" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb56-12"><a href="projects-funded-by-the-afd.html#cb56-12" tabindex="-1"></a>  <span class="fu">left_join</span>(pa_int_yr, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;annee_int&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-13"><a href="projects-funded-by-the-afd.html#cb56-13" tabindex="-1"></a>  <span class="fu">full_join</span>(data_time_range, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;year&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-14"><a href="projects-funded-by-the-afd.html#cb56-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_area_km2 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(tot_area_km2)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>tot_area_km2),</span>
<span id="cb56-15"><a href="projects-funded-by-the-afd.html#cb56-15" tabindex="-1"></a>         <span class="at">tot_int_km2 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(tot_int_km2)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>tot_int_km2),</span>
<span id="cb56-16"><a href="projects-funded-by-the-afd.html#cb56-16" tabindex="-1"></a>         <span class="at">tot_area_noint_km2 =</span> tot_area_km2 <span class="sc">-</span> tot_int_km2) <span class="sc">%&gt;%</span></span>
<span id="cb56-17"><a href="projects-funded-by-the-afd.html#cb56-17" tabindex="-1"></a>  <span class="fu">arrange</span>(year_funding_first)</span>
<span id="cb56-18"><a href="projects-funded-by-the-afd.html#cb56-18" tabindex="-1"></a></span>
<span id="cb56-19"><a href="projects-funded-by-the-afd.html#cb56-19" tabindex="-1"></a><span class="co">#Evolution of area over time</span></span>
<span id="cb56-20"><a href="projects-funded-by-the-afd.html#cb56-20" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb56-21"><a href="projects-funded-by-the-afd.html#cb56-21" tabindex="-1"></a>fig_area_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb56-22"><a href="projects-funded-by-the-afd.html#cb56-22" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> tot_area_noint_km2)) <span class="sc">%&gt;%</span></span>
<span id="cb56-23"><a href="projects-funded-by-the-afd.html#cb56-23" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-24"><a href="projects-funded-by-the-afd.html#cb56-24" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_area_noint_km2, </span>
<span id="cb56-25"><a href="projects-funded-by-the-afd.html#cb56-25" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">ifelse</span>(tot_area_noint_km2 <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb56-26"><a href="projects-funded-by-the-afd.html#cb56-26" tabindex="-1"></a>                                 <span class="fu">format</span>(tot_area_noint_km2, </span>
<span id="cb56-27"><a href="projects-funded-by-the-afd.html#cb56-27" tabindex="-1"></a>                                        <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb56-28"><a href="projects-funded-by-the-afd.html#cb56-28" tabindex="-1"></a>                                        <span class="at">scientific =</span> <span class="cn">TRUE</span>),</span>
<span id="cb56-29"><a href="projects-funded-by-the-afd.html#cb56-29" tabindex="-1"></a>                                 <span class="cn">NA</span>)), </span>
<span id="cb56-30"><a href="projects-funded-by-the-afd.html#cb56-30" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-31"><a href="projects-funded-by-the-afd.html#cb56-31" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">&quot;log10&quot;</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb56-32"><a href="projects-funded-by-the-afd.html#cb56-32" tabindex="-1"></a>                  <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">%&gt;%</span></span>
<span id="cb56-33"><a href="projects-funded-by-the-afd.html#cb56-33" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">base =</span> <span class="dv">10</span>, <span class="at">sides =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb56-34"><a href="projects-funded-by-the-afd.html#cb56-34" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">outside =</span> <span class="st">&quot;TRUE&quot;</span>,</span>
<span id="cb56-35"><a href="projects-funded-by-the-afd.html#cb56-35" tabindex="-1"></a>                        <span class="at">short =</span> <span class="fu">unit</span>(.<span class="dv">5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb56-36"><a href="projects-funded-by-the-afd.html#cb56-36" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb56-37"><a href="projects-funded-by-the-afd.html#cb56-37" tabindex="-1"></a>                        <span class="at">long =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">&quot;mm&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-38"><a href="projects-funded-by-the-afd.html#cb56-38" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-39"><a href="projects-funded-by-the-afd.html#cb56-39" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolution de la superficie non-marine financée par l&#39;AFD&quot;</span>,</span>
<span id="cb56-40"><a href="projects-funded-by-the-afd.html#cb56-40" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;aires protégées couvrant&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb56-41"><a href="projects-funded-by-the-afd.html#cb56-41" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Sur les &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; aires protégées financées recensées, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; ont une date de financement connue.</span><span class="sc">\n</span><span class="st">Soit &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² sur &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb56-42"><a href="projects-funded-by-the-afd.html#cb56-42" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb56-43"><a href="projects-funded-by-the-afd.html#cb56-43" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Superficie (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-44"><a href="projects-funded-by-the-afd.html#cb56-44" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb56-45"><a href="projects-funded-by-the-afd.html#cb56-45" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb56-46"><a href="projects-funded-by-the-afd.html#cb56-46" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb56-47"><a href="projects-funded-by-the-afd.html#cb56-47" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb56-48"><a href="projects-funded-by-the-afd.html#cb56-48" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb56-49"><a href="projects-funded-by-the-afd.html#cb56-49" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb56-50"><a href="projects-funded-by-the-afd.html#cb56-50" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-51"><a href="projects-funded-by-the-afd.html#cb56-51" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-52"><a href="projects-funded-by-the-afd.html#cb56-52" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-53"><a href="projects-funded-by-the-afd.html#cb56-53" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb56-54"><a href="projects-funded-by-the-afd.html#cb56-54" tabindex="-1"></a>fig_area_pa_fr</span>
<span id="cb56-55"><a href="projects-funded-by-the-afd.html#cb56-55" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb56-56"><a href="projects-funded-by-the-afd.html#cb56-56" tabindex="-1"></a>fig_area_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb56-57"><a href="projects-funded-by-the-afd.html#cb56-57" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> tot_area_noint_km2)) <span class="sc">%&gt;%</span></span>
<span id="cb56-58"><a href="projects-funded-by-the-afd.html#cb56-58" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-59"><a href="projects-funded-by-the-afd.html#cb56-59" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_area_noint_km2, </span>
<span id="cb56-60"><a href="projects-funded-by-the-afd.html#cb56-60" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">ifelse</span>(tot_area_noint_km2 <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb56-61"><a href="projects-funded-by-the-afd.html#cb56-61" tabindex="-1"></a>                                 <span class="fu">format</span>(tot_area_noint_km2, </span>
<span id="cb56-62"><a href="projects-funded-by-the-afd.html#cb56-62" tabindex="-1"></a>                                        <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb56-63"><a href="projects-funded-by-the-afd.html#cb56-63" tabindex="-1"></a>                                        <span class="at">scientific =</span> <span class="cn">TRUE</span>),</span>
<span id="cb56-64"><a href="projects-funded-by-the-afd.html#cb56-64" tabindex="-1"></a>                                 <span class="cn">NA</span>)), </span>
<span id="cb56-65"><a href="projects-funded-by-the-afd.html#cb56-65" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-66"><a href="projects-funded-by-the-afd.html#cb56-66" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">&quot;log10&quot;</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb56-67"><a href="projects-funded-by-the-afd.html#cb56-67" tabindex="-1"></a>                  <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">%&gt;%</span></span>
<span id="cb56-68"><a href="projects-funded-by-the-afd.html#cb56-68" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">base =</span> <span class="dv">10</span>, <span class="at">sides =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb56-69"><a href="projects-funded-by-the-afd.html#cb56-69" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">outside =</span> <span class="st">&quot;TRUE&quot;</span>,</span>
<span id="cb56-70"><a href="projects-funded-by-the-afd.html#cb56-70" tabindex="-1"></a>                        <span class="at">short =</span> <span class="fu">unit</span>(.<span class="dv">5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb56-71"><a href="projects-funded-by-the-afd.html#cb56-71" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb56-72"><a href="projects-funded-by-the-afd.html#cb56-72" tabindex="-1"></a>                        <span class="at">long =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">&quot;mm&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-73"><a href="projects-funded-by-the-afd.html#cb56-73" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-74"><a href="projects-funded-by-the-afd.html#cb56-74" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolution of AFD funded non-marine protected areas&quot;</span>,</span>
<span id="cb56-75"><a href="projects-funded-by-the-afd.html#cb56-75" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb56-76"><a href="projects-funded-by-the-afd.html#cb56-76" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Out of &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; known funded protected areas, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; have a known funding year.</span><span class="sc">\n</span><span class="st">In terms of area, &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² out of &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb56-77"><a href="projects-funded-by-the-afd.html#cb56-77" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb56-78"><a href="projects-funded-by-the-afd.html#cb56-78" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Area (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-79"><a href="projects-funded-by-the-afd.html#cb56-79" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb56-80"><a href="projects-funded-by-the-afd.html#cb56-80" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb56-81"><a href="projects-funded-by-the-afd.html#cb56-81" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb56-82"><a href="projects-funded-by-the-afd.html#cb56-82" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb56-83"><a href="projects-funded-by-the-afd.html#cb56-83" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb56-84"><a href="projects-funded-by-the-afd.html#cb56-84" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb56-85"><a href="projects-funded-by-the-afd.html#cb56-85" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-86"><a href="projects-funded-by-the-afd.html#cb56-86" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-87"><a href="projects-funded-by-the-afd.html#cb56-87" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-88"><a href="projects-funded-by-the-afd.html#cb56-88" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb56-89"><a href="projects-funded-by-the-afd.html#cb56-89" tabindex="-1"></a>fig_area_pa_en</span>
<span id="cb56-90"><a href="projects-funded-by-the-afd.html#cb56-90" tabindex="-1"></a></span>
<span id="cb56-91"><a href="projects-funded-by-the-afd.html#cb56-91" tabindex="-1"></a></span>
<span id="cb56-92"><a href="projects-funded-by-the-afd.html#cb56-92" tabindex="-1"></a></span>
<span id="cb56-93"><a href="projects-funded-by-the-afd.html#cb56-93" tabindex="-1"></a><span class="co">#Cumulative area over time</span></span>
<span id="cb56-94"><a href="projects-funded-by-the-afd.html#cb56-94" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb56-95"><a href="projects-funded-by-the-afd.html#cb56-95" tabindex="-1"></a>fig_area_cum_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb56-96"><a href="projects-funded-by-the-afd.html#cb56-96" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first),</span>
<span id="cb56-97"><a href="projects-funded-by-the-afd.html#cb56-97" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2))) <span class="sc">%&gt;%</span></span>
<span id="cb56-98"><a href="projects-funded-by-the-afd.html#cb56-98" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb56-99"><a href="projects-funded-by-the-afd.html#cb56-99" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb56-100"><a href="projects-funded-by-the-afd.html#cb56-100" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-101"><a href="projects-funded-by-the-afd.html#cb56-101" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb56-102"><a href="projects-funded-by-the-afd.html#cb56-102" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">format</span>(<span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb56-103"><a href="projects-funded-by-the-afd.html#cb56-103" tabindex="-1"></a>                                 <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb56-104"><a href="projects-funded-by-the-afd.html#cb56-104" tabindex="-1"></a>                                 <span class="at">scientific =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb56-105"><a href="projects-funded-by-the-afd.html#cb56-105" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-106"><a href="projects-funded-by-the-afd.html#cb56-106" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Evolution cumulée de la superficie des aires protégées non-marines, financées par l&#39;AFD&quot;</span>,</span>
<span id="cb56-107"><a href="projects-funded-by-the-afd.html#cb56-107" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;aires protégées couvrant&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb56-108"><a href="projects-funded-by-the-afd.html#cb56-108" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Sur les &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; aires protégées financées recensées, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; ont une date de financement connue.</span><span class="sc">\n</span><span class="st">Soit &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² sur &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb56-109"><a href="projects-funded-by-the-afd.html#cb56-109" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb56-110"><a href="projects-funded-by-the-afd.html#cb56-110" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Superficie (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-111"><a href="projects-funded-by-the-afd.html#cb56-111" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb56-112"><a href="projects-funded-by-the-afd.html#cb56-112" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb56-113"><a href="projects-funded-by-the-afd.html#cb56-113" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb56-114"><a href="projects-funded-by-the-afd.html#cb56-114" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb56-115"><a href="projects-funded-by-the-afd.html#cb56-115" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb56-116"><a href="projects-funded-by-the-afd.html#cb56-116" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb56-117"><a href="projects-funded-by-the-afd.html#cb56-117" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-118"><a href="projects-funded-by-the-afd.html#cb56-118" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-119"><a href="projects-funded-by-the-afd.html#cb56-119" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-120"><a href="projects-funded-by-the-afd.html#cb56-120" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb56-121"><a href="projects-funded-by-the-afd.html#cb56-121" tabindex="-1"></a>fig_area_cum_pa_fr</span>
<span id="cb56-122"><a href="projects-funded-by-the-afd.html#cb56-122" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb56-123"><a href="projects-funded-by-the-afd.html#cb56-123" tabindex="-1"></a>fig_area_cum_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb56-124"><a href="projects-funded-by-the-afd.html#cb56-124" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first),</span>
<span id="cb56-125"><a href="projects-funded-by-the-afd.html#cb56-125" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2))) <span class="sc">%&gt;%</span></span>
<span id="cb56-126"><a href="projects-funded-by-the-afd.html#cb56-126" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb56-127"><a href="projects-funded-by-the-afd.html#cb56-127" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb56-128"><a href="projects-funded-by-the-afd.html#cb56-128" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-129"><a href="projects-funded-by-the-afd.html#cb56-129" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb56-130"><a href="projects-funded-by-the-afd.html#cb56-130" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">format</span>(<span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb56-131"><a href="projects-funded-by-the-afd.html#cb56-131" tabindex="-1"></a>                                 <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb56-132"><a href="projects-funded-by-the-afd.html#cb56-132" tabindex="-1"></a>                                 <span class="at">scientific =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb56-133"><a href="projects-funded-by-the-afd.html#cb56-133" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-134"><a href="projects-funded-by-the-afd.html#cb56-134" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cumulated evolution of non-marine protected areas funded by AFD&quot;</span>,</span>
<span id="cb56-135"><a href="projects-funded-by-the-afd.html#cb56-135" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb56-136"><a href="projects-funded-by-the-afd.html#cb56-136" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Out of &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; known funded protected areas, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; have a known funding year.</span><span class="sc">\n</span><span class="st">In terms of area, &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² out of &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb56-137"><a href="projects-funded-by-the-afd.html#cb56-137" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb56-138"><a href="projects-funded-by-the-afd.html#cb56-138" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Area (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-139"><a href="projects-funded-by-the-afd.html#cb56-139" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb56-140"><a href="projects-funded-by-the-afd.html#cb56-140" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb56-141"><a href="projects-funded-by-the-afd.html#cb56-141" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb56-142"><a href="projects-funded-by-the-afd.html#cb56-142" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb56-143"><a href="projects-funded-by-the-afd.html#cb56-143" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb56-144"><a href="projects-funded-by-the-afd.html#cb56-144" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb56-145"><a href="projects-funded-by-the-afd.html#cb56-145" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-146"><a href="projects-funded-by-the-afd.html#cb56-146" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-147"><a href="projects-funded-by-the-afd.html#cb56-147" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb56-148"><a href="projects-funded-by-the-afd.html#cb56-148" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb56-149"><a href="projects-funded-by-the-afd.html#cb56-149" tabindex="-1"></a>fig_area_cum_pa_en</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="projects-funded-by-the-afd.html#cb57-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb57-2"><a href="projects-funded-by-the-afd.html#cb57-2" tabindex="-1"></a></span>
<span id="cb57-3"><a href="projects-funded-by-the-afd.html#cb57-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb57-4"><a href="projects-funded-by-the-afd.html#cb57-4" tabindex="-1"></a></span>
<span id="cb57-5"><a href="projects-funded-by-the-afd.html#cb57-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb57-6"><a href="projects-funded-by-the-afd.html#cb57-6" tabindex="-1"></a>       fig_area_pa_fr,</span>
<span id="cb57-7"><a href="projects-funded-by-the-afd.html#cb57-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb57-8"><a href="projects-funded-by-the-afd.html#cb57-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb57-9"><a href="projects-funded-by-the-afd.html#cb57-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb57-10"><a href="projects-funded-by-the-afd.html#cb57-10" tabindex="-1"></a>       fig_area_pa_en,</span>
<span id="cb57-11"><a href="projects-funded-by-the-afd.html#cb57-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb57-12"><a href="projects-funded-by-the-afd.html#cb57-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb57-13"><a href="projects-funded-by-the-afd.html#cb57-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_cum_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb57-14"><a href="projects-funded-by-the-afd.html#cb57-14" tabindex="-1"></a>       fig_area_cum_pa_fr,</span>
<span id="cb57-15"><a href="projects-funded-by-the-afd.html#cb57-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb57-16"><a href="projects-funded-by-the-afd.html#cb57-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb57-17"><a href="projects-funded-by-the-afd.html#cb57-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_cum_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb57-18"><a href="projects-funded-by-the-afd.html#cb57-18" tabindex="-1"></a>       fig_area_cum_pa_en,</span>
<span id="cb57-19"><a href="projects-funded-by-the-afd.html#cb57-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb57-20"><a href="projects-funded-by-the-afd.html#cb57-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb57-21"><a href="projects-funded-by-the-afd.html#cb57-21" tabindex="-1"></a></span>
<span id="cb57-22"><a href="projects-funded-by-the-afd.html#cb57-22" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb57-23"><a href="projects-funded-by-the-afd.html#cb57-23" tabindex="-1"></a></span>
<span id="cb57-24"><a href="projects-funded-by-the-afd.html#cb57-24" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb57-25"><a href="projects-funded-by-the-afd.html#cb57-25" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-26"><a href="projects-funded-by-the-afd.html#cb57-26" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb57-27"><a href="projects-funded-by-the-afd.html#cb57-27" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb57-28"><a href="projects-funded-by-the-afd.html#cb57-28" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb57-29"><a href="projects-funded-by-the-afd.html#cb57-29" tabindex="-1"></a>{</span>
<span id="cb57-30"><a href="projects-funded-by-the-afd.html#cb57-30" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb57-31"><a href="projects-funded-by-the-afd.html#cb57-31" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb57-32"><a href="projects-funded-by-the-afd.html#cb57-32" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb57-33"><a href="projects-funded-by-the-afd.html#cb57-33" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/time_evolution/world/no_marine&quot;</span>, </span>
<span id="cb57-34"><a href="projects-funded-by-the-afd.html#cb57-34" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-35"><a href="projects-funded-by-the-afd.html#cb57-35" tabindex="-1"></a>  }</span>
<span id="cb57-36"><a href="projects-funded-by-the-afd.html#cb57-36" tabindex="-1"></a></span>
<span id="cb57-37"><a href="projects-funded-by-the-afd.html#cb57-37" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb57-38"><a href="projects-funded-by-the-afd.html#cb57-38" tabindex="-1"></a></span>
<span id="cb57-39"><a href="projects-funded-by-the-afd.html#cb57-39" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="surface-of-pas-region-non-marine" class="section level4 hasAnchor" number="2.3.5.6">
<h4><span class="header-section-number">2.3.5.6</span> Surface of PAs (region, non-marine)<a href="projects-funded-by-the-afd.html#surface-of-pas-region-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="projects-funded-by-the-afd.html#cb58-1" tabindex="-1"></a>roi <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span></span>
<span id="cb58-2"><a href="projects-funded-by-the-afd.html#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="projects-funded-by-the-afd.html#cb58-3" tabindex="-1"></a>data_time_range <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">year =</span> </span>
<span id="cb58-4"><a href="projects-funded-by-the-afd.html#cb58-4" tabindex="-1"></a>                              <span class="fu">c</span>(<span class="fu">min</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">:</span><span class="fu">max</span>(data_stat_nodupl<span class="sc">$</span>year_funding_first, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb58-5"><a href="projects-funded-by-the-afd.html#cb58-5" tabindex="-1"></a>)</span>
<span id="cb58-6"><a href="projects-funded-by-the-afd.html#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="projects-funded-by-the-afd.html#cb58-7" tabindex="-1"></a></span>
<span id="cb58-8"><a href="projects-funded-by-the-afd.html#cb58-8" tabindex="-1"></a>data_time_area <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb58-9"><a href="projects-funded-by-the-afd.html#cb58-9" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> roi <span class="sc">&amp;</span> marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-10"><a href="projects-funded-by-the-afd.html#cb58-10" tabindex="-1"></a>  <span class="co">#filter(is.na(year_funding_first) == FALSE) %&gt;%</span></span>
<span id="cb58-11"><a href="projects-funded-by-the-afd.html#cb58-11" tabindex="-1"></a>  <span class="fu">group_by</span>(year_funding_first) <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="projects-funded-by-the-afd.html#cb58-12" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">tot_area_km2 =</span> <span class="fu">sum</span>(area_km2),</span>
<span id="cb58-13"><a href="projects-funded-by-the-afd.html#cb58-13" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="projects-funded-by-the-afd.html#cb58-14" tabindex="-1"></a>  <span class="fu">left_join</span>(pa_int_yr, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;annee_int&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-15"><a href="projects-funded-by-the-afd.html#cb58-15" tabindex="-1"></a>  <span class="fu">full_join</span>(data_time_range, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year_funding_first&quot;</span> <span class="ot">=</span> <span class="st">&quot;year&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-16"><a href="projects-funded-by-the-afd.html#cb58-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_area_km2 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(tot_area_km2)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>tot_area_km2),</span>
<span id="cb58-17"><a href="projects-funded-by-the-afd.html#cb58-17" tabindex="-1"></a>         <span class="at">tot_int_km2 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(tot_int_km2)<span class="sc">~</span><span class="dv">0</span>, <span class="cn">TRUE</span><span class="sc">~</span>tot_int_km2),</span>
<span id="cb58-18"><a href="projects-funded-by-the-afd.html#cb58-18" tabindex="-1"></a>         <span class="at">tot_area_noint_km2 =</span> tot_area_km2 <span class="sc">-</span> tot_int_km2) <span class="sc">%&gt;%</span></span>
<span id="cb58-19"><a href="projects-funded-by-the-afd.html#cb58-19" tabindex="-1"></a>  <span class="fu">arrange</span>(year_funding_first)</span>
<span id="cb58-20"><a href="projects-funded-by-the-afd.html#cb58-20" tabindex="-1"></a></span>
<span id="cb58-21"><a href="projects-funded-by-the-afd.html#cb58-21" tabindex="-1"></a><span class="co">#Evolution of area over time</span></span>
<span id="cb58-22"><a href="projects-funded-by-the-afd.html#cb58-22" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb58-23"><a href="projects-funded-by-the-afd.html#cb58-23" tabindex="-1"></a>fig_area_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb58-24"><a href="projects-funded-by-the-afd.html#cb58-24" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> tot_area_noint_km2)) <span class="sc">%&gt;%</span></span>
<span id="cb58-25"><a href="projects-funded-by-the-afd.html#cb58-25" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-26"><a href="projects-funded-by-the-afd.html#cb58-26" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_area_noint_km2, </span>
<span id="cb58-27"><a href="projects-funded-by-the-afd.html#cb58-27" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">ifelse</span>(tot_area_noint_km2 <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb58-28"><a href="projects-funded-by-the-afd.html#cb58-28" tabindex="-1"></a>                                 <span class="fu">format</span>(tot_area_noint_km2, </span>
<span id="cb58-29"><a href="projects-funded-by-the-afd.html#cb58-29" tabindex="-1"></a>                                        <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb58-30"><a href="projects-funded-by-the-afd.html#cb58-30" tabindex="-1"></a>                                        <span class="at">scientific =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-31"><a href="projects-funded-by-the-afd.html#cb58-31" tabindex="-1"></a>                                 <span class="cn">NA</span>)), </span>
<span id="cb58-32"><a href="projects-funded-by-the-afd.html#cb58-32" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-33"><a href="projects-funded-by-the-afd.html#cb58-33" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">&quot;log10&quot;</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb58-34"><a href="projects-funded-by-the-afd.html#cb58-34" tabindex="-1"></a>                  <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">%&gt;%</span></span>
<span id="cb58-35"><a href="projects-funded-by-the-afd.html#cb58-35" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">base =</span> <span class="dv">10</span>, <span class="at">sides =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb58-36"><a href="projects-funded-by-the-afd.html#cb58-36" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">outside =</span> <span class="st">&quot;TRUE&quot;</span>,</span>
<span id="cb58-37"><a href="projects-funded-by-the-afd.html#cb58-37" tabindex="-1"></a>                        <span class="at">short =</span> <span class="fu">unit</span>(.<span class="dv">5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb58-38"><a href="projects-funded-by-the-afd.html#cb58-38" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb58-39"><a href="projects-funded-by-the-afd.html#cb58-39" tabindex="-1"></a>                        <span class="at">long =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">&quot;mm&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-40"><a href="projects-funded-by-the-afd.html#cb58-40" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-41"><a href="projects-funded-by-the-afd.html#cb58-41" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Evolution de la superficie non-marine financée par l&#39;AFD,&quot;</span>, roi), </span>
<span id="cb58-42"><a href="projects-funded-by-the-afd.html#cb58-42" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;aires protégées couvrant&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb58-43"><a href="projects-funded-by-the-afd.html#cb58-43" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Sur les &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; aires protégées financées recensées, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; ont une date de financement connue.</span><span class="sc">\n</span><span class="st">Soit &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² sur &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb58-44"><a href="projects-funded-by-the-afd.html#cb58-44" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb58-45"><a href="projects-funded-by-the-afd.html#cb58-45" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Superficie (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-46"><a href="projects-funded-by-the-afd.html#cb58-46" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb58-47"><a href="projects-funded-by-the-afd.html#cb58-47" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb58-48"><a href="projects-funded-by-the-afd.html#cb58-48" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb58-49"><a href="projects-funded-by-the-afd.html#cb58-49" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb58-50"><a href="projects-funded-by-the-afd.html#cb58-50" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb58-51"><a href="projects-funded-by-the-afd.html#cb58-51" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb58-52"><a href="projects-funded-by-the-afd.html#cb58-52" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-53"><a href="projects-funded-by-the-afd.html#cb58-53" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-54"><a href="projects-funded-by-the-afd.html#cb58-54" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-55"><a href="projects-funded-by-the-afd.html#cb58-55" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb58-56"><a href="projects-funded-by-the-afd.html#cb58-56" tabindex="-1"></a>fig_area_pa_fr</span>
<span id="cb58-57"><a href="projects-funded-by-the-afd.html#cb58-57" tabindex="-1"></a><span class="do">##English</span></span>
<span id="cb58-58"><a href="projects-funded-by-the-afd.html#cb58-58" tabindex="-1"></a>fig_area_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb58-59"><a href="projects-funded-by-the-afd.html#cb58-59" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first), <span class="at">y =</span> tot_area_noint_km2)) <span class="sc">%&gt;%</span></span>
<span id="cb58-60"><a href="projects-funded-by-the-afd.html#cb58-60" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-61"><a href="projects-funded-by-the-afd.html#cb58-61" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_area_noint_km2, </span>
<span id="cb58-62"><a href="projects-funded-by-the-afd.html#cb58-62" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">ifelse</span>(tot_area_noint_km2 <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb58-63"><a href="projects-funded-by-the-afd.html#cb58-63" tabindex="-1"></a>                                 <span class="fu">format</span>(tot_area_noint_km2, </span>
<span id="cb58-64"><a href="projects-funded-by-the-afd.html#cb58-64" tabindex="-1"></a>                                        <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb58-65"><a href="projects-funded-by-the-afd.html#cb58-65" tabindex="-1"></a>                                        <span class="at">scientific =</span> <span class="cn">TRUE</span>),</span>
<span id="cb58-66"><a href="projects-funded-by-the-afd.html#cb58-66" tabindex="-1"></a>                                 <span class="cn">NA</span>)), </span>
<span id="cb58-67"><a href="projects-funded-by-the-afd.html#cb58-67" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-68"><a href="projects-funded-by-the-afd.html#cb58-68" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">trans_breaks</span>(<span class="st">&quot;log10&quot;</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb58-69"><a href="projects-funded-by-the-afd.html#cb58-69" tabindex="-1"></a>                  <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">trans_format</span>(<span class="st">&quot;log10&quot;</span>, scales<span class="sc">::</span><span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">%&gt;%</span></span>
<span id="cb58-70"><a href="projects-funded-by-the-afd.html#cb58-70" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">base =</span> <span class="dv">10</span>, <span class="at">sides =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb58-71"><a href="projects-funded-by-the-afd.html#cb58-71" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;grey20&quot;</span>, <span class="at">outside =</span> <span class="st">&quot;TRUE&quot;</span>,</span>
<span id="cb58-72"><a href="projects-funded-by-the-afd.html#cb58-72" tabindex="-1"></a>                        <span class="at">short =</span> <span class="fu">unit</span>(.<span class="dv">5</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb58-73"><a href="projects-funded-by-the-afd.html#cb58-73" tabindex="-1"></a>                        <span class="at">mid =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;mm&quot;</span>),</span>
<span id="cb58-74"><a href="projects-funded-by-the-afd.html#cb58-74" tabindex="-1"></a>                        <span class="at">long =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">&quot;mm&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb58-75"><a href="projects-funded-by-the-afd.html#cb58-75" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-76"><a href="projects-funded-by-the-afd.html#cb58-76" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Evolution of AFD funded non-marine protected areas,&quot;</span>, roi),</span>
<span id="cb58-77"><a href="projects-funded-by-the-afd.html#cb58-77" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb58-78"><a href="projects-funded-by-the-afd.html#cb58-78" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Out of &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; known funded protected areas, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; have a known funding year.</span><span class="sc">\n</span><span class="st">In terms of area, &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² out of &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb58-79"><a href="projects-funded-by-the-afd.html#cb58-79" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb58-80"><a href="projects-funded-by-the-afd.html#cb58-80" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Area (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-81"><a href="projects-funded-by-the-afd.html#cb58-81" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb58-82"><a href="projects-funded-by-the-afd.html#cb58-82" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb58-83"><a href="projects-funded-by-the-afd.html#cb58-83" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb58-84"><a href="projects-funded-by-the-afd.html#cb58-84" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb58-85"><a href="projects-funded-by-the-afd.html#cb58-85" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb58-86"><a href="projects-funded-by-the-afd.html#cb58-86" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb58-87"><a href="projects-funded-by-the-afd.html#cb58-87" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-88"><a href="projects-funded-by-the-afd.html#cb58-88" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-89"><a href="projects-funded-by-the-afd.html#cb58-89" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-90"><a href="projects-funded-by-the-afd.html#cb58-90" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb58-91"><a href="projects-funded-by-the-afd.html#cb58-91" tabindex="-1"></a>fig_area_pa_en</span>
<span id="cb58-92"><a href="projects-funded-by-the-afd.html#cb58-92" tabindex="-1"></a></span>
<span id="cb58-93"><a href="projects-funded-by-the-afd.html#cb58-93" tabindex="-1"></a></span>
<span id="cb58-94"><a href="projects-funded-by-the-afd.html#cb58-94" tabindex="-1"></a></span>
<span id="cb58-95"><a href="projects-funded-by-the-afd.html#cb58-95" tabindex="-1"></a><span class="co">#Cumulative area over time</span></span>
<span id="cb58-96"><a href="projects-funded-by-the-afd.html#cb58-96" tabindex="-1"></a><span class="do">##French</span></span>
<span id="cb58-97"><a href="projects-funded-by-the-afd.html#cb58-97" tabindex="-1"></a>fig_area_cum_pa_fr <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb58-98"><a href="projects-funded-by-the-afd.html#cb58-98" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first),</span>
<span id="cb58-99"><a href="projects-funded-by-the-afd.html#cb58-99" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2))) <span class="sc">%&gt;%</span></span>
<span id="cb58-100"><a href="projects-funded-by-the-afd.html#cb58-100" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb58-101"><a href="projects-funded-by-the-afd.html#cb58-101" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb58-102"><a href="projects-funded-by-the-afd.html#cb58-102" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-103"><a href="projects-funded-by-the-afd.html#cb58-103" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb58-104"><a href="projects-funded-by-the-afd.html#cb58-104" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">format</span>(<span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb58-105"><a href="projects-funded-by-the-afd.html#cb58-105" tabindex="-1"></a>                                 <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb58-106"><a href="projects-funded-by-the-afd.html#cb58-106" tabindex="-1"></a>                                 <span class="at">scientific =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb58-107"><a href="projects-funded-by-the-afd.html#cb58-107" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-108"><a href="projects-funded-by-the-afd.html#cb58-108" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Evolution cumulée de la superficie des aires protégées non-marines financées par l&#39;AFD</span><span class="sc">\n</span><span class="st">&quot;</span>, roi),</span>
<span id="cb58-109"><a href="projects-funded-by-the-afd.html#cb58-109" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;aires protégées couvrant&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb58-110"><a href="projects-funded-by-the-afd.html#cb58-110" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Sur les &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; aires protégées financées recensées, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; ont une date de financement connue.</span><span class="sc">\n</span><span class="st">Soit &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² sur &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb58-111"><a href="projects-funded-by-the-afd.html#cb58-111" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Année&quot;</span>,</span>
<span id="cb58-112"><a href="projects-funded-by-the-afd.html#cb58-112" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Superficie (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-113"><a href="projects-funded-by-the-afd.html#cb58-113" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb58-114"><a href="projects-funded-by-the-afd.html#cb58-114" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb58-115"><a href="projects-funded-by-the-afd.html#cb58-115" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb58-116"><a href="projects-funded-by-the-afd.html#cb58-116" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb58-117"><a href="projects-funded-by-the-afd.html#cb58-117" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb58-118"><a href="projects-funded-by-the-afd.html#cb58-118" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb58-119"><a href="projects-funded-by-the-afd.html#cb58-119" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-120"><a href="projects-funded-by-the-afd.html#cb58-120" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-121"><a href="projects-funded-by-the-afd.html#cb58-121" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-122"><a href="projects-funded-by-the-afd.html#cb58-122" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb58-123"><a href="projects-funded-by-the-afd.html#cb58-123" tabindex="-1"></a>fig_area_cum_pa_fr</span>
<span id="cb58-124"><a href="projects-funded-by-the-afd.html#cb58-124" tabindex="-1"></a><span class="co">#English</span></span>
<span id="cb58-125"><a href="projects-funded-by-the-afd.html#cb58-125" tabindex="-1"></a>fig_area_cum_pa_en <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb58-126"><a href="projects-funded-by-the-afd.html#cb58-126" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(year_funding_first),</span>
<span id="cb58-127"><a href="projects-funded-by-the-afd.html#cb58-127" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2))) <span class="sc">%&gt;%</span></span>
<span id="cb58-128"><a href="projects-funded-by-the-afd.html#cb58-128" tabindex="-1"></a>  <span class="co"># + geom_point(color = &quot;#3182BD&quot;, size = 1.5) %&gt;%</span></span>
<span id="cb58-129"><a href="projects-funded-by-the-afd.html#cb58-129" tabindex="-1"></a>  <span class="co"># + geom_line(color = &quot;#3182BD&quot;, size = 1) %&gt;% </span></span>
<span id="cb58-130"><a href="projects-funded-by-the-afd.html#cb58-130" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">fill =</span> <span class="st">&quot;#3182BD&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-131"><a href="projects-funded-by-the-afd.html#cb58-131" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb58-132"><a href="projects-funded-by-the-afd.html#cb58-132" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">format</span>(<span class="fu">cumsum</span>(tot_area_noint_km2), </span>
<span id="cb58-133"><a href="projects-funded-by-the-afd.html#cb58-133" tabindex="-1"></a>                                 <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb58-134"><a href="projects-funded-by-the-afd.html#cb58-134" tabindex="-1"></a>                                 <span class="at">scientific =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb58-135"><a href="projects-funded-by-the-afd.html#cb58-135" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-136"><a href="projects-funded-by-the-afd.html#cb58-136" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Cumulated evolution of non-marine protected areas funded by AFD,&quot;</span>, roi),</span>
<span id="cb58-137"><a href="projects-funded-by-the-afd.html#cb58-137" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;protected areas covering&quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot;km²&quot;</span>),</span>
<span id="cb58-138"><a href="projects-funded-by-the-afd.html#cb58-138" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Out of &quot;</span>, <span class="fu">sum</span>(data_time_area<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; known funded protected areas, &quot;</span>, <span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot; have a known funding year.</span><span class="sc">\n</span><span class="st">In terms of area, &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(<span class="fu">subset</span>(data_time_area, <span class="fu">is.na</span>(year_funding_first) <span class="sc">==</span> <span class="cn">FALSE</span>)<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km² out of &quot;</span>, <span class="fu">format</span>(<span class="fu">sum</span>(data_time_area<span class="sc">$</span>tot_area_noint_km2), <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>, <span class="at">big.mark =</span> <span class="st">&quot; &quot;</span>), <span class="st">&quot; km².&quot;</span>),</span>
<span id="cb58-139"><a href="projects-funded-by-the-afd.html#cb58-139" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb58-140"><a href="projects-funded-by-the-afd.html#cb58-140" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Area (km²)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-141"><a href="projects-funded-by-the-afd.html#cb58-141" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb58-142"><a href="projects-funded-by-the-afd.html#cb58-142" tabindex="-1"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb58-143"><a href="projects-funded-by-the-afd.html#cb58-143" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb58-144"><a href="projects-funded-by-the-afd.html#cb58-144" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust =</span> .<span class="dv">5</span>, <span class="at">vjust =</span> .<span class="dv">6</span>),</span>
<span id="cb58-145"><a href="projects-funded-by-the-afd.html#cb58-145" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb58-146"><a href="projects-funded-by-the-afd.html#cb58-146" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;white&#39;</span>, </span>
<span id="cb58-147"><a href="projects-funded-by-the-afd.html#cb58-147" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-148"><a href="projects-funded-by-the-afd.html#cb58-148" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-149"><a href="projects-funded-by-the-afd.html#cb58-149" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&#39;grey90&#39;</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>),</span>
<span id="cb58-150"><a href="projects-funded-by-the-afd.html#cb58-150" tabindex="-1"></a>      <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&#39;grey50&#39;</span>, <span class="at">size =</span> <span class="fl">8.5</span>, <span class="at">face =</span> <span class="st">&#39;plain&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb58-151"><a href="projects-funded-by-the-afd.html#cb58-151" tabindex="-1"></a>fig_area_cum_pa_en</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="projects-funded-by-the-afd.html#cb59-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb59-2"><a href="projects-funded-by-the-afd.html#cb59-2" tabindex="-1"></a></span>
<span id="cb59-3"><a href="projects-funded-by-the-afd.html#cb59-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb59-4"><a href="projects-funded-by-the-afd.html#cb59-4" tabindex="-1"></a></span>
<span id="cb59-5"><a href="projects-funded-by-the-afd.html#cb59-5" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb59-6"><a href="projects-funded-by-the-afd.html#cb59-6" tabindex="-1"></a>       fig_area_pa_fr,</span>
<span id="cb59-7"><a href="projects-funded-by-the-afd.html#cb59-7" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb59-8"><a href="projects-funded-by-the-afd.html#cb59-8" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb59-9"><a href="projects-funded-by-the-afd.html#cb59-9" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb59-10"><a href="projects-funded-by-the-afd.html#cb59-10" tabindex="-1"></a>       fig_area_pa_en,</span>
<span id="cb59-11"><a href="projects-funded-by-the-afd.html#cb59-11" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb59-12"><a href="projects-funded-by-the-afd.html#cb59-12" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb59-13"><a href="projects-funded-by-the-afd.html#cb59-13" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_cum_pa_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb59-14"><a href="projects-funded-by-the-afd.html#cb59-14" tabindex="-1"></a>       fig_area_cum_pa_fr,</span>
<span id="cb59-15"><a href="projects-funded-by-the-afd.html#cb59-15" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb59-16"><a href="projects-funded-by-the-afd.html#cb59-16" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb59-17"><a href="projects-funded-by-the-afd.html#cb59-17" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;fig_area_cum_pa_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb59-18"><a href="projects-funded-by-the-afd.html#cb59-18" tabindex="-1"></a>       fig_area_cum_pa_en,</span>
<span id="cb59-19"><a href="projects-funded-by-the-afd.html#cb59-19" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb59-20"><a href="projects-funded-by-the-afd.html#cb59-20" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb59-21"><a href="projects-funded-by-the-afd.html#cb59-21" tabindex="-1"></a></span>
<span id="cb59-22"><a href="projects-funded-by-the-afd.html#cb59-22" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb59-23"><a href="projects-funded-by-the-afd.html#cb59-23" tabindex="-1"></a></span>
<span id="cb59-24"><a href="projects-funded-by-the-afd.html#cb59-24" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb59-25"><a href="projects-funded-by-the-afd.html#cb59-25" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-26"><a href="projects-funded-by-the-afd.html#cb59-26" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb59-27"><a href="projects-funded-by-the-afd.html#cb59-27" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb59-28"><a href="projects-funded-by-the-afd.html#cb59-28" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb59-29"><a href="projects-funded-by-the-afd.html#cb59-29" tabindex="-1"></a>{</span>
<span id="cb59-30"><a href="projects-funded-by-the-afd.html#cb59-30" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb59-31"><a href="projects-funded-by-the-afd.html#cb59-31" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb59-32"><a href="projects-funded-by-the-afd.html#cb59-32" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb59-33"><a href="projects-funded-by-the-afd.html#cb59-33" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="fu">paste</span>(<span class="st">&quot;projet-afd-eva-ap/descriptive_stats/time_evolution&quot;</span>, roi, <span class="st">&quot;no_marine&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), </span>
<span id="cb59-34"><a href="projects-funded-by-the-afd.html#cb59-34" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-35"><a href="projects-funded-by-the-afd.html#cb59-35" tabindex="-1"></a>  }</span>
<span id="cb59-36"><a href="projects-funded-by-the-afd.html#cb59-36" tabindex="-1"></a></span>
<span id="cb59-37"><a href="projects-funded-by-the-afd.html#cb59-37" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb59-38"><a href="projects-funded-by-the-afd.html#cb59-38" tabindex="-1"></a></span>
<span id="cb59-39"><a href="projects-funded-by-the-afd.html#cb59-39" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
</div>
<div id="governance" class="section level3 hasAnchor" number="2.3.6">
<h3><span class="header-section-number">2.3.6</span> Governance<a href="projects-funded-by-the-afd.html#governance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="world-all" class="section level4 hasAnchor" number="2.3.6.1">
<h4><span class="header-section-number">2.3.6.1</span> World, all<a href="projects-funded-by-the-afd.html#world-all" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="projects-funded-by-the-afd.html#cb60-1" tabindex="-1"></a><span class="co">#Table of the governance type distribution</span></span>
<span id="cb60-2"><a href="projects-funded-by-the-afd.html#cb60-2" tabindex="-1"></a><span class="do">##English version</span></span>
<span id="cb60-3"><a href="projects-funded-by-the-afd.html#cb60-3" tabindex="-1"></a>data_gov_en <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="projects-funded-by-the-afd.html#cb60-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not referenced&quot;</span>,</span>
<span id="cb60-5"><a href="projects-funded-by-the-afd.html#cb60-5" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb60-6"><a href="projects-funded-by-the-afd.html#cb60-6" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb60-7"><a href="projects-funded-by-the-afd.html#cb60-7" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb60-8"><a href="projects-funded-by-the-afd.html#cb60-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb60-9"><a href="projects-funded-by-the-afd.html#cb60-9" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-10"><a href="projects-funded-by-the-afd.html#cb60-10" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="projects-funded-by-the-afd.html#cb60-11" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb60-12"><a href="projects-funded-by-the-afd.html#cb60-12" tabindex="-1"></a></span>
<span id="cb60-13"><a href="projects-funded-by-the-afd.html#cb60-13" tabindex="-1"></a>tbl_gov_en <span class="ot">=</span> data_gov_en</span>
<span id="cb60-14"><a href="projects-funded-by-the-afd.html#cb60-14" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_en) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Governance&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>,<span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb60-15"><a href="projects-funded-by-the-afd.html#cb60-15" tabindex="-1"></a></span>
<span id="cb60-16"><a href="projects-funded-by-the-afd.html#cb60-16" tabindex="-1"></a></span>
<span id="cb60-17"><a href="projects-funded-by-the-afd.html#cb60-17" tabindex="-1"></a><span class="do">##French Version</span></span>
<span id="cb60-18"><a href="projects-funded-by-the-afd.html#cb60-18" tabindex="-1"></a>data_gov_fr <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb60-19"><a href="projects-funded-by-the-afd.html#cb60-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Non référencée&quot;</span>,</span>
<span id="cb60-20"><a href="projects-funded-by-the-afd.html#cb60-20" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Collaborative governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance collaborative&quot;</span>,</span>
<span id="cb60-21"><a href="projects-funded-by-the-afd.html#cb60-21" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb60-22"><a href="projects-funded-by-the-afd.html#cb60-22" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb60-23"><a href="projects-funded-by-the-afd.html#cb60-23" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Government-delegated management&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gestion déléguée par le gouvernement&quot;</span>,</span>
<span id="cb60-24"><a href="projects-funded-by-the-afd.html#cb60-24" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Indigenous peoples&quot;</span> <span class="sc">~</span> <span class="st">&quot;Peuples indigènes&quot;</span>,</span>
<span id="cb60-25"><a href="projects-funded-by-the-afd.html#cb60-25" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Joint governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance conjointe&quot;</span>,</span>
<span id="cb60-26"><a href="projects-funded-by-the-afd.html#cb60-26" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Local communities&quot;</span> <span class="sc">~</span> <span class="st">&quot;Communautés locales&quot;</span>,</span>
<span id="cb60-27"><a href="projects-funded-by-the-afd.html#cb60-27" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Non-profit organisations&quot;</span> <span class="sc">~</span> <span class="st">&quot;Organisations non-lucratives&quot;</span>,</span>
<span id="cb60-28"><a href="projects-funded-by-the-afd.html#cb60-28" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">~</span> <span class="st">&quot;Non rapportée&quot;</span>,</span>
<span id="cb60-29"><a href="projects-funded-by-the-afd.html#cb60-29" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Sub-national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence sous-nationale&quot;</span>,</span>
<span id="cb60-30"><a href="projects-funded-by-the-afd.html#cb60-30" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb60-31"><a href="projects-funded-by-the-afd.html#cb60-31" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb60-32"><a href="projects-funded-by-the-afd.html#cb60-32" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb60-33"><a href="projects-funded-by-the-afd.html#cb60-33" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb60-34"><a href="projects-funded-by-the-afd.html#cb60-34" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-35"><a href="projects-funded-by-the-afd.html#cb60-35" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb60-36"><a href="projects-funded-by-the-afd.html#cb60-36" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb60-37"><a href="projects-funded-by-the-afd.html#cb60-37" tabindex="-1"></a></span>
<span id="cb60-38"><a href="projects-funded-by-the-afd.html#cb60-38" tabindex="-1"></a>tbl_gov_fr <span class="ot">=</span> data_gov_fr</span>
<span id="cb60-39"><a href="projects-funded-by-the-afd.html#cb60-39" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_fr) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Gouvernance&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>,<span class="st">&quot;Proportion (%)&quot;</span>)</span>
<span id="cb60-40"><a href="projects-funded-by-the-afd.html#cb60-40" tabindex="-1"></a></span>
<span id="cb60-41"><a href="projects-funded-by-the-afd.html#cb60-41" tabindex="-1"></a></span>
<span id="cb60-42"><a href="projects-funded-by-the-afd.html#cb60-42" tabindex="-1"></a></span>
<span id="cb60-43"><a href="projects-funded-by-the-afd.html#cb60-43" tabindex="-1"></a><span class="co">#PAs with nureported or unreferenced governance types are removed</span></span>
<span id="cb60-44"><a href="projects-funded-by-the-afd.html#cb60-44" tabindex="-1"></a><span class="do">##Tables</span></span>
<span id="cb60-45"><a href="projects-funded-by-the-afd.html#cb60-45" tabindex="-1"></a><span class="do">###English</span></span>
<span id="cb60-46"><a href="projects-funded-by-the-afd.html#cb60-46" tabindex="-1"></a>data_gov_knwn_en <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb60-47"><a href="projects-funded-by-the-afd.html#cb60-47" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not referenced&quot;</span>,</span>
<span id="cb60-48"><a href="projects-funded-by-the-afd.html#cb60-48" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb60-49"><a href="projects-funded-by-the-afd.html#cb60-49" tabindex="-1"></a>  <span class="fu">filter</span>(gov_type <span class="sc">!=</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">&amp;</span> gov_type <span class="sc">!=</span> <span class="st">&quot;Not referenced&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-50"><a href="projects-funded-by-the-afd.html#cb60-50" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb60-51"><a href="projects-funded-by-the-afd.html#cb60-51" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb60-52"><a href="projects-funded-by-the-afd.html#cb60-52" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb60-53"><a href="projects-funded-by-the-afd.html#cb60-53" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-54"><a href="projects-funded-by-the-afd.html#cb60-54" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb60-55"><a href="projects-funded-by-the-afd.html#cb60-55" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb60-56"><a href="projects-funded-by-the-afd.html#cb60-56" tabindex="-1"></a></span>
<span id="cb60-57"><a href="projects-funded-by-the-afd.html#cb60-57" tabindex="-1"></a>tbl_gov_knwn_en <span class="ot">=</span> data_gov_knwn_en</span>
<span id="cb60-58"><a href="projects-funded-by-the-afd.html#cb60-58" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_knwn_en) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Governance&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>,<span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb60-59"><a href="projects-funded-by-the-afd.html#cb60-59" tabindex="-1"></a></span>
<span id="cb60-60"><a href="projects-funded-by-the-afd.html#cb60-60" tabindex="-1"></a><span class="do">###French</span></span>
<span id="cb60-61"><a href="projects-funded-by-the-afd.html#cb60-61" tabindex="-1"></a>data_gov_knwn_fr <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb60-62"><a href="projects-funded-by-the-afd.html#cb60-62" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Non référencée&quot;</span>,</span>
<span id="cb60-63"><a href="projects-funded-by-the-afd.html#cb60-63" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Collaborative governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance collaborative&quot;</span>,</span>
<span id="cb60-64"><a href="projects-funded-by-the-afd.html#cb60-64" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb60-65"><a href="projects-funded-by-the-afd.html#cb60-65" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb60-66"><a href="projects-funded-by-the-afd.html#cb60-66" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Government-delegated management&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gestion déléguée par le gouvernement&quot;</span>,</span>
<span id="cb60-67"><a href="projects-funded-by-the-afd.html#cb60-67" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Indigenous peoples&quot;</span> <span class="sc">~</span> <span class="st">&quot;Peuples indigènes&quot;</span>,</span>
<span id="cb60-68"><a href="projects-funded-by-the-afd.html#cb60-68" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Joint governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance conjointe&quot;</span>,</span>
<span id="cb60-69"><a href="projects-funded-by-the-afd.html#cb60-69" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Local communities&quot;</span> <span class="sc">~</span> <span class="st">&quot;Communautés locales&quot;</span>,</span>
<span id="cb60-70"><a href="projects-funded-by-the-afd.html#cb60-70" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Non-profit organisations&quot;</span> <span class="sc">~</span> <span class="st">&quot;Organisations non-lucratives&quot;</span>,</span>
<span id="cb60-71"><a href="projects-funded-by-the-afd.html#cb60-71" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">~</span> <span class="st">&quot;Non rapportée&quot;</span>,</span>
<span id="cb60-72"><a href="projects-funded-by-the-afd.html#cb60-72" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Sub-national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence sous-nationale&quot;</span>,</span>
<span id="cb60-73"><a href="projects-funded-by-the-afd.html#cb60-73" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb60-74"><a href="projects-funded-by-the-afd.html#cb60-74" tabindex="-1"></a>  <span class="fu">filter</span>(gov_type <span class="sc">!=</span> <span class="st">&quot;Non référencée&quot;</span> <span class="sc">&amp;</span> gov_type <span class="sc">!=</span> <span class="st">&quot;Non rapportée&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-75"><a href="projects-funded-by-the-afd.html#cb60-75" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb60-76"><a href="projects-funded-by-the-afd.html#cb60-76" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb60-77"><a href="projects-funded-by-the-afd.html#cb60-77" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb60-78"><a href="projects-funded-by-the-afd.html#cb60-78" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-79"><a href="projects-funded-by-the-afd.html#cb60-79" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb60-80"><a href="projects-funded-by-the-afd.html#cb60-80" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb60-81"><a href="projects-funded-by-the-afd.html#cb60-81" tabindex="-1"></a></span>
<span id="cb60-82"><a href="projects-funded-by-the-afd.html#cb60-82" tabindex="-1"></a>tbl_gov_knwn_fr <span class="ot">=</span> data_gov_knwn_fr</span>
<span id="cb60-83"><a href="projects-funded-by-the-afd.html#cb60-83" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_knwn_fr) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Gouvernance&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>,<span class="st">&quot;Proportion (%)&quot;</span>)</span>
<span id="cb60-84"><a href="projects-funded-by-the-afd.html#cb60-84" tabindex="-1"></a> </span>
<span id="cb60-85"><a href="projects-funded-by-the-afd.html#cb60-85" tabindex="-1"></a></span>
<span id="cb60-86"><a href="projects-funded-by-the-afd.html#cb60-86" tabindex="-1"></a><span class="do">##Pie charts</span></span>
<span id="cb60-87"><a href="projects-funded-by-the-afd.html#cb60-87" tabindex="-1"></a><span class="do">###English</span></span>
<span id="cb60-88"><a href="projects-funded-by-the-afd.html#cb60-88" tabindex="-1"></a>pie_gov_knwn_en <span class="ot">=</span> </span>
<span id="cb60-89"><a href="projects-funded-by-the-afd.html#cb60-89" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_gov_knwn_en, </span>
<span id="cb60-90"><a href="projects-funded-by-the-afd.html#cb60-90" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq, <span class="at">fill=</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb60-91"><a href="projects-funded-by-the-afd.html#cb60-91" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-92"><a href="projects-funded-by-the-afd.html#cb60-92" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, </span>
<span id="cb60-93"><a href="projects-funded-by-the-afd.html#cb60-93" tabindex="-1"></a>                   <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">format</span>(freq, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb60-94"><a href="projects-funded-by-the-afd.html#cb60-94" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb60-95"><a href="projects-funded-by-the-afd.html#cb60-95" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb60-96"><a href="projects-funded-by-the-afd.html#cb60-96" tabindex="-1"></a>               <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-97"><a href="projects-funded-by-the-afd.html#cb60-97" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-98"><a href="projects-funded-by-the-afd.html#cb60-98" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Governance type of protected areas except not referenced/reported&quot;</span>,</span>
<span id="cb60-99"><a href="projects-funded-by-the-afd.html#cb60-99" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_gov_knwn_en<span class="sc">$</span>n), <span class="st">&quot;protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-100"><a href="projects-funded-by-the-afd.html#cb60-100" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Governance&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-101"><a href="projects-funded-by-the-afd.html#cb60-101" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb60-102"><a href="projects-funded-by-the-afd.html#cb60-102" tabindex="-1"></a>pie_gov_knwn_en</span>
<span id="cb60-103"><a href="projects-funded-by-the-afd.html#cb60-103" tabindex="-1"></a></span>
<span id="cb60-104"><a href="projects-funded-by-the-afd.html#cb60-104" tabindex="-1"></a></span>
<span id="cb60-105"><a href="projects-funded-by-the-afd.html#cb60-105" tabindex="-1"></a><span class="do">###French</span></span>
<span id="cb60-106"><a href="projects-funded-by-the-afd.html#cb60-106" tabindex="-1"></a>pie_gov_knwn_fr <span class="ot">=</span></span>
<span id="cb60-107"><a href="projects-funded-by-the-afd.html#cb60-107" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_gov_knwn_fr, </span>
<span id="cb60-108"><a href="projects-funded-by-the-afd.html#cb60-108" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq, <span class="at">fill=</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb60-109"><a href="projects-funded-by-the-afd.html#cb60-109" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-110"><a href="projects-funded-by-the-afd.html#cb60-110" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, </span>
<span id="cb60-111"><a href="projects-funded-by-the-afd.html#cb60-111" tabindex="-1"></a>                   <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">format</span>(freq, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb60-112"><a href="projects-funded-by-the-afd.html#cb60-112" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb60-113"><a href="projects-funded-by-the-afd.html#cb60-113" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb60-114"><a href="projects-funded-by-the-afd.html#cb60-114" tabindex="-1"></a>               <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-115"><a href="projects-funded-by-the-afd.html#cb60-115" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-116"><a href="projects-funded-by-the-afd.html#cb60-116" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gouvernance, hors non-rapportées/référencées&quot;</span>,</span>
<span id="cb60-117"><a href="projects-funded-by-the-afd.html#cb60-117" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_gov_knwn_fr<span class="sc">$</span>n), <span class="st">&quot;aires protégées&quot;</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb60-118"><a href="projects-funded-by-the-afd.html#cb60-118" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Gouvernance&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-119"><a href="projects-funded-by-the-afd.html#cb60-119" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb60-120"><a href="projects-funded-by-the-afd.html#cb60-120" tabindex="-1"></a>pie_gov_knwn_fr</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="projects-funded-by-the-afd.html#cb61-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb61-2"><a href="projects-funded-by-the-afd.html#cb61-2" tabindex="-1"></a></span>
<span id="cb61-3"><a href="projects-funded-by-the-afd.html#cb61-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb61-4"><a href="projects-funded-by-the-afd.html#cb61-4" tabindex="-1"></a></span>
<span id="cb61-5"><a href="projects-funded-by-the-afd.html#cb61-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_en,</span>
<span id="cb61-6"><a href="projects-funded-by-the-afd.html#cb61-6" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Governance of protected areas funded by AFD&quot;</span>,</span>
<span id="cb61-7"><a href="projects-funded-by-the-afd.html#cb61-7" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb61-8"><a href="projects-funded-by-the-afd.html#cb61-8" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_en.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb61-9"><a href="projects-funded-by-the-afd.html#cb61-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_fr,</span>
<span id="cb61-10"><a href="projects-funded-by-the-afd.html#cb61-10" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Gouvernance des aires protégées appuyées par l&#39;AFD&quot;</span>,</span>
<span id="cb61-11"><a href="projects-funded-by-the-afd.html#cb61-11" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb61-12"><a href="projects-funded-by-the-afd.html#cb61-12" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_fr.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb61-13"><a href="projects-funded-by-the-afd.html#cb61-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_knwn_en, </span>
<span id="cb61-14"><a href="projects-funded-by-the-afd.html#cb61-14" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Governance of protected areas funded by AFD (when known)&quot;</span>,</span>
<span id="cb61-15"><a href="projects-funded-by-the-afd.html#cb61-15" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb61-16"><a href="projects-funded-by-the-afd.html#cb61-16" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_knwn_en.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb61-17"><a href="projects-funded-by-the-afd.html#cb61-17" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_knwn_fr, </span>
<span id="cb61-18"><a href="projects-funded-by-the-afd.html#cb61-18" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Gouvernance des aires protégées appuyées par l&#39;AFD (si connu)&quot;</span>,</span>
<span id="cb61-19"><a href="projects-funded-by-the-afd.html#cb61-19" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb61-20"><a href="projects-funded-by-the-afd.html#cb61-20" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_knwn_fr.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb61-21"><a href="projects-funded-by-the-afd.html#cb61-21" tabindex="-1"></a></span>
<span id="cb61-22"><a href="projects-funded-by-the-afd.html#cb61-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot; pie_gov_knwn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb61-23"><a href="projects-funded-by-the-afd.html#cb61-23" tabindex="-1"></a>       <span class="at">plot =</span>  pie_gov_knwn_en,</span>
<span id="cb61-24"><a href="projects-funded-by-the-afd.html#cb61-24" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb61-25"><a href="projects-funded-by-the-afd.html#cb61-25" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb61-26"><a href="projects-funded-by-the-afd.html#cb61-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_gov_knwn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb61-27"><a href="projects-funded-by-the-afd.html#cb61-27" tabindex="-1"></a>       <span class="at">plot =</span> pie_gov_knwn_fr,</span>
<span id="cb61-28"><a href="projects-funded-by-the-afd.html#cb61-28" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb61-29"><a href="projects-funded-by-the-afd.html#cb61-29" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb61-30"><a href="projects-funded-by-the-afd.html#cb61-30" tabindex="-1"></a></span>
<span id="cb61-31"><a href="projects-funded-by-the-afd.html#cb61-31" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb61-32"><a href="projects-funded-by-the-afd.html#cb61-32" tabindex="-1"></a></span>
<span id="cb61-33"><a href="projects-funded-by-the-afd.html#cb61-33" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb61-34"><a href="projects-funded-by-the-afd.html#cb61-34" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-35"><a href="projects-funded-by-the-afd.html#cb61-35" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb61-36"><a href="projects-funded-by-the-afd.html#cb61-36" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb61-37"><a href="projects-funded-by-the-afd.html#cb61-37" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb61-38"><a href="projects-funded-by-the-afd.html#cb61-38" tabindex="-1"></a>{</span>
<span id="cb61-39"><a href="projects-funded-by-the-afd.html#cb61-39" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb61-40"><a href="projects-funded-by-the-afd.html#cb61-40" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb61-41"><a href="projects-funded-by-the-afd.html#cb61-41" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb61-42"><a href="projects-funded-by-the-afd.html#cb61-42" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/gouvernance/world/all&quot;</span>, </span>
<span id="cb61-43"><a href="projects-funded-by-the-afd.html#cb61-43" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-44"><a href="projects-funded-by-the-afd.html#cb61-44" tabindex="-1"></a>  }</span>
<span id="cb61-45"><a href="projects-funded-by-the-afd.html#cb61-45" tabindex="-1"></a></span>
<span id="cb61-46"><a href="projects-funded-by-the-afd.html#cb61-46" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb61-47"><a href="projects-funded-by-the-afd.html#cb61-47" tabindex="-1"></a></span>
<span id="cb61-48"><a href="projects-funded-by-the-afd.html#cb61-48" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="world-non-marine" class="section level4 hasAnchor" number="2.3.6.2">
<h4><span class="header-section-number">2.3.6.2</span> World, non-marine<a href="projects-funded-by-the-afd.html#world-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="projects-funded-by-the-afd.html#cb62-1" tabindex="-1"></a><span class="co">#Table of the governance type distribution</span></span>
<span id="cb62-2"><a href="projects-funded-by-the-afd.html#cb62-2" tabindex="-1"></a><span class="do">##English version</span></span>
<span id="cb62-3"><a href="projects-funded-by-the-afd.html#cb62-3" tabindex="-1"></a>data_gov_en <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="projects-funded-by-the-afd.html#cb62-4" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="projects-funded-by-the-afd.html#cb62-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not referenced&quot;</span>,</span>
<span id="cb62-6"><a href="projects-funded-by-the-afd.html#cb62-6" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="projects-funded-by-the-afd.html#cb62-7" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="projects-funded-by-the-afd.html#cb62-8" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="projects-funded-by-the-afd.html#cb62-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb62-10"><a href="projects-funded-by-the-afd.html#cb62-10" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="projects-funded-by-the-afd.html#cb62-11" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb62-12"><a href="projects-funded-by-the-afd.html#cb62-12" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb62-13"><a href="projects-funded-by-the-afd.html#cb62-13" tabindex="-1"></a></span>
<span id="cb62-14"><a href="projects-funded-by-the-afd.html#cb62-14" tabindex="-1"></a>tbl_gov_en <span class="ot">=</span> data_gov_en</span>
<span id="cb62-15"><a href="projects-funded-by-the-afd.html#cb62-15" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_en) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Governance&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>,<span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb62-16"><a href="projects-funded-by-the-afd.html#cb62-16" tabindex="-1"></a></span>
<span id="cb62-17"><a href="projects-funded-by-the-afd.html#cb62-17" tabindex="-1"></a></span>
<span id="cb62-18"><a href="projects-funded-by-the-afd.html#cb62-18" tabindex="-1"></a><span class="do">##French Version</span></span>
<span id="cb62-19"><a href="projects-funded-by-the-afd.html#cb62-19" tabindex="-1"></a>data_gov_fr <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb62-20"><a href="projects-funded-by-the-afd.html#cb62-20" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="projects-funded-by-the-afd.html#cb62-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Non référencée&quot;</span>,</span>
<span id="cb62-22"><a href="projects-funded-by-the-afd.html#cb62-22" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Collaborative governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance collaborative&quot;</span>,</span>
<span id="cb62-23"><a href="projects-funded-by-the-afd.html#cb62-23" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb62-24"><a href="projects-funded-by-the-afd.html#cb62-24" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb62-25"><a href="projects-funded-by-the-afd.html#cb62-25" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Government-delegated management&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gestion déléguée par le gouvernement&quot;</span>,</span>
<span id="cb62-26"><a href="projects-funded-by-the-afd.html#cb62-26" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Indigenous peoples&quot;</span> <span class="sc">~</span> <span class="st">&quot;Peuples indigènes&quot;</span>,</span>
<span id="cb62-27"><a href="projects-funded-by-the-afd.html#cb62-27" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Joint governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance conjointe&quot;</span>,</span>
<span id="cb62-28"><a href="projects-funded-by-the-afd.html#cb62-28" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Local communities&quot;</span> <span class="sc">~</span> <span class="st">&quot;Communautés locales&quot;</span>,</span>
<span id="cb62-29"><a href="projects-funded-by-the-afd.html#cb62-29" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Non-profit organisations&quot;</span> <span class="sc">~</span> <span class="st">&quot;Organisations non-lucratives&quot;</span>,</span>
<span id="cb62-30"><a href="projects-funded-by-the-afd.html#cb62-30" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">~</span> <span class="st">&quot;Non rapportée&quot;</span>,</span>
<span id="cb62-31"><a href="projects-funded-by-the-afd.html#cb62-31" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Sub-national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence sous-nationale&quot;</span>,</span>
<span id="cb62-32"><a href="projects-funded-by-the-afd.html#cb62-32" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb62-33"><a href="projects-funded-by-the-afd.html#cb62-33" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb62-34"><a href="projects-funded-by-the-afd.html#cb62-34" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb62-35"><a href="projects-funded-by-the-afd.html#cb62-35" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb62-36"><a href="projects-funded-by-the-afd.html#cb62-36" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-37"><a href="projects-funded-by-the-afd.html#cb62-37" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb62-38"><a href="projects-funded-by-the-afd.html#cb62-38" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb62-39"><a href="projects-funded-by-the-afd.html#cb62-39" tabindex="-1"></a></span>
<span id="cb62-40"><a href="projects-funded-by-the-afd.html#cb62-40" tabindex="-1"></a>tbl_gov_fr <span class="ot">=</span> data_gov_fr</span>
<span id="cb62-41"><a href="projects-funded-by-the-afd.html#cb62-41" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_fr) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Gouvernance&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>,<span class="st">&quot;Proportion (%)&quot;</span>)</span>
<span id="cb62-42"><a href="projects-funded-by-the-afd.html#cb62-42" tabindex="-1"></a></span>
<span id="cb62-43"><a href="projects-funded-by-the-afd.html#cb62-43" tabindex="-1"></a></span>
<span id="cb62-44"><a href="projects-funded-by-the-afd.html#cb62-44" tabindex="-1"></a></span>
<span id="cb62-45"><a href="projects-funded-by-the-afd.html#cb62-45" tabindex="-1"></a><span class="co">#PAs with nureported or unreferenced governance types are removed</span></span>
<span id="cb62-46"><a href="projects-funded-by-the-afd.html#cb62-46" tabindex="-1"></a><span class="do">##Tables</span></span>
<span id="cb62-47"><a href="projects-funded-by-the-afd.html#cb62-47" tabindex="-1"></a><span class="do">###English</span></span>
<span id="cb62-48"><a href="projects-funded-by-the-afd.html#cb62-48" tabindex="-1"></a>data_gov_knwn_en <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb62-49"><a href="projects-funded-by-the-afd.html#cb62-49" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-50"><a href="projects-funded-by-the-afd.html#cb62-50" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not referenced&quot;</span>,</span>
<span id="cb62-51"><a href="projects-funded-by-the-afd.html#cb62-51" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb62-52"><a href="projects-funded-by-the-afd.html#cb62-52" tabindex="-1"></a>  <span class="fu">filter</span>(gov_type <span class="sc">!=</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">&amp;</span> gov_type <span class="sc">!=</span> <span class="st">&quot;Not referenced&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-53"><a href="projects-funded-by-the-afd.html#cb62-53" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb62-54"><a href="projects-funded-by-the-afd.html#cb62-54" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb62-55"><a href="projects-funded-by-the-afd.html#cb62-55" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb62-56"><a href="projects-funded-by-the-afd.html#cb62-56" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-57"><a href="projects-funded-by-the-afd.html#cb62-57" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb62-58"><a href="projects-funded-by-the-afd.html#cb62-58" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb62-59"><a href="projects-funded-by-the-afd.html#cb62-59" tabindex="-1"></a></span>
<span id="cb62-60"><a href="projects-funded-by-the-afd.html#cb62-60" tabindex="-1"></a>tbl_gov_knwn_en <span class="ot">=</span> data_gov_knwn_en</span>
<span id="cb62-61"><a href="projects-funded-by-the-afd.html#cb62-61" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_knwn_en) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Governance&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>,<span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb62-62"><a href="projects-funded-by-the-afd.html#cb62-62" tabindex="-1"></a></span>
<span id="cb62-63"><a href="projects-funded-by-the-afd.html#cb62-63" tabindex="-1"></a><span class="do">###French</span></span>
<span id="cb62-64"><a href="projects-funded-by-the-afd.html#cb62-64" tabindex="-1"></a>data_gov_knwn_fr <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb62-65"><a href="projects-funded-by-the-afd.html#cb62-65" tabindex="-1"></a>  <span class="fu">filter</span>(marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-66"><a href="projects-funded-by-the-afd.html#cb62-66" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Non référencée&quot;</span>,</span>
<span id="cb62-67"><a href="projects-funded-by-the-afd.html#cb62-67" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Collaborative governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance collaborative&quot;</span>,</span>
<span id="cb62-68"><a href="projects-funded-by-the-afd.html#cb62-68" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb62-69"><a href="projects-funded-by-the-afd.html#cb62-69" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb62-70"><a href="projects-funded-by-the-afd.html#cb62-70" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Government-delegated management&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gestion déléguée par le gouvernement&quot;</span>,</span>
<span id="cb62-71"><a href="projects-funded-by-the-afd.html#cb62-71" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Indigenous peoples&quot;</span> <span class="sc">~</span> <span class="st">&quot;Peuples indigènes&quot;</span>,</span>
<span id="cb62-72"><a href="projects-funded-by-the-afd.html#cb62-72" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Joint governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance conjointe&quot;</span>,</span>
<span id="cb62-73"><a href="projects-funded-by-the-afd.html#cb62-73" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Local communities&quot;</span> <span class="sc">~</span> <span class="st">&quot;Communautés locales&quot;</span>,</span>
<span id="cb62-74"><a href="projects-funded-by-the-afd.html#cb62-74" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Non-profit organisations&quot;</span> <span class="sc">~</span> <span class="st">&quot;Organisations non-lucratives&quot;</span>,</span>
<span id="cb62-75"><a href="projects-funded-by-the-afd.html#cb62-75" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">~</span> <span class="st">&quot;Non rapportée&quot;</span>,</span>
<span id="cb62-76"><a href="projects-funded-by-the-afd.html#cb62-76" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Sub-national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence sous-nationale&quot;</span>,</span>
<span id="cb62-77"><a href="projects-funded-by-the-afd.html#cb62-77" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb62-78"><a href="projects-funded-by-the-afd.html#cb62-78" tabindex="-1"></a>  <span class="fu">filter</span>(gov_type <span class="sc">!=</span> <span class="st">&quot;Non référencée&quot;</span> <span class="sc">&amp;</span> gov_type <span class="sc">!=</span> <span class="st">&quot;Non rapportée&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-79"><a href="projects-funded-by-the-afd.html#cb62-79" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb62-80"><a href="projects-funded-by-the-afd.html#cb62-80" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb62-81"><a href="projects-funded-by-the-afd.html#cb62-81" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb62-82"><a href="projects-funded-by-the-afd.html#cb62-82" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-83"><a href="projects-funded-by-the-afd.html#cb62-83" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb62-84"><a href="projects-funded-by-the-afd.html#cb62-84" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb62-85"><a href="projects-funded-by-the-afd.html#cb62-85" tabindex="-1"></a></span>
<span id="cb62-86"><a href="projects-funded-by-the-afd.html#cb62-86" tabindex="-1"></a>tbl_gov_knwn_fr <span class="ot">=</span> data_gov_knwn_fr</span>
<span id="cb62-87"><a href="projects-funded-by-the-afd.html#cb62-87" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_knwn_fr) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Gouvernance&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>,<span class="st">&quot;Proportion (%)&quot;</span>)</span>
<span id="cb62-88"><a href="projects-funded-by-the-afd.html#cb62-88" tabindex="-1"></a> </span>
<span id="cb62-89"><a href="projects-funded-by-the-afd.html#cb62-89" tabindex="-1"></a></span>
<span id="cb62-90"><a href="projects-funded-by-the-afd.html#cb62-90" tabindex="-1"></a><span class="do">##Pie charts</span></span>
<span id="cb62-91"><a href="projects-funded-by-the-afd.html#cb62-91" tabindex="-1"></a><span class="do">###English</span></span>
<span id="cb62-92"><a href="projects-funded-by-the-afd.html#cb62-92" tabindex="-1"></a>pie_gov_knwn_en <span class="ot">=</span> </span>
<span id="cb62-93"><a href="projects-funded-by-the-afd.html#cb62-93" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_gov_knwn_en, </span>
<span id="cb62-94"><a href="projects-funded-by-the-afd.html#cb62-94" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq, <span class="at">fill=</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb62-95"><a href="projects-funded-by-the-afd.html#cb62-95" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-96"><a href="projects-funded-by-the-afd.html#cb62-96" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, </span>
<span id="cb62-97"><a href="projects-funded-by-the-afd.html#cb62-97" tabindex="-1"></a>                   <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">format</span>(freq, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb62-98"><a href="projects-funded-by-the-afd.html#cb62-98" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb62-99"><a href="projects-funded-by-the-afd.html#cb62-99" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb62-100"><a href="projects-funded-by-the-afd.html#cb62-100" tabindex="-1"></a>               <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-101"><a href="projects-funded-by-the-afd.html#cb62-101" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-102"><a href="projects-funded-by-the-afd.html#cb62-102" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Governance type of non-marine protected areas except not referenced/reported&quot;</span>,</span>
<span id="cb62-103"><a href="projects-funded-by-the-afd.html#cb62-103" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_gov_knwn_en<span class="sc">$</span>n), <span class="st">&quot;non-marines protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-104"><a href="projects-funded-by-the-afd.html#cb62-104" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Governance&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-105"><a href="projects-funded-by-the-afd.html#cb62-105" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb62-106"><a href="projects-funded-by-the-afd.html#cb62-106" tabindex="-1"></a>pie_gov_knwn_en</span>
<span id="cb62-107"><a href="projects-funded-by-the-afd.html#cb62-107" tabindex="-1"></a></span>
<span id="cb62-108"><a href="projects-funded-by-the-afd.html#cb62-108" tabindex="-1"></a></span>
<span id="cb62-109"><a href="projects-funded-by-the-afd.html#cb62-109" tabindex="-1"></a><span class="do">###French</span></span>
<span id="cb62-110"><a href="projects-funded-by-the-afd.html#cb62-110" tabindex="-1"></a>pie_gov_knwn_fr <span class="ot">=</span></span>
<span id="cb62-111"><a href="projects-funded-by-the-afd.html#cb62-111" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_gov_knwn_fr, </span>
<span id="cb62-112"><a href="projects-funded-by-the-afd.html#cb62-112" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq, <span class="at">fill=</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb62-113"><a href="projects-funded-by-the-afd.html#cb62-113" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-114"><a href="projects-funded-by-the-afd.html#cb62-114" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, </span>
<span id="cb62-115"><a href="projects-funded-by-the-afd.html#cb62-115" tabindex="-1"></a>                   <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">format</span>(freq, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb62-116"><a href="projects-funded-by-the-afd.html#cb62-116" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb62-117"><a href="projects-funded-by-the-afd.html#cb62-117" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb62-118"><a href="projects-funded-by-the-afd.html#cb62-118" tabindex="-1"></a>               <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-119"><a href="projects-funded-by-the-afd.html#cb62-119" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-120"><a href="projects-funded-by-the-afd.html#cb62-120" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gouvernance des aires protégées non-marines hors non-rapportées/référencées&quot;</span>,</span>
<span id="cb62-121"><a href="projects-funded-by-the-afd.html#cb62-121" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_gov_knwn_fr<span class="sc">$</span>n), <span class="st">&quot;aires protégées non-marines&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-122"><a href="projects-funded-by-the-afd.html#cb62-122" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Gouvernance&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-123"><a href="projects-funded-by-the-afd.html#cb62-123" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb62-124"><a href="projects-funded-by-the-afd.html#cb62-124" tabindex="-1"></a>pie_gov_knwn_fr</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="projects-funded-by-the-afd.html#cb63-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb63-2"><a href="projects-funded-by-the-afd.html#cb63-2" tabindex="-1"></a></span>
<span id="cb63-3"><a href="projects-funded-by-the-afd.html#cb63-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb63-4"><a href="projects-funded-by-the-afd.html#cb63-4" tabindex="-1"></a></span>
<span id="cb63-5"><a href="projects-funded-by-the-afd.html#cb63-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_en,</span>
<span id="cb63-6"><a href="projects-funded-by-the-afd.html#cb63-6" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Governance of non-marine protected areas funded by AFD&quot;</span>,</span>
<span id="cb63-7"><a href="projects-funded-by-the-afd.html#cb63-7" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb63-8"><a href="projects-funded-by-the-afd.html#cb63-8" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_en.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb63-9"><a href="projects-funded-by-the-afd.html#cb63-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_fr,</span>
<span id="cb63-10"><a href="projects-funded-by-the-afd.html#cb63-10" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Gouvernance des aires protégées non-marines appuyées par l&#39;AFD&quot;</span>,</span>
<span id="cb63-11"><a href="projects-funded-by-the-afd.html#cb63-11" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb63-12"><a href="projects-funded-by-the-afd.html#cb63-12" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_fr.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb63-13"><a href="projects-funded-by-the-afd.html#cb63-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_knwn_en, </span>
<span id="cb63-14"><a href="projects-funded-by-the-afd.html#cb63-14" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Governance of non-marine protected areas funded by AFD (when known)&quot;</span>,</span>
<span id="cb63-15"><a href="projects-funded-by-the-afd.html#cb63-15" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb63-16"><a href="projects-funded-by-the-afd.html#cb63-16" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_knwn_en.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb63-17"><a href="projects-funded-by-the-afd.html#cb63-17" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_knwn_fr, </span>
<span id="cb63-18"><a href="projects-funded-by-the-afd.html#cb63-18" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Gouvernance des aires protégées non-marines appuyées par l&#39;AFD (si connu)&quot;</span>,</span>
<span id="cb63-19"><a href="projects-funded-by-the-afd.html#cb63-19" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb63-20"><a href="projects-funded-by-the-afd.html#cb63-20" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_knwn_fr.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb63-21"><a href="projects-funded-by-the-afd.html#cb63-21" tabindex="-1"></a></span>
<span id="cb63-22"><a href="projects-funded-by-the-afd.html#cb63-22" tabindex="-1"></a></span>
<span id="cb63-23"><a href="projects-funded-by-the-afd.html#cb63-23" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_gov_knwn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb63-24"><a href="projects-funded-by-the-afd.html#cb63-24" tabindex="-1"></a>       <span class="at">plot =</span>  pie_gov_knwn_en,</span>
<span id="cb63-25"><a href="projects-funded-by-the-afd.html#cb63-25" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb63-26"><a href="projects-funded-by-the-afd.html#cb63-26" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb63-27"><a href="projects-funded-by-the-afd.html#cb63-27" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_gov_knwn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb63-28"><a href="projects-funded-by-the-afd.html#cb63-28" tabindex="-1"></a>       <span class="at">plot =</span> pie_gov_knwn_fr,</span>
<span id="cb63-29"><a href="projects-funded-by-the-afd.html#cb63-29" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb63-30"><a href="projects-funded-by-the-afd.html#cb63-30" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb63-31"><a href="projects-funded-by-the-afd.html#cb63-31" tabindex="-1"></a></span>
<span id="cb63-32"><a href="projects-funded-by-the-afd.html#cb63-32" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb63-33"><a href="projects-funded-by-the-afd.html#cb63-33" tabindex="-1"></a></span>
<span id="cb63-34"><a href="projects-funded-by-the-afd.html#cb63-34" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb63-35"><a href="projects-funded-by-the-afd.html#cb63-35" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-36"><a href="projects-funded-by-the-afd.html#cb63-36" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb63-37"><a href="projects-funded-by-the-afd.html#cb63-37" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb63-38"><a href="projects-funded-by-the-afd.html#cb63-38" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb63-39"><a href="projects-funded-by-the-afd.html#cb63-39" tabindex="-1"></a>{</span>
<span id="cb63-40"><a href="projects-funded-by-the-afd.html#cb63-40" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb63-41"><a href="projects-funded-by-the-afd.html#cb63-41" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb63-42"><a href="projects-funded-by-the-afd.html#cb63-42" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb63-43"><a href="projects-funded-by-the-afd.html#cb63-43" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="st">&quot;projet-afd-eva-ap/descriptive_stats/gouvernance/world/no_marine&quot;</span>, </span>
<span id="cb63-44"><a href="projects-funded-by-the-afd.html#cb63-44" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-45"><a href="projects-funded-by-the-afd.html#cb63-45" tabindex="-1"></a>  }</span>
<span id="cb63-46"><a href="projects-funded-by-the-afd.html#cb63-46" tabindex="-1"></a></span>
<span id="cb63-47"><a href="projects-funded-by-the-afd.html#cb63-47" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb63-48"><a href="projects-funded-by-the-afd.html#cb63-48" tabindex="-1"></a></span>
<span id="cb63-49"><a href="projects-funded-by-the-afd.html#cb63-49" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
</div>
<div id="region-non-marine" class="section level4 hasAnchor" number="2.3.6.3">
<h4><span class="header-section-number">2.3.6.3</span> Region, non-marine<a href="projects-funded-by-the-afd.html#region-non-marine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="projects-funded-by-the-afd.html#cb64-1" tabindex="-1"></a>roi <span class="ot">=</span> <span class="st">&quot;Africa&quot;</span></span>
<span id="cb64-2"><a href="projects-funded-by-the-afd.html#cb64-2" tabindex="-1"></a></span>
<span id="cb64-3"><a href="projects-funded-by-the-afd.html#cb64-3" tabindex="-1"></a><span class="co">#Table of the governance type distribution</span></span>
<span id="cb64-4"><a href="projects-funded-by-the-afd.html#cb64-4" tabindex="-1"></a><span class="do">##English version</span></span>
<span id="cb64-5"><a href="projects-funded-by-the-afd.html#cb64-5" tabindex="-1"></a>data_gov_en <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="projects-funded-by-the-afd.html#cb64-6" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> roi <span class="sc">&amp;</span> marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="projects-funded-by-the-afd.html#cb64-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not referenced&quot;</span>,</span>
<span id="cb64-8"><a href="projects-funded-by-the-afd.html#cb64-8" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb64-9"><a href="projects-funded-by-the-afd.html#cb64-9" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb64-10"><a href="projects-funded-by-the-afd.html#cb64-10" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb64-11"><a href="projects-funded-by-the-afd.html#cb64-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb64-12"><a href="projects-funded-by-the-afd.html#cb64-12" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-13"><a href="projects-funded-by-the-afd.html#cb64-13" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb64-14"><a href="projects-funded-by-the-afd.html#cb64-14" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb64-15"><a href="projects-funded-by-the-afd.html#cb64-15" tabindex="-1"></a></span>
<span id="cb64-16"><a href="projects-funded-by-the-afd.html#cb64-16" tabindex="-1"></a>tbl_gov_en <span class="ot">=</span> data_gov_en</span>
<span id="cb64-17"><a href="projects-funded-by-the-afd.html#cb64-17" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_en) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Governance&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>,<span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb64-18"><a href="projects-funded-by-the-afd.html#cb64-18" tabindex="-1"></a></span>
<span id="cb64-19"><a href="projects-funded-by-the-afd.html#cb64-19" tabindex="-1"></a></span>
<span id="cb64-20"><a href="projects-funded-by-the-afd.html#cb64-20" tabindex="-1"></a><span class="do">##French Version</span></span>
<span id="cb64-21"><a href="projects-funded-by-the-afd.html#cb64-21" tabindex="-1"></a>data_gov_fr <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb64-22"><a href="projects-funded-by-the-afd.html#cb64-22" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> roi <span class="sc">&amp;</span> marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-23"><a href="projects-funded-by-the-afd.html#cb64-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Non référencée&quot;</span>,</span>
<span id="cb64-24"><a href="projects-funded-by-the-afd.html#cb64-24" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Collaborative governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance collaborative&quot;</span>,</span>
<span id="cb64-25"><a href="projects-funded-by-the-afd.html#cb64-25" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb64-26"><a href="projects-funded-by-the-afd.html#cb64-26" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb64-27"><a href="projects-funded-by-the-afd.html#cb64-27" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Government-delegated management&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gestion déléguée par le gouvernement&quot;</span>,</span>
<span id="cb64-28"><a href="projects-funded-by-the-afd.html#cb64-28" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Indigenous peoples&quot;</span> <span class="sc">~</span> <span class="st">&quot;Peuples indigènes&quot;</span>,</span>
<span id="cb64-29"><a href="projects-funded-by-the-afd.html#cb64-29" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Joint governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance conjointe&quot;</span>,</span>
<span id="cb64-30"><a href="projects-funded-by-the-afd.html#cb64-30" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Local communities&quot;</span> <span class="sc">~</span> <span class="st">&quot;Communautés locales&quot;</span>,</span>
<span id="cb64-31"><a href="projects-funded-by-the-afd.html#cb64-31" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Non-profit organisations&quot;</span> <span class="sc">~</span> <span class="st">&quot;Organisations non-lucratives&quot;</span>,</span>
<span id="cb64-32"><a href="projects-funded-by-the-afd.html#cb64-32" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">~</span> <span class="st">&quot;Non rapportée&quot;</span>,</span>
<span id="cb64-33"><a href="projects-funded-by-the-afd.html#cb64-33" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Sub-national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence sous-nationale&quot;</span>,</span>
<span id="cb64-34"><a href="projects-funded-by-the-afd.html#cb64-34" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb64-35"><a href="projects-funded-by-the-afd.html#cb64-35" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb64-36"><a href="projects-funded-by-the-afd.html#cb64-36" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb64-37"><a href="projects-funded-by-the-afd.html#cb64-37" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb64-38"><a href="projects-funded-by-the-afd.html#cb64-38" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-39"><a href="projects-funded-by-the-afd.html#cb64-39" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb64-40"><a href="projects-funded-by-the-afd.html#cb64-40" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb64-41"><a href="projects-funded-by-the-afd.html#cb64-41" tabindex="-1"></a></span>
<span id="cb64-42"><a href="projects-funded-by-the-afd.html#cb64-42" tabindex="-1"></a>tbl_gov_fr <span class="ot">=</span> data_gov_fr</span>
<span id="cb64-43"><a href="projects-funded-by-the-afd.html#cb64-43" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_fr) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Gouvernance&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>,<span class="st">&quot;Proportion (%)&quot;</span>)</span>
<span id="cb64-44"><a href="projects-funded-by-the-afd.html#cb64-44" tabindex="-1"></a></span>
<span id="cb64-45"><a href="projects-funded-by-the-afd.html#cb64-45" tabindex="-1"></a></span>
<span id="cb64-46"><a href="projects-funded-by-the-afd.html#cb64-46" tabindex="-1"></a></span>
<span id="cb64-47"><a href="projects-funded-by-the-afd.html#cb64-47" tabindex="-1"></a><span class="co">#PAs with nureported or unreferenced governance types are removed</span></span>
<span id="cb64-48"><a href="projects-funded-by-the-afd.html#cb64-48" tabindex="-1"></a><span class="do">##Tables</span></span>
<span id="cb64-49"><a href="projects-funded-by-the-afd.html#cb64-49" tabindex="-1"></a><span class="do">###English</span></span>
<span id="cb64-50"><a href="projects-funded-by-the-afd.html#cb64-50" tabindex="-1"></a>data_gov_knwn_en <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb64-51"><a href="projects-funded-by-the-afd.html#cb64-51" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> roi <span class="sc">&amp;</span> marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-52"><a href="projects-funded-by-the-afd.html#cb64-52" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Not referenced&quot;</span>,</span>
<span id="cb64-53"><a href="projects-funded-by-the-afd.html#cb64-53" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb64-54"><a href="projects-funded-by-the-afd.html#cb64-54" tabindex="-1"></a>  <span class="fu">filter</span>(gov_type <span class="sc">!=</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">&amp;</span> gov_type <span class="sc">!=</span> <span class="st">&quot;Not referenced&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-55"><a href="projects-funded-by-the-afd.html#cb64-55" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb64-56"><a href="projects-funded-by-the-afd.html#cb64-56" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb64-57"><a href="projects-funded-by-the-afd.html#cb64-57" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb64-58"><a href="projects-funded-by-the-afd.html#cb64-58" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-59"><a href="projects-funded-by-the-afd.html#cb64-59" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb64-60"><a href="projects-funded-by-the-afd.html#cb64-60" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb64-61"><a href="projects-funded-by-the-afd.html#cb64-61" tabindex="-1"></a></span>
<span id="cb64-62"><a href="projects-funded-by-the-afd.html#cb64-62" tabindex="-1"></a>tbl_gov_knwn_en <span class="ot">=</span> data_gov_knwn_en</span>
<span id="cb64-63"><a href="projects-funded-by-the-afd.html#cb64-63" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_knwn_en) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Governance&quot;</span>,<span class="st">&quot;Number of PAs&quot;</span>,<span class="st">&quot;Share of PAs (%)&quot;</span>)</span>
<span id="cb64-64"><a href="projects-funded-by-the-afd.html#cb64-64" tabindex="-1"></a></span>
<span id="cb64-65"><a href="projects-funded-by-the-afd.html#cb64-65" tabindex="-1"></a><span class="do">###French</span></span>
<span id="cb64-66"><a href="projects-funded-by-the-afd.html#cb64-66" tabindex="-1"></a>data_gov_knwn_fr <span class="ot">=</span> data_stat_nodupl <span class="sc">%&gt;%</span></span>
<span id="cb64-67"><a href="projects-funded-by-the-afd.html#cb64-67" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> roi <span class="sc">&amp;</span> marine <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-68"><a href="projects-funded-by-the-afd.html#cb64-68" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gov_type =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(gov_type) <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Non référencée&quot;</span>,</span>
<span id="cb64-69"><a href="projects-funded-by-the-afd.html#cb64-69" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Collaborative governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance collaborative&quot;</span>,</span>
<span id="cb64-70"><a href="projects-funded-by-the-afd.html#cb64-70" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb64-71"><a href="projects-funded-by-the-afd.html#cb64-71" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Federal or national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence, fédérale ou nationale&quot;</span>,</span>
<span id="cb64-72"><a href="projects-funded-by-the-afd.html#cb64-72" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Government-delegated management&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gestion déléguée par le gouvernement&quot;</span>,</span>
<span id="cb64-73"><a href="projects-funded-by-the-afd.html#cb64-73" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Indigenous peoples&quot;</span> <span class="sc">~</span> <span class="st">&quot;Peuples indigènes&quot;</span>,</span>
<span id="cb64-74"><a href="projects-funded-by-the-afd.html#cb64-74" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Joint governance&quot;</span> <span class="sc">~</span> <span class="st">&quot;Gouvernance conjointe&quot;</span>,</span>
<span id="cb64-75"><a href="projects-funded-by-the-afd.html#cb64-75" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Local communities&quot;</span> <span class="sc">~</span> <span class="st">&quot;Communautés locales&quot;</span>,</span>
<span id="cb64-76"><a href="projects-funded-by-the-afd.html#cb64-76" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Non-profit organisations&quot;</span> <span class="sc">~</span> <span class="st">&quot;Organisations non-lucratives&quot;</span>,</span>
<span id="cb64-77"><a href="projects-funded-by-the-afd.html#cb64-77" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Not Reported&quot;</span> <span class="sc">~</span> <span class="st">&quot;Non rapportée&quot;</span>,</span>
<span id="cb64-78"><a href="projects-funded-by-the-afd.html#cb64-78" tabindex="-1"></a>                              gov_type <span class="sc">==</span> <span class="st">&quot;Sub-national ministry or agency&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ministère ou agence sous-nationale&quot;</span>,</span>
<span id="cb64-79"><a href="projects-funded-by-the-afd.html#cb64-79" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb64-80"><a href="projects-funded-by-the-afd.html#cb64-80" tabindex="-1"></a>  <span class="fu">filter</span>(gov_type <span class="sc">!=</span> <span class="st">&quot;Non référencée&quot;</span> <span class="sc">&amp;</span> gov_type <span class="sc">!=</span> <span class="st">&quot;Non rapportée&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-81"><a href="projects-funded-by-the-afd.html#cb64-81" tabindex="-1"></a>  <span class="fu">group_by</span>(gov_type) <span class="sc">%&gt;%</span></span>
<span id="cb64-82"><a href="projects-funded-by-the-afd.html#cb64-82" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb64-83"><a href="projects-funded-by-the-afd.html#cb64-83" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n),</span>
<span id="cb64-84"><a href="projects-funded-by-the-afd.html#cb64-84" tabindex="-1"></a>         <span class="at">freq =</span> <span class="fu">round</span>(n<span class="sc">/</span>n_tot<span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-85"><a href="projects-funded-by-the-afd.html#cb64-85" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb64-86"><a href="projects-funded-by-the-afd.html#cb64-86" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>freq)</span>
<span id="cb64-87"><a href="projects-funded-by-the-afd.html#cb64-87" tabindex="-1"></a></span>
<span id="cb64-88"><a href="projects-funded-by-the-afd.html#cb64-88" tabindex="-1"></a>tbl_gov_knwn_fr <span class="ot">=</span> data_gov_knwn_fr</span>
<span id="cb64-89"><a href="projects-funded-by-the-afd.html#cb64-89" tabindex="-1"></a><span class="fu">names</span>(tbl_gov_knwn_fr) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Gouvernance&quot;</span>,<span class="st">&quot;Nombre d&#39;AP&quot;</span>,<span class="st">&quot;Proportion (%)&quot;</span>)</span>
<span id="cb64-90"><a href="projects-funded-by-the-afd.html#cb64-90" tabindex="-1"></a> </span>
<span id="cb64-91"><a href="projects-funded-by-the-afd.html#cb64-91" tabindex="-1"></a></span>
<span id="cb64-92"><a href="projects-funded-by-the-afd.html#cb64-92" tabindex="-1"></a><span class="do">##Pie charts</span></span>
<span id="cb64-93"><a href="projects-funded-by-the-afd.html#cb64-93" tabindex="-1"></a><span class="do">###English</span></span>
<span id="cb64-94"><a href="projects-funded-by-the-afd.html#cb64-94" tabindex="-1"></a>pie_gov_knwn_en <span class="ot">=</span> </span>
<span id="cb64-95"><a href="projects-funded-by-the-afd.html#cb64-95" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_gov_knwn_en, </span>
<span id="cb64-96"><a href="projects-funded-by-the-afd.html#cb64-96" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq, <span class="at">fill=</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb64-97"><a href="projects-funded-by-the-afd.html#cb64-97" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-98"><a href="projects-funded-by-the-afd.html#cb64-98" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, </span>
<span id="cb64-99"><a href="projects-funded-by-the-afd.html#cb64-99" tabindex="-1"></a>                   <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">format</span>(freq, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb64-100"><a href="projects-funded-by-the-afd.html#cb64-100" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb64-101"><a href="projects-funded-by-the-afd.html#cb64-101" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb64-102"><a href="projects-funded-by-the-afd.html#cb64-102" tabindex="-1"></a>               <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-103"><a href="projects-funded-by-the-afd.html#cb64-103" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-104"><a href="projects-funded-by-the-afd.html#cb64-104" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Governance type of non-marine protected areas except not referenced/reported</span><span class="sc">\n</span><span class="st">&quot;</span>, roi),</span>
<span id="cb64-105"><a href="projects-funded-by-the-afd.html#cb64-105" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample :&quot;</span>, <span class="fu">sum</span>(data_gov_knwn_en<span class="sc">$</span>n), <span class="st">&quot;non-marine protected areas&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-106"><a href="projects-funded-by-the-afd.html#cb64-106" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Governance&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-107"><a href="projects-funded-by-the-afd.html#cb64-107" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb64-108"><a href="projects-funded-by-the-afd.html#cb64-108" tabindex="-1"></a>pie_gov_knwn_en</span>
<span id="cb64-109"><a href="projects-funded-by-the-afd.html#cb64-109" tabindex="-1"></a></span>
<span id="cb64-110"><a href="projects-funded-by-the-afd.html#cb64-110" tabindex="-1"></a></span>
<span id="cb64-111"><a href="projects-funded-by-the-afd.html#cb64-111" tabindex="-1"></a><span class="do">###French</span></span>
<span id="cb64-112"><a href="projects-funded-by-the-afd.html#cb64-112" tabindex="-1"></a>pie_gov_knwn_fr <span class="ot">=</span></span>
<span id="cb64-113"><a href="projects-funded-by-the-afd.html#cb64-113" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_gov_knwn_fr, </span>
<span id="cb64-114"><a href="projects-funded-by-the-afd.html#cb64-114" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>, <span class="at">y=</span> freq, <span class="at">fill=</span> gov_type)) <span class="sc">%&gt;%</span></span>
<span id="cb64-115"><a href="projects-funded-by-the-afd.html#cb64-115" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-116"><a href="projects-funded-by-the-afd.html#cb64-116" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">1.3</span>, </span>
<span id="cb64-117"><a href="projects-funded-by-the-afd.html#cb64-117" tabindex="-1"></a>                   <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">format</span>(freq, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb64-118"><a href="projects-funded-by-the-afd.html#cb64-118" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb64-119"><a href="projects-funded-by-the-afd.html#cb64-119" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.55</span>), </span>
<span id="cb64-120"><a href="projects-funded-by-the-afd.html#cb64-120" tabindex="-1"></a>               <span class="at">size=</span><span class="fl">2.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-121"><a href="projects-funded-by-the-afd.html#cb64-121" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="at">start=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-122"><a href="projects-funded-by-the-afd.html#cb64-122" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Gouvernance des aires protégées non-marines hors non-rapportées/référencées</span><span class="sc">\n</span><span class="st">&quot;</span>, roi),</span>
<span id="cb64-123"><a href="projects-funded-by-the-afd.html#cb64-123" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Echantillon :&quot;</span>, <span class="fu">sum</span>(data_gov_knwn_fr<span class="sc">$</span>n), <span class="st">&quot;aires protégées&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-124"><a href="projects-funded-by-the-afd.html#cb64-124" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Gouvernance&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Paired&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-125"><a href="projects-funded-by-the-afd.html#cb64-125" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb64-126"><a href="projects-funded-by-the-afd.html#cb64-126" tabindex="-1"></a>pie_gov_knwn_fr</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="projects-funded-by-the-afd.html#cb65-1" tabindex="-1"></a><span class="co">#Saving figures</span></span>
<span id="cb65-2"><a href="projects-funded-by-the-afd.html#cb65-2" tabindex="-1"></a></span>
<span id="cb65-3"><a href="projects-funded-by-the-afd.html#cb65-3" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;fig&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb65-4"><a href="projects-funded-by-the-afd.html#cb65-4" tabindex="-1"></a></span>
<span id="cb65-5"><a href="projects-funded-by-the-afd.html#cb65-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_en,</span>
<span id="cb65-6"><a href="projects-funded-by-the-afd.html#cb65-6" tabindex="-1"></a>             <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Governance of non-marine protected areas funded by AFD,&quot;</span>, roi),</span>
<span id="cb65-7"><a href="projects-funded-by-the-afd.html#cb65-7" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb65-8"><a href="projects-funded-by-the-afd.html#cb65-8" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_en.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb65-9"><a href="projects-funded-by-the-afd.html#cb65-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_fr,</span>
<span id="cb65-10"><a href="projects-funded-by-the-afd.html#cb65-10" tabindex="-1"></a>             <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Gouvernance des aires protégées non-marines appuyées par l&#39;AFD,&quot;</span>, roi),</span>
<span id="cb65-11"><a href="projects-funded-by-the-afd.html#cb65-11" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb65-12"><a href="projects-funded-by-the-afd.html#cb65-12" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_fr.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb65-13"><a href="projects-funded-by-the-afd.html#cb65-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_knwn_en, </span>
<span id="cb65-14"><a href="projects-funded-by-the-afd.html#cb65-14" tabindex="-1"></a>             <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Governance of non-marine protected areas funded by AFD,&quot;</span>, roi, <span class="st">&quot;(when known)&quot;</span>),</span>
<span id="cb65-15"><a href="projects-funded-by-the-afd.html#cb65-15" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb65-16"><a href="projects-funded-by-the-afd.html#cb65-16" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_knwn_en.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb65-17"><a href="projects-funded-by-the-afd.html#cb65-17" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xtable</span>(tbl_gov_knwn_fr, </span>
<span id="cb65-18"><a href="projects-funded-by-the-afd.html#cb65-18" tabindex="-1"></a>             <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Gouvernance des aires protégées non-marines appuyées par l&#39;AFD,&quot;</span>, roi, <span class="st">&quot;(si connu)&quot;</span>),</span>
<span id="cb65-19"><a href="projects-funded-by-the-afd.html#cb65-19" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>),</span>
<span id="cb65-20"><a href="projects-funded-by-the-afd.html#cb65-20" tabindex="-1"></a>      <span class="at">file =</span> <span class="fu">paste</span>(tmp, <span class="st">&quot;tbl_gov_knwn_fr.tex&quot;</span>, <span class="at">sep  =</span><span class="st">&quot;/&quot;</span>))</span>
<span id="cb65-21"><a href="projects-funded-by-the-afd.html#cb65-21" tabindex="-1"></a></span>
<span id="cb65-22"><a href="projects-funded-by-the-afd.html#cb65-22" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_gov_knwn_en.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb65-23"><a href="projects-funded-by-the-afd.html#cb65-23" tabindex="-1"></a>       <span class="at">plot =</span>  pie_gov_knwn_en,</span>
<span id="cb65-24"><a href="projects-funded-by-the-afd.html#cb65-24" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb65-25"><a href="projects-funded-by-the-afd.html#cb65-25" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb65-26"><a href="projects-funded-by-the-afd.html#cb65-26" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste</span>(tmp, <span class="st">&quot;pie_gov_knwn_fr.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>),</span>
<span id="cb65-27"><a href="projects-funded-by-the-afd.html#cb65-27" tabindex="-1"></a>       <span class="at">plot =</span> pie_gov_knwn_fr,</span>
<span id="cb65-28"><a href="projects-funded-by-the-afd.html#cb65-28" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb65-29"><a href="projects-funded-by-the-afd.html#cb65-29" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">9</span>)</span>
<span id="cb65-30"><a href="projects-funded-by-the-afd.html#cb65-30" tabindex="-1"></a></span>
<span id="cb65-31"><a href="projects-funded-by-the-afd.html#cb65-31" tabindex="-1"></a><span class="co">#Export to S3 storage</span></span>
<span id="cb65-32"><a href="projects-funded-by-the-afd.html#cb65-32" tabindex="-1"></a></span>
<span id="cb65-33"><a href="projects-funded-by-the-afd.html#cb65-33" tabindex="-1"></a><span class="do">##List of files to save in the temp folder</span></span>
<span id="cb65-34"><a href="projects-funded-by-the-afd.html#cb65-34" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-35"><a href="projects-funded-by-the-afd.html#cb65-35" tabindex="-1"></a><span class="do">##Add each file in the bucket (same foler for every file in the temp)</span></span>
<span id="cb65-36"><a href="projects-funded-by-the-afd.html#cb65-36" tabindex="-1"></a>count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb65-37"><a href="projects-funded-by-the-afd.html#cb65-37" tabindex="-1"></a><span class="cf">for</span>(f <span class="cf">in</span> files) </span>
<span id="cb65-38"><a href="projects-funded-by-the-afd.html#cb65-38" tabindex="-1"></a>{</span>
<span id="cb65-39"><a href="projects-funded-by-the-afd.html#cb65-39" tabindex="-1"></a>  count <span class="ot">=</span> count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb65-40"><a href="projects-funded-by-the-afd.html#cb65-40" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Uploading file&quot;</span>, <span class="fu">paste0</span>(count, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(files), <span class="st">&quot; &#39;&quot;</span>, f, <span class="st">&quot;&#39;&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb65-41"><a href="projects-funded-by-the-afd.html#cb65-41" tabindex="-1"></a>  aws.s3<span class="sc">::</span><span class="fu">put_object</span>(<span class="at">file =</span> f, </span>
<span id="cb65-42"><a href="projects-funded-by-the-afd.html#cb65-42" tabindex="-1"></a>                     <span class="at">bucket =</span> <span class="fu">paste</span>(<span class="st">&quot;projet-afd-eva-ap/descriptive_stats/gouvernance&quot;</span> , roi, <span class="st">&quot;no_marine&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>), </span>
<span id="cb65-43"><a href="projects-funded-by-the-afd.html#cb65-43" tabindex="-1"></a>                     <span class="at">region =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_progress =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-44"><a href="projects-funded-by-the-afd.html#cb65-44" tabindex="-1"></a>  }</span>
<span id="cb65-45"><a href="projects-funded-by-the-afd.html#cb65-45" tabindex="-1"></a></span>
<span id="cb65-46"><a href="projects-funded-by-the-afd.html#cb65-46" tabindex="-1"></a><span class="co">#Erase the files in the temp directory</span></span>
<span id="cb65-47"><a href="projects-funded-by-the-afd.html#cb65-47" tabindex="-1"></a></span>
<span id="cb65-48"><a href="projects-funded-by-the-afd.html#cb65-48" tabindex="-1"></a><span class="fu">do.call</span>(file.remove, <span class="fu">list</span>(<span class="fu">list.files</span>(tmp, <span class="at">full.names =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="building-the-datasets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="biodiversity-in-the-protected-areas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vuillota/EVA-impact-aires-protegees/edit/main/01_stat_project.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/vuillota/EVA-impact-aires-protegees/raw/main/01_stat_project.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
